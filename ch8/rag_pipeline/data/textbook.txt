ВЫСWIИ
МАТЕМАТИКА
•   Теория · чисел
•   Общая anreбpa

•   КамбиЩiторико
•   Теория Пойо
•   Теория графов
•   Поросочетония
•   Матроиды
вся
ВЬIСWАН
МАТЕМАТИКА
М. Л. Краснов
А. И. Киселев
Г. И. Макаренко
Е. В. Шикин
В.И.Заляпин
А.Ю.Эвнин



Рекомендовано
Министерством образования
Российской Федерации
в качестве учебника для студентов
высших технических учебных заведений




--


МОСКВА
                                       �
                                       URSS
ББК 22.1я73




    Краснов Михаил Леонтьевич, Киселев Александр ИвановИч,
    Макаренко I}Jнгорий Иванович, Шикни. Евrен"й Викторович,                    '      ·

    Заляпин Владимир Ильич, Эвщ.н Александр ЮрЬевич
    Вся высшая математика: Учебник. Т. 7.- М.: Ком                   l<нига, 2006. - 208 с.
     ISBN   5-484-00521-3
     Предлагаемый учебник впервые вышел в свет в виде двухтомника сначала на английском
и испанском языках в 1990 году, а затем на фр,анцузском; Он nользуется 69лъшим спросом
за рубежом.
     В 1999 году книга стала лауреатом конкурса по созданию новых учебников Министерства
образования России.
     Этот учебник адресован студентам высших учебных заведений (в первую очередь будущим
инженерам и эконо�истам) и охватывает практически все разделы математики, но при этом
представляет собой не набор разрозненных глав, а единое целое ..
     Седьмой том включает в себя материал по теории чисел, комбинаторике и теории гра­
фов. В первых двух главах тома рассматриваются элементы теории чисел и общей алгебры.
Вводимь1е при этом понятия широко испо,Jiьзуются в других ГЛавах, в частности при изложе­
нии теории Пойа, позволяющей решать задачи пересчета Объектов с точностью до того или
иного отношения эквивалентности. В главе, посвященной комбинаторике, помимо начальных
сведений о выборках имагается принцип включения-исключения, эффективно работающий
при решении классических комбинаторных задач. Здесь также описывается аппарат произ­
водяших функций - мощцое средство комбинаторного анализа. В заключительных главах
вв�дятся основные понятия теории графов и матроидов, описываются некоторые эффективные
алгоритмы.




     Издательство •Ком Книга•. 117312, r. Москва, nр-т 60-летия Октября, 9.


     Отпечатано в типографии 000 ПФ •Полиграфист•.                                                 З.
     Подписано к печати 09.03.2006 r. Формат 70х \00/16. Печ. л. 13. Зак. N.!       2331.
                                                          160001, г. Вологда, ул. 'lелюскинцев,




     ISBN 5-484-00521-3                                                   © КомКнига,            2006

               НАУЧНАЯ И УЧЕБНАЯ ЛИТЕРАТУРА
                            URSS@URSS.ru ·                                                  3384 ID 31314
                      Каталог изданий в Интернете:
                      E-mall:



                      http://URSS.ru
                    Тел./факс: 7 (495) 135-42-16
               URSS Тел./факс: 7 (495) 135-42-46
                                                                     Яllll/liШ ��Ш�ll�                      >




Все права защищены. Никакая часть настоящей кии ги не может быть воспроизведена или передана
в како й бы то ни было форме и как ими бы то ни б ыло средствами, будь то электронные или механические,
                                                                                             '
включая фотокопирование и запись на магнитный носитель, а также размещение в Интернете, если на то
нет пи сьменного разрешения Издательства.
                                                              ОГЛАВЛЕНИЕ




Предисловие . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
                         .                                                                                                                                                                                       3

Глава LXVI
Элементы теории чисел                                     .   . . . . , . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                                                            5
§ 1.   Теорема о делении с остатком                                                         .   . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                                           5
§ 2.   Наибольший общий делитель. Алгоритм Евклида                                                                                          .   . . . . . . . . . . . . . . . .                                  6
§ 3.   (ka - 1 , kь - 1)                      =       k(а,Ь) - 1              .   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                                                  8
§ 4.   Простые числа. Основная теорема арифметики                                                                                       .   . . . . . . . . . . . . . . . . .                                     9
§ 5.   Сравнения и их свойства                                            .   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
§ 6.   Системы вычетов                                .   .   .   .   .   .   .   .     .   .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .'   . . 13
§ 7.   Теорема Эйлера .                               .   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
§ 8.   Линейные диофантовы уравнения                                                                .   .   .   .   .   .   .   .   .   •   .   . . . . . . . . . . . . . . . . 15
§ 9.   Мультипликативные функции                                                        .   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
§ 10. Система РША                             .   .   .   .   .   .   .   .   .   .     .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    .   .   20
Упражнения           .   .   .   .   .    .   .   .   .   .   .   .   .   .   .   .     .   .   .   .   .   .   .   •   .   . . . . . . . . . . . . . . . . . . . . . 22
Ответы   .   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . , . . . . . . . . . . . . . . . 23

Глава LXVII
Начальные понятия общей алгебры                                                             .   . . . . . . . . . . . . . . . . . . . . . : . . . . . . 24
§ 1.   Отношения                     .    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ' 25
§ 2.   Отношение эквивалентности                                                  .     .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   - . . . . . . . . . . . 26
§ 3.   Отношения порядка                                      .   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
§ 4.   Алгебраические структуры. Группа                                                             .   . . . . . : . . . . . . . . . . . . . . . . . . . . 28
§ 5.   Кольцо и поле                          .   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
§ 6.   Группы самосовмещений многоугольников и многогранников                                                                                                               .   . . . . . . . . 32
Упражнения           .   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
Ответы   .   .   .   .   .   .   .   ..   .   .   .   .   .   .   .   .   .   .   . ·   :   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
 Оrп аа.nенме ------ 201
 Глава LXVI I I
 Комбинаторика                       .   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
 §1.     Правило произведения                                             .   •   •   .   .   .   .   .   .   .   .   .   •   •   .   .   .   .   .   .   .   .   •   .   . . . . . . . . . . 41
         1.1.        Число nерестановак                                   .   .   •   .   .   .   .   .   .   •   •   •   .   •   .   .   .   •   •   .   •   .   . � .       •   •   .    •. 42
                                                                                                                                                                                               •   •   •    .



         1 .2.       Число подмножеств конечного множества                                                                    •   .   .   .   .   .   .   •   •   •   •   .   •   .   .    .  42
                                                                                                                                                                                               .   .   •    •   •



 § 2.    Выборки. Размещения                                          .   .   .   .   .   •   .   •   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   •   .   . . . . . . . . . 42
. § 3.   Сочетания . .                       '-   .   .   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   •   .   . . . . . . . . 43
  § 4.   Перестановки с повторениями                                                          .   .   .   .   .   .   •   .   •   .   .   •   .   .   .   .   .   .   .   .   •   .   .    •   . . . . . 45
 § 5.    Полиномиальная формула                                                   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   •   .   . . . . . . . 46
 § 6.    Комбинаторные тождества                                                  .   .   .   .   .   .   •   .   .   •   .   .   .   .   .   .   .   .   •   .   .   .   .   . · .   .    .   .  . 48
                                                                                                                                                                                                   .   •    .



 § 7.    Формула включения-исключения                                                             •   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   .    .   •   •   .    . . 52
 § 8.    Функция Эйлера                               .   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   •   .   .    .   .   •   .    . . 53
 § 9.    Задача о беспорядках и встреч ах                                                             .   .   .   .   .   .   •   . . . . . . . . . . . . . . . . . . . . 54
 § 1 0. Число сюръекций                                   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    .   .   .   .    .   .   56
 § 1 1 . Обобщение формулы включения-исключения                                                                                   .   .   .   .   .   .   .   .   •   .   . . . . . . . . . . 57
 § 12. Числа Стирлинга 1 1 рода .                                             .   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58                                                                       ·



 § 1 3. Числа Стирлинrа 1 рода                                            .   .   •   .   .   .   .   .   .   .   .   .   '
                                                                                                                          .   •   .   .   .   .   .   .   .   .   .   .   .   .   .   .    •   .   . . . . 62
 § 1 4. Производящие функции                                              .   •   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   ,   .   .   .   .   .   •   .   . . . . . . . . . 64
 § 15. Число счастливых билетов                                                   .   .   .   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   .    .   .   .   .    .   .   67
 § 1 6. Число бинарных деревьев с n вершинами                                                                             .   .   .   .   .   •   .   .   •   .   .   .   .   .   .   .    .   .   .   .    .   .   68
 § 1 7. Решение линейных рекуррентных уравнений                                                                                   .   .   .   .   .   •   .   .   .   .   .   .   .   .    ,   .   •   .    .   .   70
 УпражнениЯ              .   .   .   .   •   •    .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   :   .   •   .   .   .   .   .   .   •   .   . . . . . . . . . . . 73
 Ответы     .    .   .   .   .   .   •   .   .    .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   •   .   .   .   .   .    .   .   .   .    .   .   79

 Глава LXIX
 Теория П ойа                . .     .   . .      .   .   '. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
 §1.     Цикловой индекс группы подстановак                                                                   .   .   .   .   .   .   .   .   .   .   .   .   •   .   . . . . . . . . . . . 82
 § 2.    Лемма Бернсайда                                  .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    .   .   .   .    •   .    84
 § 3.    Функции и классы эквивалентности                                                                 .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   •   . . . . . . . . . 88
 § 4.    Теорема Пойа                             .   .   .   .   .   .   .   .   .   •   .   ,   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .    .   .   .   ..   .   .    90
 § 5,    Примеры                 •   .   .    .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .•   .   . . . . . 92
 Упражнения              .   .   .   .   .    .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   •    .   . . . . . 95
 Ответы     .    .   .   .   .   .   .   .    .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   •   .   •   .   .   .   .   .   .   .   .    .   .   .   .    .   .    97    ·   .




 Глава LXX
 Введение в теорию графов . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
                                                                      .




 § 1.    Определения и примеры .                                                  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    •   .   . . . . 1 00
 § 2.    Связные графы ·                              .   .   .   •   .   .   .   •   .   .   .   •   .   •   .   .   .   .   .   .   .   .   .   .   .   .   .   •   •   .   . . . . . . . . . 104
 § З.    Метрические характеристики графа                                                                 •   .   .   .   .   .   .   .   .   .   .   .   .   ,   •   •   .   .   . · .    .   .   .   •    .   •   1(}7
 § 4.    Гамильтонавы графы                                       .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   .    .   .   .   •    .   .   109
 § 5.    Эйлеравы графы                                   .   .   •   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   .   .    .   .   .   .    .   •   111
 § 6.    Деревья и леса                               .   .   .   •   .   •   ,   .   .   .   .   .   .   .   .   .   .   .   .   •   .   .   .   •   .   .   •   .   .   .   .   •   •    •   .   .   .    .   •   1 14
·   202                                                                                                                                                                                                  Оrлавпение

    § 7.     Теорема Кэли о числе помеченных деревьев                                                                                  .   .   .   .   .   .    .   .   .   .    .   .   .   .   .   .   .   .   .   1 16
                                                                                                                                                                                                                     .



    § 8.     Стягивающие деревья                                          .   .   .   .   .   .   .   .   .   .   .   .   .   .    .   .   .   .   .   .   .    .   .   .   .    .   .   .   .   .   .   . · .   . . 118
    § 9.     Фундаментальная система циклов                                                                                                                             1 21
             9. 1 .
                                                                                                          .   .   .   .   .   .    .   .   .   .   .   .   .    .   .   .   .    .   .   .   .   .   .   .   .   .   .



                          Симметрическая разность множеств                                                                                                              1 22
             9.2.
                                                                                                                      .   .   .    .   .   .   .   .   .   .    .   .   .   .    .   .   .   .   .   .   .   .   .   .



                          Псевдоциклы . . . . . . . . . . . . . . . .                                                     : . . . . . . . . . . . . . . . . . . . . . . 1 23
             9.3.         Фундаментальная система циклов                                                      .   .   .   .   .    .   .   .  ..   .   .   ..   .       1 23
                                                                                                                                                                        .   .    .   .   .   .       .   .   .   .   .



    § 10.    Укладки графов                               .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    .   .   .: . . . . . . . . . . . . . 1 25
                                                                                                                                               .   .   .   .



    § 11.    Формула Эйлера                                   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    .   .   .   .   .   .   .    .
                                                                                                                                                                .   .   1 26
                                                                                                                                                                        .   .    .   .   .   .   .   .       .   .   .



    § 1 2.   Критерий планарности графа .                                                         .   .   .   .   .   .   .   .    .   .   .   .  ..   .   .    .   .   1 29
                                                                                                                                                                        .        .   .   .   .   .   .   .   .   .   .



    § 1 3.   Ориентированные графы                                                .   .   .   .   .   .   .   .   .   .   .   .    .   .   .   .   .   .   .    .   .   1 29
                                                                                                                                                                        .   .    .   .   .   .   .   .   .   .   .   .



    § 1 4. Нахождение кратчайших путей в орграфе                                                                              .    .   .   .   .   .   .   .    .   .   .   .    .   .   .   .   .   .   .   .   .   .   1 30
    § 1 5. Задача сетевого планирования и управления (PERT)                                                                                                .    .   .   .   .    .   .   .   .   .   .   .   .   .   .   1 34
    § 1 6. Потоки в сетях                             .   .   .   .   .   .   .   .   .   .   .   .   .   . .     .   .   .   .    .   .   .   .   .   .   .    .   .   .   .    .   .   .   .   .   .   .   .   .   .   1 37
    Упражнения                .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   ..   .   .   .   .   .   .   .    .   .   .   .    .   .   .   .   .   .   .   .   .   .   141
    Ответы       .    .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    .   .   .   .   .   .   .    .   .   .   .    .   .   .   .   .   .   .   .   .   .   148

    Глава LXXI
    Парасочетания                         .   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . , 1 50
    § 1.     Теорема Холла                            .   . . . .. . . . . . . .
                                                                          .   .   .   .   .   .   .   .   . . . .
                                                                                                  . . . 1 51              .   .    .               .                    .        .   .   .   .   .   .           .



    § 2.     Венгерская теорема                            .          .   .  ..   .   .   .   .   .   .   1 52
                                                                                                          .   .   .   .       .    .   .   .   .   .   .   .        .   .   .    .   .   .   .   .   .   .   .   .   .



    § 3.     Теорема Дилворта    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 54
                                                                  .



    § 4.     Совершенные парасочетания в регулярных двудольных графах . . . . . . . 1 57                                                                                                 .



    § 5.     Дважды стохастические матрицы                                                            .   1 57
                                                                                                          .   .   .   .   .   .    .   .   .   .   .   .   .    .   .   .   .    .   .   .   .   .   •   .   .   .   .



    § 6.     Латинские прямоугольники                                                 .   .   . . .   .   1 58
                                                                                                          .   .   .   .   .   .    .   .   .   .   .   .   .    .   .   .   .    .   .   .   .   .       .   .   .   .



    § 7.     Реберная раскраска графов             .                     .                .   .   .   .   1 59.   .   .   .   .    .   .   .   .   .       .    .   .   .   .    .   .   .   .   .   .   .   .   .   .



    § 8.     Теорема Бёржа                                .   .   .   ..  .   ..  . ' . . . . . . . . . . 1 61
                                                                                      .   .   .   .   .   .   .   .   .   .   .    .   .   .   .       .   .    .       .   .



    § 9.     Нахождение наибольшего парасочетания                                                         1 62                .    .   .   .   .   .   .   .    .   .   .   .    .   .   .   .   .   .   .   .   .   .



    § 1 0. Нахождение наименьшего вершинного покрытия                                                                                              .   .   .    .   .   .   .    .   .   .   .   , . . . . . 1 64
    § 1 1 . Венгерский алгоритм                                       .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    .   .   .   .   .   .   .    .   .   .   .    .   .   .   .   .   .   .   1 66
                                                                                                                                                                                                             .   .   .



    § 1 2. Задача о назначениях на узкое место                                                                    .   .   .   .    .   .   .   .   .   .   .    .   .   .   .    .   .   .   .   .   .   .   1 68
                                                                                                                                                                                                             .   .   .



    Упражнения . .            .           .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    .   .   .   .   .   .   .·   .   .   .   .    .   .   .   .   .   .   .   1 69
                                                                                                                                                                                                             .   .   .



    Ответы       .    .   .   .   . . .   .   .   .   .   .   .   .   .   .   .       .   .   .   .   .   .   .   .   .   .   .    .   .   .   .   .   .   .    .   .   .   ·.   .   .   .   .   .   .   .   171
                                                                                                                                                                                                             .   .   .




    Глава LXXI I                      ·



    Матроиды . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 73
                          .




    § 1.     Определения и примеры        . . . . . . . . . . . . . . . . . . . . .
                                                                                  .                                                                                         . . . . . . . . . . . 1 73
    § 2.     Двойственност!>  . . . . . . . . . . . . . . . . . . . . . . . . . . .
                                                          .                                                                                                                 . . . . . . . . . . . 1 76
    § 3.     Представимые матроиды                                              . .   .   .   .   .   .   .   .   .   .   .   .    .   .   .   .   .   .   .    .       .   .    .   .   .   .   .1 76
                                                                                                                                                                                                     .   .   .   .   .



    § 4.     Ранговая функция .     :. . . . . . . . . . . . . . . .. . . . . . .
                                                                  .   .                                                                                                     . . . . . . . . . . . 1 77
    § 5.     Жадный алгоритм . . . . . . . . . . . . . . . . . . . . . . . . . .
                                                              .                                                                                                             . . . . . . . . . . . 1 79
    § 6.     Одна задача планирования эксперимента . . . . . . . . . .                                                        .                                             . . . . . . . . . . . 1 82
    § 7.     Трансвереали . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
                                                  .                                                                                                                         . . . . . . . . . . . 183
�ЯШМ� --------�-- 203

§ 8.   Трансверсал�;.ный матроид                                             .   .   .   .   .   .   .   •   •   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   .   1 86
§ 91   Неэависимые трансвереали                                                  .   .   .   •   .   •   .   •   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   1 87
§ 1 0. Общие трансвереали                                    .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   .   1 89
§ 1 1 . Некоторые интересные матроиды                                                            . . . . . . . . . . . . . . . . . . . . . :                                             .   .   .   •   .   1 90
       1 1 . 1 . Матроид Фано                        .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   •   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   .   •   .   .   191
       1 1 .2. Матроид Вамоса                                .   .   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   •   1 93
Упражнения           .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   •   .   . . . . . . . . 1 94
Ответы   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   •   .   .   .   .   .   .   .   .   .   .   .   •   •   .   •   .   .   .   .   .   .   .   .   1 96


Предметный указатель . . . . . . . . . . . . . . . . . . . �                                                                         .   . . . . . . . . . . . . . . . . . 1 97
                                   ПРЕДИСЛОВИЕ


                                                                                           '


    В лредьщущих книгах нашеrо издания развитие основных событий в большей
или меньшей степени было связано с ключевой идеей                   близости,   математическое
осмысление которой привело к ошеломляющему каскаду самых разнообразных
результатов. И хотя эта. илея еще весьма далека от исчерпания, существует ши­
рокий пласт математических задач, в которых она не работает. Значительную                        ·


по объему долю в этом пласте. составляют задачи, в которых изучаются свойства
множеств, состоящих из конечного числа элементов. Число элементов в таких
множествах может быть разным - от нескольких единиц до многих степеней
                    1 10
десяти   - l0 10 ,10 0 ,   . . .   .



    Истоки некоторых из этих задач и методы их решения отделены от нас
сотнями и даже тысячами лет. Появление других было стимулировано развитием
вычислитмьных средств, стремительно расширяющнеся возможности которых
сами служат источником все новых и новых задач.
    Нарастающий интерес вызвал к жизни новое понятие                       дискJН!тная мате-
матика.    Понимаемая в широком смысле дискретная математика включает в себя
теорию чисел, общую алгебру, математическую логику, комбинаторный анализ,
теорию графов, теорию кодирования, целочисленное лроrраммирование, теорию
функциональных систем и др.
    ДискJН!тность (от латинского discretus               раЗделенный, nрерывистый) нередко
противопоставляют непрерывносТи. Однако nри решении сложных практических
задач дискретные и непрерывные подходы работают совместно и весьма эффек­
тивно, взаимно обогащая друr друrа.
    В    1 998 rоду иЗдательство «Мир» выпустило книгу Р. Грэхема, Д. Кнута и О. Па­
ташника «Конкретная математика»       (Concrete тatheтatics), термин
                                             CONCRETE
в названии которой образован слиянием слов

                                       CONtinious   и   disCRETE.
Основная задача этого тома - дать читателю рабочее nредставление о технике
оперирования с дискретными объектами, аналогичной технике для объектов
неnрерывных.
    Наша цель скромней: мы лишь хотим познакомить читателя с некоторыми
элементами дискретной математики.
    В первых двух главах тома рассматриваются элементы теории чисел и общей
алгебры. Ввgдимые при этом понятия широко используются в других, главах,
4   --"------ Предиеповие
в частности nри изложении теории Пойа, nозволяющей решать задачи nересчета
объектов с точностью до того или иного отношения эквивалентности. В главе,
nосвященной комбинаторике, nомимо начальных сведений о выборках излагается
лринциn включения-исключения, эффективно работающий при решении клас­
сических комбинаторных задач. Здесь также оnисывается апnарат nроизводящих
функций - мощное средство комбинаторного анализа; В заключительных главах
вводятся основные nонятия теории графов и матроидов, оnисываются некоторые
эффективные алгоритмы.
ГлаваLХW           ____________________________




             ЭЛЕМЕНТЫ ТЕОРИИ ЧИСЕЛ



    Откуда взялись числа, не знает никто. Этнографы объездили все страны вдоль
и поперек и нашли народы, которым вполне хватает <<один», «два>> и «много».
А между тем, у них есть и изысканное искусство, и тончайшие мифы, и нетри­
виальные ремесла. Видимо, эти народы так и не столкнулись с проблемами, для
разрешения которых бьmо необходимо заметное расширение числового диапазо­
на. Они такие же люди, как и мы, только без этого <<один», «два», «три» и так
далее, вплоть До натурального ряда чисел.
    Магия натуральных чисел необычайно притягательна. Она примекает вни­
мание не только увлеченных модной нынче нумерологией, но и заражает вы­
дающиеся умы. Леонард Эйлер, Карл Фридрих Гаусс, Георг Фридрих Бернхард
Риман и многие другие, чьи имена читатель уже встречал в самых разных разделах
томах нашей серии,' серьезно занимались проблемами высшей арифметики, или,
как ее принято называть сейчас, теории чисел, в которой к настоящему време­
ни накопилось значительное количество медоказанных утверждений (несмотря
на впечатляющие успехи).
    Обманчиво простая формулировка Великой теоремы Ферма породила столь
большую и разношерстную армию желающих ее доказать, что профессиональные
математики, обращавшиеся к этой проблеме, предпочитали скрывать свои усилия
по ее доказательству. Это в полной мере относится и к Эндрю Уайлсу, сумевшему
обосновать всем очевидный ответ около десяти лет назад. Насколько важен этот
результат для науки, сказать трудно - на этот счет существуют разные точки
зрения. Но то обстоятельство, что наЙденное доказательство со�сем не просто,
признают все.
    В этой главе мы знакомим читателя с некоторыми понятиями теории чисел,
с несложным инструментарием, позволяющим показать целый ряд замечательных
свойств натуральных чисел, и рассказываем об о.Цном из применений классических
результатов теории чисел к решению чрезвычайно актуальной проблемы защиты
информации (создании надежных шифров).




§ 1 . Теорема о де лении с остатком .
Пусть а и Ь - целые числа. Если существует такое целое число       q, что   а :;:::: Ьq, то
говорят: а   делится на   Ь, или а
                            кратно Ь, или      Ь   делит   а, или Ь-   делитель а; при
этом пользуются обозцачениями -а : Ь или Ь 1   а.
6 ------- Глава LXVJ. Эле�енты теории чисел


Теорема 1 (теорема о делении с остатком). Пусть             а Е Z, Ь Е N. Тогда
                           3! q,    ·    т Е Z,     а=bq + т, О�т < Ь.

_. Существование. Пусть bq      наибольшее из чисел, кратных Ь и не превосхо­
                                           -



дящих   а. Тогда выполняется двойное неравенство bq � а < b(q + 1) , а, значит,
и О�а- bq < Ь. Теперь если положить т= а- Ьq , то одновременно будем иметь:
                                                                                           ·

а=Ьq + т , О�т < Ь.
    Единственность. Пусть а = Ьq1 + т1 и а = bq2 + т2 . Вычитая из первого
равенства второе, получаем: О=Ь(q1 - q2) + т1 -т2 , или b(qi- q2) =т2- Т 1 , откуда
следует, что т1 - т2 делится на Ь. С другой стороны, из неравенств О � т1 < Ь
и О � т2 < Ь вытекает неравенство lт1 - т21 < Ь. Сопоставляя два полученных
факта, заключаем, что т1 - т2 =О. Тогда Ь(q1 - q2) =О, и так как Ь i= О (Ь -
натуральное число), то q1 = q2 . Итак, любые два представления числа а в виде
а=Ьq + т совпадают. Единственность доказана. .,..
      Замечание. Числа q и r из формулировки доказанной теоремы называют соответственно
      частным и остатком от деления а на Ь.



§ 2. Н аибольший о бщий делитель. Алгоритм Евкл и да
В этом nараграфе все числа. предполагаются натуральными.
      Обозначим через        D(a)         множество всех делителей числа а, а через        D(a1 , а2,
. .. , an)   - множество всех общих делителей чисел                а1, а2, ... , an. Таким образом,
                                                              n

                                        D(a 1 , а2, . .. , an) =n D(a;).
                                                             i=l

Заметим, что это множество конечно и не пусто (по крайней мере, оно содержит                               1),
поэтому в нем есть наибольший элемент, который будем обозначать                       (а1 , а2,   • • •   an)
и называть       наибольшим общим делителем чисел а1, а2, . .. , an.
      Натуральные числа        а и Ь называются взаимно простыми, если их наибольший
общий        делитель равен 1 . ОчевИдно следующее утверждение.


Лемма 1 .     а: Ь {::}(а, Ь) =Ь.


Лемма 2. Пусть       а=Ьq + т, О < r < Ь. Тогда (а, Ь) =(Ь, r ) .

_. Пусть       х Е D(a, Ь) . Тогда а: х, Ь: х и r =a-bq: х. Таким образом, х Е D(Ь, r ) .
      Пусть теперь      х Е D(b, т). Тогда Ь: х , r : х и а=Ьq + r: х. Таким образом,
х Е D(a, Ь) .
      Доказано равенство множеств                 D(Ь, т) =D(а, Ь) , а, значит, и их максимальных
элементов. Поэтому         (Ь, т)= (а, Ь) ,       что и требовалось доказать. .,..
§2. Нам6опыuиi1 общиi1 AllдитeJIIt. Аnrоритм Еакпида   -------                                7

      Пустьа не делится на Ь. Тогда имеет местоnредставление а в виде а= Ьq0+r1,
О<   r1 < Ь . По лемме 2 (а , Ь ) (Ь, r1); Если Ь не делится на т 1 , то имеем:
Ь т1q1 + т2 , О < т2 < т 1 и (Ь, r1) = (т 1 , т2). Продолжив данный,процесс
(а он называется алгоритмом Ев/С/lида), получим последовательность остатков (тi),
это   -   убывающая последовательность натуральных чисел. Она не может быть
бесконечной, nоэтому найдется остаток   Tn, являющийся делителем.nредыдущего
остатка   Tn-l· Итак, выполняются следующие соотношения:
              а=Ьq0 + r1,       о < Т! < Ь;         (а , Ь) (Ь,rt);
              Ь=TJtfJ + r2,     О < rz < r1;       (Ь, rJ) (r1 , r2);
             т 1 =r2q2 + rз,    О < r3 < r2;      (r1,r2) (r2, rз );
             Tn - 2=Tn-lqn-1 + Tn, 0 < Tn < Tn-1; (Tn-2• Tn-1) (rn-1, Tn);
                              Tn- 1 =Tnqn; (rn-1, Tn)= Tn.
(Последнее равенство сnраведливо в               силу леммы                  l .)
      Цепочка равенств




доказывает следующую теорему.                          •


Теорема 2. Наибольший общий делитель двух чщел равен последнему ненулевому остат­
ку в алгоритме Ев1СЛида1.;.nри.мененному к данным числам.

      Пример. Для нахождения (288, 126) nрименим алгоритм Евклида к числам 288 и 126:

                                                          288 12�
                                                   126 36            2
                                                 36 1 8    3
                                                 --


                                                  0 2

      Последний ненулевой остаток равен 18; nоэтому (288, 126)                      18.


Теорема 3. Наибольший общий делитель двух чисел делится на любой из общих дели­
телей этих чисел.

.,.. Пусть   а: х, Ь: х; r 1 ,   • • •   ,rп    остатки, возникающие при работе ал:горитма
Евклида. Тогда

             (а- Ьqо) : х,                                     . .   .   '


В силуnредыдущейтеоремы                  rп=(а , Ь). Таким образом, (а, Ь): х, что и требовалось
доказать. ..,..
8   --------.,.-- Dlaвa LXV\,                                                      Эпементы f90РИИ чисеп

2.1 . Свойства н аибольшего общего делителя
    1. (а,Ь)=(Ь,а).
    2. (та, тЬ) = т(а, Ь).
       <111 Все равенства, возникающие при работе алгоритма Евюrида, почленно
       умножаются на т при переходе от пары (а, Ь) к паре (та, тЬ) . ..,.
    3. Если а и Ь взаимно просты, то (ас, Ь)= (с, Ь).
       <111 Пусть ж Е D( ас , Ь). Тогда ас:х, ь;х, Ьс;х,т.е. х Е D(ас,Ьс) .По теоремеЗ
       (ас, Ьс) ;ж, и, в силу предыдущего свойства, с(а, Ь) ;х, но по условию (а, Ь) = 1.
       Таким образом, с; х и х Е D(Ь, с). Пусть теперь х Е D(Ь, с). Тогда Ь ; х,
       с; х, ас; х и х Е D(ac, Ь). Доказано, что D(ac, Ь) = D(c, Ь); откуда следует
       требуемое . ..,.
    4. Если числа а 1 и а2 взаимно просты с Ь, то тем же свойством обладает и их
       произведение, т. е. (а1, Ь)= 1, (а2, Ь) 1 => (а 1 а2 ; Ь) 1.
       Это свойство вытекает из nредыдущего.
                                                                   11

    5. Пусть для i = 1, 2, ... , n (ai, Ь) = 1. Тогда ( П ai, Ь) = 1.
              •                               1                   izl
       Свойство легко доказать цндукцией по n с помощью предыдущего свойства.
    6. Если 'r/i,j (ai, Ьj) = 1, то (П ai, П Ьj)                1.
       Следует из свойств 1 и 5.
    7. (at, а2, ... , a ) = (( ... ((at , а2) , аз) , ... ) , an),
                       n
       Для доказательства      достаточно использовать соотношение
                       D(at, а2 , ... , а11 ) = D(at) n D(a2) n . . . n D(an)
       и свойство ассоциативности пересечения множеств.


§ 3.     (ka- 1, kь- 1)                       =       k(а,Ь)      -·1
Вновь все числа, рассматриваемые в этом naparpaфe, nредполагаются натураль­
ными.
                    '
     Пусть k � 2. ДокаЖем сnраведливость фор�лы, вынесенной в заголовок
naparpaфa.
     Рассмотрим сначала случай, когда а кратно Ь. Имеем nри этом а= Ьq
и (а, Ь) = Ь (по лемме 1). Доказываемое равенство приобретает вид (ka-1, kь-1)=
kь - 1 . и равносильно тому, что ka 1 кратно kь - 1. С nомощью алгебраического
тождества
                      Yn 1=(у l)(yn-1 + 11n-2 + ... + У + 1)
                           _




получаем, что ka - 1= kЬq - 1 = (kЬ)q - 1 делится на kь 1.
     Пусть теnерь а не делится на Ь, т.е. а = Ьq + r, О < r < Ь. Имеем:

                        ka - 1 ::::;: kЬq+r       1   '=   kr(kЬq - 1) + kr - 1.
Как показано выше, kЬq-1 делится на kь-1. Кроме того, О < kr -1 < kь- 1. Таким
образом, остаток от деленця ka - 1 на kь 1 раQен kr - 1. Поэтому no лемме 2
(kt� - 1, kь - 1) = (kь - 1, kr - 1). Исполъзуп соотношения алгоритма Евклцда
    04; Простые чиспа. Ocнoetlall теорема арифметики        ------ 9
    а=      Ьqо + r,'     ь = r,q, + r2,    ft = r2q2 + Тз , . . . ' Tn-2 = Tn-lqn-1 + Tn , Tn-1 = qnrn,
    получаем цепочку равенств               (ka 1, kь - 1 )= (kь - 1, kr, - 1) = (kr1 - 1, kr2 - 1) =
             (kr•- 1 � 1 , kr• - 1 )       kr• - 1 = k (а,Ь) - 1 . Сопоставляя начало и конец этой
    цепочки, получаем требуемое.

            Пример. (288, 216)     = 18 '* (3288 - 1, 32 16 - 1 ) = 318 - 1.
            Важным следствием доказанного соочюшения является следующее утвер­


                    т
    ждение.
         Если             и n взаимно просты, то взаимно просты.ми будут и числа 2m
    и 211- 1.
            Действительно,         (m, n)= 1 =>(2m- 1 , 211 - 1 ) = 2(m,n)                1 = 21 - 1 = 1.


    § 4 . П ростые ч исла. Основная теорема ари фметики
    Натуральное число, большее                 l,   называется      простым,   если оно имеет ровно два
·   делителя        - 1   и само себя.                                                        �




            Натуральное число, большее               1,   не являющееся простым, называется                  состав-
    ны.м.
            l не является ни простым, ни составным числом.
            Огметим, что число является nростым тогда и только тогда, когда оно взаимно
    nросто со всеми меньшими натуральными числами.


    Теорема 4.      Множество простых чисел бесконечно.

                                       F      {n,, n2, . .. , nk}  всех простых чисел
    (n1 = 2, n2 =
    "' Предположим, что                                                   множество
                              3, n3        5, ... ) . Очевидно,    F попарно взаимно
                                                                    что   числа из
    просты; в силу последнего утверждения nредыдущего параграфа при i i= j числа
    211; 1 и 211j - 1 также взаимно просты. Выберем теперь для каждого i= 1, 2, .. . , k
    какой-нибудь простой делитель Pi числа 2 11;- 1; числа р 1, Р2   , Pk будут попарно
                                                                     G= {р1, р2,
                                                                                      •   . . .


                                                                                             , Pk }
    (р1 3, р2 = 7, р3= 3 1, . . . ) . Все элементы G - суть нечетные числа. Поскольку
    разJrичны. В результате образуется множество                                     • • •             простых чисел


    множества        F    и   G   содержат поровну элементов,             2 ЕF   и    2�          G,   делаем вывод,
    что в     G     найдется число, не входящее в              F.    Пришли к противоречию. Теорема
    доказана. ...


    Теорема 5 (основная теорема арифметики). Любое натуральное число, большее 1 , пред­
    ставимо в виде произведения простых чисел. Такое представление единственно
    с точностью до порядка сомножителей.

    "' Существование и единственность указанного представления для простых чисел
    очевидно. Доказательство теоремы для составных чисел проводится методом
    математической индукции.
                                                                                                                   2
    до а-
            Пусть а       -   составное число. Предположим, что все натуральные числа от
                1    раскладываются, и притом единственным� образом, в произведение
    простых чисел.
                                                                                                                                      .
10 ------- Глава LXVI. ,Эпементы теории. чмсеп

      Докажем существование соответствующего разложения и для а. Наименьший
делитель а, больший 1, обозначим р. Очевидно, р- простое число. Для некото­
рого натурального числа а1 имеем а= а 1 р , причем а1 <а. По предположению      ·



индукции а 1 раскладывается на простые множители, поэтому .тем же свойством
обладает и чйсло а.
    Единственность. Пусть существуют два разложения составного числа а на
nростые множители:


                            1
                                        а=Р1 Р2
                                              q2
                                              ·       qm.
                                                        ·
                                                            · · ·
                                                                    ·   Pn=q\ (1)           ·       ·
                                                                                                         · · ·
                                                                                                                 ·




Если Pi =f. qj       i и j, то имеем Vi, j (pi, qj) = 1 и по свойству 6 из§ 2
                           для всех

                а=(а, а)= (р1 Р2 .. Pn. q\ q2 . . . qт)= 1,
                                                    ·           ·       .   ·                   ·        ·           ·




что противоречит неравенству а > 1. Значит, для некоторых i и j Pi=qj. Пусть
а= а 1 Pi· Сокращая части равенства (1) на общий множитель Pi=qj, получим
         •

два разложения для числа а1• Поскольку а 1 < а, эти разложения совпадают.
Отсюда следует и единственность представления числа а в виде произведения
простых чисел. Теорема доказана. JJ.

      Представление яатурального числа в виде

                                                  а = Р1kl Р2k2     ·           ·
                                                                                    · · ·
                                                                                            ·   Prk. ,
где   р1, Р2   •   . . .   , Pr   -   попарно различные простые числа, называют                                                  каноническим
разложением                числа   а.

§ 5 . Сравнения и их свойства
В этом параграфе все числа предполагаются целыми.
      Пустьт - натуральное число. Говорят, чтоа сравнимо сЬ по модулю т, если
их разность а-Ь делится на m. При этом используется запи�ь а= Ь(mod т).
      Например, 7= l(mod 3); 1 2= -2(nюd 7) .                                          ·

      Очевидно, что

                                      а= Ь(mоd.т)              {::}             3t Е Z              а        =   Ь + тt.
Докажем следующее простое


Предложение.           а= Ь(mod т) тогда и только тогда, когда а                                                         и Ь имеют одинаковые
остатки от деления на т.

• Пусть  а и Ь при делении н а т дают остатки r 1 и r 2 соответственно:
           а=тq1 + r1, О�r1 <т; Ь=тq2 + r2, О�r2 <т.
Если а=Ь(m оd т) , то (а-Ь) ; т, т. е. (т(q1-q2)+r1 -r2); т, откуда (r1 - r 2): т .
С другой стороны, поскольку О� r1 , r 2 <т, имеем jr 1 -r 2 ! <т . Сопоставляя
два последних утверждения, получаем, что r1 -r 2 = О, поэтому r1 =r2•
     Обратно, при r1 = r 2 справедливо а- Ь=т(q1-q2): т. JJ.

     Заметим, что всякое число сравнимо по модулю т со своим остатком от де­
ления на т .
§ 5.. Ср авнеtiИ!Iммх свойства   ------ 11
Свойства сравнений
  l. а::::: a(modт). ( рефлексивностъ).
  2. а= Ь(modт) => Ь= a(modт) '(симметричность).
  3. а= Ь(modт), Ь= c(modт) => а= c(modт) (транзитивность) .
     .- Если (а - Ь) ; т, (Ь -с) ; т, то и а- с= (а- Ь) + (Ь с) : т. lill>
  4. а1 = bt (modт), az= Ьz(mod т)=> ar + az = Ьr + Ьz(mod т) .
     .- Если (at -Ьr) ; т, (а2-Ьz) ; т, то
     (ar + az) (Ьr + Ь2) (а1-Ь1) + (а2-Ьz) :т. lill>
  5. а1 = b1(modт), а2= Ьz(modт) => а1 а2= Ь1 Ьz(modт) .              ·      ·




     .- Числа ar и az можно представить в виде ar Ь1 + тt1 и а2 = Ьz + тt2;          =


     nоэтому а1а2-Ь1Ь2 (Ь, +тt,)(Ьz+тt2)-Ь1Ьz (Ь1t2+t2Ь1+тt1t2)т: т. lill>
                                   =                                             =




     Таким образом, сравнения по одинаковому модулю можно почленно складывать
     и умножать.
  6. а= Ь(mоdт) =>са сЬ(mоdт).
     Это свойство- следствие свойств 1, 5.
  7. а= Ь(mоdт), n Е N => an lfl(modт).
     Следствие nредыдуще го свойства.
  8. Ес.пи а = b(modт) и Р(х) - многочлен с целыми коэффициентами, то
      Р(а)      P(b)(modт).
      Следствие свойств 4, 6, 7.

·Примеры решения зада ч
  l) Доказать, что любое натуральное число сравнимо с суммой своих цифр по
      модулю 9.
      .- Пусть натуральное число k имеет десятичную заnись
                                                                                               n-1
  , k=       an-Ian-2    • • .   а1ао. Рассмотрим многочлен Р(х)                               � а, · xi, чьи коэф­
                                                                                               i=О
                                                                                                              n-1
      фициенты суть цифры числа k. Очевидно, что k                                             Р(10) , P(l) � Gj.
                                                                                                                =
                                                                                                                    i=O
     Поскольку 10 = l(mod9), в силу свойства 8 nолучаем P(IO)= P(l)(mod9),
     что и требовалось доказать.
     Частным случаем доказанного утверждения является известный из средней
     школы nризнак делимости на 9. Аналогично доказывается, что любое нату­
     ральное число сравнимо с суммой своих цифр по модулю З. lill>
  2) Вывести nризнак делимости на 11.
                                                                                         n-1
      Пусть, как и выше, k                     =   an-lan-2   • . .   а1ао. Р(х)         � ai    •   x i.   Так как 10 =
                                                                                         i=O
      -l(mod11) , имеем                k
                                  P(lO)= P(-l)(mod11) . Заметим, что
                                           =



                                  -'
                                                                      1
                            Р( 1) ао - а1 + а2 - аз + . .. +( -1)n...: an-1·                     ·




      Таким образом, число делится на 11 тогда и только тогда, когда делится на ll
      знакочередующаяся сумма его цифр.
12   ------                                                                        Глава LXVI. Элементы теорммчисел

 3) Десятичная заnись числа состоит из 95 единиц и нескольких нулей. Может ли
    оно быть квадратом некоторого натурального числа?
     � Пусть k - данное число. Как отмечалось выше, число сравнимо с суммой
     своих цифр по модулю 3. Поэтому k = 95(mod3) = 2(mod3).
     Выясним теперь, какие остатки может давать квадрат натурального числа n
     от деления на 3. Имеет место один из трех случаев: n сравнимо с О, 1 или 2 .
     по модулю 3.
     Если n = O(mod3) , то n2 = O(mod3) ;
     если n 1 (mod3) , то n2 = l(mod3);                ·



     если n = 2(mod3) , то n2 = 4 = l(mod3) .
     Таким образом, квадрат натурального числа не может давать остаток 2 от де­
     ления на 3; ответ на вопрос задачи отрицательн�Iй. �
 4) Докажите самостоятельно, что квадрат натурального числа при делении на 4
     может иметь остатки только О или 1.
 5 ) Доказать, что ( 330 23о) : 7.
     � Действительно, 330 = 271 0   ( - 1)10 = l(mod 7) ; 2 30 = 8 10 = 1 1 0 = l(mod7) ,
     откуда вытекает требуемое. �
 6) Доказать, ЧТО ДЛЯ ЛЮбОГО натуралЬНОГОn                           ( 52n+З + 3n+3 2n) : 1 9.   •




    � 52n+З = 125 25n = 11 6n(m od19) . 3n+З 2n
                       ·               •             27 6n = '8 6n(mod19).
                                                                       •
                                                                                         ·
                                                                                                         •



    Складывая сравнения, получаем: 52n+З + 3n+З 2n = 19 6n = O(mod19), что ·                 ·



    и требовалось. �
 7) Доказать, что для любого натуральногоn
    1 3 ( - so)n + 17 ·40n - 30 ; 1 989.
         ·




    � Разложим 1 989 на множители: 1989 = 9 ·13 ·1 7. Обозначим
    an 13 ( -5 0) n + 17 40n - 30. Докажем, что an делится на 9, 1 3 и 1 7.
               ·               ·


    Действительно, an 4 4n + ( - 1 ) 4n - 3 = 3 (4n - l)(mod9). Поскольку
                                   ·           ·                               ·



    4n - 1 = 1 n - 1    O(mod3) , 3 (4n - 1 ) ; 9 и an = 3 · (4n 1 ) = O(mod9) ,
                                           ·


    т. е. a n делится на 9. Делимос1:ь на 13 и 17 доказывается совсем просто:
    an = О + 1 7 1n - 30 = O(mod13) ; an = 13 1n +О - 30 = O(mod 1 7). Итак, an
                   ·                                             ·


    делится на попарно взаимно простые числа 9, 13 и 17, поэтому an кратно их
    произведению - 1989. �
                                          1000
 8) Найти остаток от деления на 3 числа П (k2 + 1 ) .
                                                           k=l

     �    Имеем:
         1000
         П    (k2 + 1) = ((1 + 1)(1 + 1 ) ·1)333 (1 + 1 ) = 4333 2 = 1333 2 = 2(mod3).
                                                   •
                                                                                    •                •


         k=l

     Остаток равен 2.      �

 9) Доказать, что уравнение х2 -4х + 1 2 у = 19 не имеет решений в целых числах.
     � Действительно, поскольку 4х -12у : 4, х2 = 4х 12у + 1 9 = З(mod4) , что
     противоречит результату 4). �
§6. Системы в.ычетов ------- 1 3

§ 6. Системы вычетов
Как показано в § 5, отношение сравнимости по модулю                            т   обладает свойствами
рефлексивности, симметричности и транзитивности; поэтому оно является отно­
шением          эквивалентности!).
         Возьмем произвольвое uелое число                  а.   Обозначим через ii множество чисел,
сравнимых с              т: ii = { х Е Z 1 х = a(modт)}. Пусть Ь tl ii и Б =
                         а   по модулю
{ х Е Z 1 х = Ь(mоdт)}. Пусть теперь с � ii u Б и ё { х Е Z 1 х = c(modт)}.
И так далее. Процесс будет длиться до тех пор, nока построенные множества
не будут покрывать все множество целых чисеЛ. При этом возникает разбиени� 2)
множества Z на множества ii, Б, ё, .. . , которые называют классами вычетов по мо­
дулю т; к�ое число, входящее в какой-нибудь из классов, называется вычетом
этого класса.
         Число классов вычетов по модулю                    т     равно   т.   Действительно, остаток
от деления целого числа на                  т   принимает одно из значений            О, 1, . . . , т- 2 или
т        l    и поэтому каждое из чисел nопадает в один из классов                         О, Т, .. . , т - 1,
количество К'?J'Орых равно                 т.
         Взяв по одному числу из каждого класса вычетов                   х1, х2, , Xm, получим си­
                                                                                   • • •


стему nредставителей классов вычетов, или                       полную систему вычетов по модулю т.
         Пример 1 . Различные nолные системы вычетов по модулю 7:
              1) О, 1, 2, 3,4, 5, 6;
              2) -3, -2, -1,0,),2, 3;
              3) 7, -6,9, -4, 1 1, -2, 13.


Лемма 3. Числа х1, х2, , Хт образуют полную систему вычетов по модулю тпiогда
                                 • • •


и только тогда, когда они попарно не сравнимы по модулю т.

• Необходимость очевидна. Докажем достаточность. Если два чисЛа не сравнимы
по модулю            т, то они nопадают в разные классы вычетов. Так как всего классов
вычетов          т    и рассматриваемых чисел т, то они составляют nолную систему
вычетов. .,.


Лемма 4. Пусть Xt, Х2, , Хт        полная система вычетов по модулю т, целое
                                   • • •


число а взаимно просто с т, Ь - произвольное целое число. Тогда числа ах1 + Ь,
ах2 + Ь, . .. , ахт + Ь также образуют noлffYю систему вычетов.

• Согласно леммеЗдостаточно убедиться в том,   что axi +Ь ;1. axi +Ь(modт) nри
i i= j. Предnоложим (для nриведения к nропщоречию), что axi + Ь =ах; + Ь(modт).

    J) Об
              L.XVIII;
               общем оnреде лении отношения и ero свойствах речь nойдет ни же - в гла­
         ве           заметим, что теория ч исел являетс я источником мноrих важных
         примеров для общей алrебры.
    2)   Разбиенt�е множества            это представлени е ero в виде объединения поnарно
         не nересекающихся подмножеств.
                                                                                                         '

14   -------                                                          Dlaea LXVL ЭnеменtЫ теории чисел

Тогда a(xi-Xj); т, и, поскольку (а, т)= 1, имеем (xi-Xj);т, что противоречит
лемме 3 . ..,.

Лемма 5.   Пусть х = a(mod т). Тогда (х, т)= (а, т) .

.,. Действительно, пусть r - остаток от деления а на т. Тогда по лемме 2
(а, т) = (r, т). Но так как х = a(mod т), при делении на т число х'также имеет
остаток·r, и, следовательно, (х, т)= (r, т), откуда и вытекает требуемое. ..,.
     Итак, числа из одного класса вычетов по модулю т имеют один и тот же
нанбольший общий делитель с т. Поэтому становится корректнЫм следующее
опредещшие.
     ВыЧет по модулю т называют приведенным, если он взаимно прост с т.
Совокупность приведеиных вычетов из разных классов вычетов называют приве­
денной системой вычетов.
     Пример 2. При т = 7 nриведенная система вычетов может выглядеть так: 1, 2, 3,4, 5, 6;
     а nри т= 6 так: 1, 5 .        ·




       Функцией Эйлера IР(т} называют число натуральных чисел, не превосходя­
щих т и взаимно простых с т. Например, lf'(l) 1; 1!'(2) = 1; lf'(З) = 2; 1!'(4) 2;
1!'(5) = 4. Легко видеть, что если р -простое число, то lf'(p) = р- 1.
       Очевидно, что nриведеиная система вычетов по модулю т содержит V'(т)
чисел.

Лемма 6. Пусть а взаимно просто с т, k = �!'(т). и х1, х2,.,. , Xk приведенная                   -


система вычетов по модулю т. Тогда числа ах1 , ах2 , , axk также образуют
                                                                       • . .
                                                                                                     ·

приведеннуЮ систему вычетов по модулю т.

.,. Так как числа а и Xi взаимно просты с т, таким же свойством обладает и их
произведение axi. В силу леммы 4 числа ах1, ах2, , axk принадлежат k разным
                                                          • • •


классам вычетов, и, следовательно, в силу предыдущего, образуют приведеиную
систему вычетов. ..,.


§ 7 . Те орема Эйлера
Пусть т -натуральное число, k = IР(т), х1, х2,         , xk -приведеиная система
                                                          • • •


вычетов по модулю т. Пусть а-какое-нибудь натуральное число, взаимно про­
стое с т . Тогда в силу результатов предыдущего параграфа числа ах1, ах2, . . . , axk
также образуют приведеиную систему вычетов по тому же модулю. Поскольку
axi  -  приведенный вычет, для некоторого числа ij Е {1, 2, . . , k} справедливо             .



соотношение axj = Xij(mod т). Числа i1, i2, ... , ik попарно различны и поэтому
образуют перестановку чисел от l до k. Перемножив k полученных сравнений,
получим
                     k
                    a х1 Х2 . . Xk:::: Xi1 • Xi2 • . Xik(mod т).
                                       •                  •




     Пусть s = Xt х2
                                                 •




                                                                 Xik также равно s.
                        ·                  · .       ..




                            Xk . Тогда произведение Xi, Xi2
Заметим, что поскольку делители s взаимно просты с т, число s также обладает
                    ·       ·   . . • ·                           ·            • • • •   •
оа. ЛИИейiiЬiе АМСJФантовы yp&lsиeИИII   ---'--- 1 5
этим свойством. Итак, a ks               s(mod т), отсюда s(ak- 1) :т, и, в силу взаимной
простоты s и т, имеем ak                 1 :т. Доказано следующее утверждение.

Теорема 6 (Л. Эйлер, 1736 г.). Если целое числоа взаимно просто с натуральным чис­
лом т, то число a�(m) - 1 делится на т.


Следствие (малая теорема Ферма). Пустьр .:_ простое число,а - целое
                                                                 ' число, не крат-
ное р. Тогда aP-I- 1 делится на р.·

     Заметим, что в условиях малой теоремы ФермааР-а делится нар, но nо­
следнее справедливо и при а, кратномр. В связи с этим часто под малой теоремой
Ферма понимают следующее легко запоминаемое утверждение:
     Если р - простое число, то для любого целогоа числоаР а делится на р.
     Малая теорема Ферма дает лишь необходимое условие простоты числа. Нечет­
ное число т� 3 называют условно простым по базе а а     (   2, 3, . . . , т- 1), если
am-l = I(mod т). Простое число является условно простым по любой базе. Су­
ществуют, однако, составные числа т, являющиеся условно простыми по любой.
базеа, взаимно простой с т. Такие числа называют числами Кармайкла. Наимень­
шее из них - 561. В 1994 г. бьто доказано, что чисел Кармайкла бесконечно много.
     В nоследние годы задача проверки nростоты числа или - более широко
задача разложения числа на nростые множители вновь nриобрела актуальность
в связи с nроблемами создания надежных шифров (см.§ 10).


§ 8 . Л инейные ди офантовы уравнени я
Диофантовым з) называют уравнение в целых числах вида
                                          P(Xt, .. . , Xn ) = О,
где Р - многочлен от n переменных с целыми коэффициентами. ПредмеТом
изучения в этом параграфе будет служить линейное диофантово уравнение с двумя
неизвестными
                                  ах+Ьу = с,                               (1)
где а, Q и с - целые константы, а х и у - неизвестные, или nеременные.
Решением (более точно, частным решением) уравнения, как известно, называют
набор значений nеременных, обращающих его в верное равенство. Стоит задача
описания всех решений уравнения ( 1 ) в целых числах.
     Если один из коэффициентов nри неизвестных равен нуЛю, то уравнение
фактически сод!1ржит лишь одно неизвестное. Поэтому будем считать, что а f О
и Ь f О. Более того, nри необходимости меняя знак nеременной, можно без
ограничения общности считать в этом случае, что а > О и Ь > О. Пусть d -
наибольший общий делительа и Ь. Тогда для любых целых х и у левая часть
уравнения ах+Ьу делится на d. Если nри этом с не делится на d, то уравнение
   З) В честь древнеrреческоrо математика Диофанта, жившеrо в IП веке.
f6   -------'-                                                           Гn• LXVI� Эпемеиты теорим Чисеll

не имеет ( целых) решений. Если же с кратно d, т. е. с= c1 d для некотороrо цело­
ю  с1, то, nоложив а = a1d, Ь = b1d и сократив на d, уравнение (l) сведем к виду
                                       а,х + Ь1у
                                         с,,
в котором коэффициенты при неизвестных являются взаимно простыми числами.

Теорема 7. Уравнение ( 1 ) с взаимно простыми коэффициентами при неизвестных раз­
решимо в целых числах.

.-. Рассмотрим сначала уравнение
                                          ах + Ьу= 1.                                                (2)
Построим цеnочку делений с остатком
                            а= Ьqо + r1,                    О < r1 < Ь;
                            Ь= r1q1 +r2,                    О < r2 < r1;
                            r1 = r2q2 + rз,.                О < rз   <   r2;

                         fn-2    rn-Jqn-1 + rп,             О < rп < rп-1;
                         fn-1    .rnqn.
Последний неиулевой остаток, как известно, равен наибольшему ()бщему делите­
лю а и Ь, т. е. rn = 1 . Заметим, что каждый остаток ri может быть ·представлен
целочисленной линейной комбищщией а и Ь: ri = aia + fЗiЬ. ДействиТельно,
           r1     а- Ьqо =а, а + fJ1Ь;
           r2     Ь - r1q1 = Ь- (а1а + f3,Ь)q, ; сх2а + fJzb;



           1 = rn      ana + fЗnЬ.
Последнее равенство показывает, что пара целых чисел (an, fЗn) является реше­
нием ( 2). Очевидно, что пара целых чисел (са11, cfJп) -суть решение ( 1 ). Теорема
доказана. 111>
     Пример 1. Найти какив-нибудь целые     :z   и   у,   для которых

                                           lОООж + 73у = 1 .
     ..-. Применив алгоритм Евклида к паре чисел    1000 и 73, nолучим цеnочку равенств
            1000 = 73. 13+51;        73 =51· l + 22; 51= 22.2 + 7; 22 7. 3+ l,
     и з которых получаем

            l = 22    7. 3 = 22- 3(51-2. 22). =7.22-3. 51 = 7(73-51)-3. 51
                = 7.73 10· 51= 7. 73 10(1000-73 ·13) = -10 ·10 000+137.73.
     Ответом в данной зад� 'iе может служить пара (-10, 137). •
f9. Мупьтиммкатмвные фуНIЩМИ         ------                                               17

     Итак, мы теперь умеем находить частное решение уравнения ( 1) (в том случае,
когда Это диофантово уравнение разрешимо). О том, каким является общее реше­
ние ( 1) -множество всех (частных) решений, говорит

Теорема 8. Пусть а и Ь - взаимно простые нат ура льные чи сла, (х0, Уо) - некоторо е
решение дuофантова уравнения ( 1). Тогда множество всех решений ( 1) описывается
формулами
                                      х = Хо + bt,   у = Уо    at,                       (3)
где t Е Z.

,.. О<:tевидно, что для любого целого t значения              х   и у, определяемые формула­
ми (3), дают решение ( 1). Действительно,
                              а(хо   + Ы) + Ь (уо- at) = аха + Ьуо     с,

так как (хо, у0) удовлетворяет ( 1) по условию теоремы.
     УбедимсЯ теперь в том, что произвольное решение ( 1) имеет вид (3) для
некоторого целого t. Вычтя из ( 1) почленно равенство ах0 + Ьу0 = с, получим
равносильное уравнение а(х х0) + Ь(у- Уо)= О, или
                                        а(х- хо) =т Ь(уо- у).                            (4)
Из того, что а(х- х0) кратно Ь и а взаимно просто с Ь, следует (х- х0) : Ь, т. е.
для некоторого целого t имеем х- х0 = Ы, или х = х0 + Ьt. Подставив вьrражение
для х в (4), nолучим аЫ Ь(уо у) и, nоскольку Ь =f. О, сnраведливо равенство
Уо - у = at, или у = Уо - at. Теорема доказана. ..,.
     Пример 2.   Общее решение рассматривавшегося выше уравнения 1 000!1: + 73у = 1 таково:
                               {(- 10 + 73t, 137 - lOOOt) 1 t Е Z}.


§ 9. Мультипликативные фун кции
Функция натурального аргумента O(n) называется мультиплu"ативной, если для
любых взаимно простых чисел т и n выnолняется равенство

                                       jo(m · n) = О(т) O(n).j
                                                        ·




      Простейшими nримерами мультиnликативных функций являются степенная
функция 8(n) = na и постоянные функции                  O(n)
                                                  = 1 и O(n) О. Заметим, что
8( 1) 8( 1· 1) = 0( 1)·8( 1), откуда      O(l)
                                     может быть равно l или О. В последнем случае
't:/n O(n) = e(n ·1) = e(u) . о о. Чтобы ИСКЛЮЧИТЪ возможность тождественного
равенства нулю, иногда в оnределение мультиnликат:цвной функции включают
дополнительное требование: 8( 1) = 1.
                                                                                          ·




       Пусть n1,n2, , n,., - поnарно взаимно nростые числа. Индукцией легко
                      • • •



доказать, что для любой мультиnликативной функции сnраведливо соотношение
18 --------'- Гnasa LXV!• Элементы .T�IIчttel!l

    До конца этого параграфа будем считать, ч.то n имеет каноническое раЗJю-
жение
                             n = Р1k1 Р2kz' ·Psk, ·                 · ·



    Докажем сначала мультиnликативность функции Эйлера (определение см.§ 6).
Пусть т и n - взаимно простые числа. Чтобы подсчитать количество чисел,
не превосходящих тп и взаимrю простых с тп, расположим все числа от 1 до тп
в виде следующей таблицы (табл.l).

                                                         Таблица 1

             l                             2                                  3                             .. .            n
          n+l                             n+2                               n+З                             ...             2n
         2n+ 1                            2n+2                              2n+З                            ...             Зn


      (m- l)n+ 1                    (m l)n+2                            (m-l)n+З                            ..   .          mn

     Любое натуральное число взаимно просто с тn тогда и только тогда, когда
оно взаимно просто и с т, и с n (в силу взаимной простоты чисел т и n ). Числа
из каждого фиксированного столбца таблицы попарно сравнимы по модулю n;
поэтому можно оставить в таблице только столбцы, nервые элементы которых вза­
имно просты с n, не потеряв при этом ни одного интересующего нас числа. Число
таких столбцов есТЪ <р(n). Элементы каждого столбца в силу леммы 4 образуют пол­
ную систему вычетов по модулю т . Поэтому ровно <р(т) элементов каждого столб­
ца взаимно просты с т. Таким образ<;>м, всего имеется <p(n) ·<р(т) чисел не больше
тn и взаимно nростых с тп, т. е. <р ( тn) = <р(т)·<р(n), что и требовалось доказать.
     Используя свойство мультипликативности, ветрудно вывести формулу для
вычисления <p(n)4>. Поскольку <p(n) = <р(р�') <р(р�2) •          <р(р�'), достаточно
                                                                              ·                 • • •
                                                                                                        •



научиться вычислять функцию Эйлера от стеnени простого числа. Для этого
заметим, что если р         nростое число, то среди любых р последовательных
натуральных чисел ровно р - 1 чисел взаимно nросты с р, а также с любой
стеnенью р. Поэтому <p{JJ" ) = <р(р pk-1) = (р- 1 ) pk-1• Таким образом,
                                                                      ( 8                                         (
                                                    ·                             ·



                  s                  s                                                                               s
      <p(n) = П <р(р�') = П (pi
                 i=l               i =1
                                               1)   ·
                                                         k·-1
                                                        Р/      =
                                                                    .
                                                                    П
                                                                    i=I Р•
                                                                           ) Р/
                                                                             1 - -:   1
                                                                                          '

                                                                                              · k
                                                                                                 ·
                                                                                                        =   n   П
                                                                                                                i=I р,
                                                                                                                       )   1
                                                                                                                         1--: .


       Пример 1 .     �(24) = 24. l- (     �) ( �) =l-              8.

    Рассмотрим еще несколько задач, при решении которых возникают мульти­
nликативные функции.
 l)    Найти r(n) -число различных делителей натуральноrо числа·n (включая 1
       и n).

   4) Ниже  (§ 8      гл.   LXVIП) будет nоказаЛ еще один сnособ nолучения указанной
       формулы.
 § 9. Му.nь1'МIU1ИкатмвtiЬlе фJИIЩИI!         ---��---                                                                                                  19

        Общий вид дещпеля n имеет вид




 где для ка:>�<доrо        i   показателъ стеnени r; принимает значения О,                                                           1, ... , ki·   Произ­
 вольный делитель числа n можно nостроить в результате выnолнения процедуры
 из s действий, где             i-e      действие состоит в выборе 'l'i -nоказателя степени про-
. стох;о числа    Pi. Поскольку i. -е действие может бьrrь выполнено ki + 1 способами,
 nрименение правила произведения дает

                                                                                                          8
                            r(n)=         (k1 + J)(k2 + 1) ... (k8 + 1) = П(ki + 1).
                                                                          i=l
        Пример 2.
          1) т(23• 34• 56)= 4 5 7 140.    ·       ·



          21 r(23 34 45) = т(213 • 34) = 14 · S = 70.
                    •   •




   2)   Найтиu(n) -сумму всевозможных делителей числа n.
        Покажем, что

 u(n)= ( 1     +Р1 +Pi + . . . +P�')(l +pz +Р� + ...+Р�2)                                                 • • •   (1 + Рн +р;+ .. :+р:•).
 Действительно, раскрывая: скобки и не меняя nри этом порядка множителей,
 nолучим

                    u(n) =          1 · 1 .. .·        ·   l   + l · l .. . · Ps + . . . +Р1'Р�2
                                                                              ·
                                                                                                                     •
                                                                                                                         • • •
                                                                                                                                 •   р:·
 -сумму всех делителей n. С помощью формулы суммы членов геометрической
 nрогреесии nолучаем комnактную формулу

                                                                             8  ki+J
                                                           u(n)=            П Pi -1 1 ..
                                                                            i=O Pi-
        Пример 3.
                                                  23 - l               32 - 1
                                                                       3_ 1
                                2
                                                                                            ·..


          1} о-(12) = и(2           ·   3) =          _            ·              = 7 · 4 = 28.
          2) и(60) = и(12) · u(5)                      28 6 = 168.
                                                               ·




   3) Функция Мёбиуса JJ(n) вводится следующими соотношениями:

          • JJ(l)=l;
          • если n делится на какой-нибудь точный квадрат>                                                          1 , т. е. для некотороrо i
              выполняется�>                           1, то JJ(n)=О;
           • если же ·все показатели степени                                           k;         равны   1,      т . е. n =     Pt Р2 • •.• • Ps
                                                      -различные простые числа) S), то
                                                                                                                                            ·



              (где P t ,   Р2• . . . , Ps                                                                                   J!(n) = ( -1 )8 �
 Проверка мулътиnликативности функций r(n), o-(n), JJ(n) проводится непосред­
 ственной подстановкой.

     s) В этом случае говорят,           что число n свобсдiю от квадратов.
20   -------                                                            rnaвa I.XVI. ЭлементЫ теоJ;!Щ� чисеп

§ 1 0 . Система РША
 В этом параграфе будет показано, какое применение нашли некоторые классиче­
 ские ре�улыаты теории чисел к решению проблемы создания надеЖНЪiх шифров -
 проблемы чрезвычайно актуальной в эпоху массового распространения телеком­
 муникаций.
       Системой тайнописи с открытым ключом (pиhlic key cryptosystem) называют
 так:ую систему шифрования и дешифрования информации, которая удовлетворяет
 следуЮщим двум условиям:
    • получатель информации nубликует алгоритм шифрования для всеобщего све­
       дения;
    • алгоритм дешифрования известен только получателю информации (держится
       им в секрете) и практически (с помощью вычислительной техники) не может
       быть раскрыт.
 Шифрующий и дешифрующий алгоритмы называют соответственно открытым
 и закрытым ключом.
       Идея подобной системы тайнописи была высказана в                         1975
                                                                        г., эффективная
 реализация идеи бъmа предложена в                 1977,
                                              r. тремя американскими математиками:
 Р. Р,айвестом, А. Шамиром и Л. Адлеманом; первые буквы их имен 6) составили
 имя придуманной ими системы. Описание РША-системы nредварим некоторыми
 соображениями, связанными с общей идеей тайноnиси с открытым ключом.
       Всякое сообщение, передаваемое с помощью компьютера по электронным
 сетям, может быть представлено в виде элемента некотор.оrо числового множе­
 ства  S. Пусть   х Е S; результат шифровки х (шифрограмму) обозначим               l(x),      у=
,rд е 1 -  фун кци я, задаваема я а лгоритмом  шифр  о вки . У добно считать , что у тоже
 nрин,адлежит S; при этом функция 1 должна осуществлять взаимно однозначное
 отображение      Sна себя (разным сообщениям должны соответствовать разные
 шифрограммы, и наоборот), такИм образом, функция 1 должна осуществлять не­
 которую перестановк:у элементов (т. е. 1      S   подстановка, действующая на мно­
            S).
                                                           -


 жестве       Дешифрующий алгоритм состоит в применении обратной подстановки
 1-1 к шифрограмме            у Е S: х =
                                    l-1(y). Если множество содержит n элементов, то
 на нем определено n! различных подстановок. Теоретически можно найти обрат­
 ную подстановк:у 1-1, вычислив f(x) для всех                  х Е S.
                                                             Если, к примеру, сqстоит          S
 из всех последовательностей             200
                                       десятичных цифр, то n                 = 10200 ,
                                                                           и реализовать
 предложенный алгоритм за обозримое время невозможно; знание открытого клю­
 ча не дает, таким образом, практическ:ий возможНости найти закрытый ключ.
       Покажем, .как решается в nредложенной системе тайнописи проблема элек­
 тронной подписи. Предположим, что имеется группа бизнесменов, которым требу­
 ется сообщать друг друту сведения, составляющие коммерческую тайну. Каждый
 бизt{есмен nридумывает свой алгоритм шифрования (прямой алгоритм); при этом
 он знает и обратный алгоритм. У частники группы издают специальный справоч­
 ник, в котором приводят полностью все nрямые алгоритмы (обратные алгоритмы
 держатся в секрете). К справочнику имеет доступ любой желающий. Пользуясь
 справочником, можно послать сообшение любому члену группы, например, Z,
     6) В оригинале   -   RSA (Rivest, Shamir, Adleman).
§ 10. 'Смстема РША   _______                                                        21

зашифровав сообщение с nомощью {nрямого) алгоритма fz . Понять Это сооб­
щение сможет только Z, nоскольку только он знает обратный алгоритм fi1 •
Теперь допустим, что бизнесмен А хочет подписать свое сообщение, т. е. добиться
того, чтобы у Z не было сомнений в том, кто действительный автор сообщения.
Тогда бизнесмен А шифрует свое сообщение х дважды: сначала с помощью сво­
его обратного алгоритма !А. 1 , а затем полученная шифрограмма шифруется еще
раз с помощью nрямого алгоритма /z . В результате Z nолучает шифроrрамму
у /�(/А.1 (х)) . Длн того чтобы восстановить исходное сообщение, Z применяет
свой обратный алгоритм fz 1 , а затем (всем известный) прямой алгоритм /л :
fл(/i_ 1 (y)) = х . Теnерь бизнесмен Z знает, что только А мог nослать ему этот два­
жды зашифрованный текст, так :как при шифровании бьm исnользован секретный
алгоритм бизнесмена А.
Описание системы PWA
Множество S составляют натуральные числа, меньшие некоторого натурального
числа т и взаимно простые с ним; таким образом, S                 -приведеиная система
вычетов по модулю т. Функция f(x) вычисляет остаток от деления xk на т ;
nри этом nоказателъ стеnени k должен быть взаимно nростым с 1р(т) ( 1р(т)
функщJя Эйлера) . Числа k и 'т составляют открытый ключ. В качестве закрытого
:ключа используется такое число k', что k · k' :::: l(mod 1р(т)) . Пусть у = xk(mod т)
и О � у < т . Тогда
                 yk' = хн' x l+s·� (m) = х (x�(m)y := x(m od т) ,
                                              ·




так :как по теореме Эйлера x'l'(m) = l (mod т) при взаимно простых х и т.
     Зная разложение т на множители, легко вычислить 1р(т). Покажем, как
по 1р(т) найrи k'. Рассмотрим диофантово уравнение
                                  kx + 1р (т)у = l.
Коэффициенты nри неизвестных х и у п о условию взаимно просты, поэтому
уравнение разрешимо, а его общее решение Имеет вид
                           х   хо+ 1р(т)t ,       у = Уо - kt ,
где t   - произвольмое целое число, а (х0, у0) - .некоторое частное решение
уравнения. Ясно, что при некотором t число х будет полоЖительно и может быть
выбрано в качестве k', так :как kx = l (mod 1р(т)) .
     Как правило, в качестве т берут произведение двух (многозначных) nростых
чисел: т = pq, тогда �(т) (р - l)(q - 1 ) .
     В оригинальной публикации { 1 977 г. ) о методе РША р и q бьти соответ­
ственно 64- и 65-значньiми числами. Авторы опубликовали :1ашифрованный текст
из 129 цифр и открытый ключ ( 128-значное число т и k = 90Q7 ) , nредложив
 100 долларов тому, кто первый расшифрует текст. Существовавшие в то время
алгоритмы разложения числа на простые множители (а также быстродействие
вычислительной техники) не позволяли найти разложение 129-значноrо числа т
за разумное время.
     Лишь спустя 17 лет с помощью метода квадратичного решета указанное
129-значное число было раЗJtожено на множители, что потребовало девятимесяч­
ной работы примерно 1600 :компьютеров, объединенных сетью Интернет.
22   ------- Глава LXVI. Элементы теьрии чисел
    Ныне для вы9ора р и q рекомендуют 200-значные числа.
    В заключение остановимся на технике вычисления остатка от деления xk
на m. Эта оnерация не столь трудоемка, как может nоказаться на nервый взгляд.
С nомощью двоичного представления числа k
                                                                 s

                                                   k=           L Ьt2i
                                                                i=O

получим,        что

                                             х" ::::   П xi (modm).
                                                       О; ;СО

Количество умножений ( по модулю m) при вычислении степеней числа х
                            х' х2 ' х4 хв , . . . , хz•
равно s ( каждое число в этой nоследовательности, начиная со второго, получается
из предыдущего возведением в квадрат) . При вычислении ранее nриведеино­
го произведения понадобится не более s умножений. Таким образом, общее
число умножений не nревосходит 2s, где s � log2 k. Наnример, при вычисле­
нии 9007-й степени понадобится 20 умножений (двоичное представление 9007:
1 0001 1 00101 1 1 1 ) .

                                                   Уn ражнении

     1.   Является ли число 57 599 nростым?
     2.   Найти наибольший общИй делитель чисел
          1) 321 и 843; . 2) 2 166 и 6099; 3) 6787 и 7194;               4) 23521 и 75 217.
     З. Пусть r11          n-значное число J 1    . . . 1 . Доказать: (r11, rт)    r(n,m) ·
     4. Показать, что простое число р является делителем n! с Iфатностью                      L
                                                                                              k) l
                                                                                                     ;   .


     5. Заnисать 20! в виде nроизведения степеней nростых чисел.
     6. Найти остаток от деления
          1) 6100 на ,7;    2) 6100 на 35;   3) 1010 + 10100 + 101000 + . . . + 10ю10 на 7.
     7. Доказать, что
         1 ) 3099 + 6 1 100 делится на 3 1 ;
       . 2) 43101 + 23101 делится н а 66;
          3) 1 1 10 - 1 делится на 100;
          4) 7120 - 1 делится на 143.
     8. Пусть    k нn        натуральные числа. Доказать, ч1о k11+2 +(k+ 1)211+1 делится на k2+k+ l .
     9. Доказать, что если сумма квадраТов двух целых чисел делится на 3 , то и каждое из них
          делится на 3.
 1О . · Доказать,   что если сумма квадратов двух целых чисел делится на 7, то и каждое из них
          делится на 7.
 11.      Пусть n = 2(mod 3), n = 3(mod 5) . Найти остаток от деления n на 1 5.
 12.      Выяснить, при каких k � l l сумма квадратов k nоследовательных натуральных чисел
          может быть квадратом натурального числа.
�       -------                                                                                              23

 13. Найти остаток от деления
     1) 2100 на 101; 2) 3 102 на 1 0 1 ; 3) 8900 на 29;
                                                    4) 7120 на 143.
 14. Доказать, что для любого натурального n число n73 :.._ n37· делится на 10.
 15. Доказать, что если n не делится на 17, то либо n8 - 1, либо n8 + 1 делится на 17.
 16. Решить в целых числах уравнения:
     1) 16х + 4у = 1830; 2) 13х + 7у = 1 ; 3) 2 1х + 19у = 5 ; 4) 1994х - 171у = 1 .
 17. Даша гадает на ромашке: «Любит - не любит - плюнет - поцелует - к сердцу
     прижмет - к черту nошлет,.. Глаша при гадании к этим шести вариантам добавляет
     еще один: «своей назовет». На ромашках с n и 2n леnестками у Даши хорошее пред­
     сказание, а у Глаши плохое. Чему равно n, если считать, что на ромашке не может
     быть более 100 лепестков?
 18. На клетчатой бумаге нарисован прямоугольник. Количество его клеток, nримыка­
     ющих к границе прямоугольника, равно количеству остальных его клеток. Найти
     размеры прямоугольника.
 19. Доказать, что произведение мультипликатив�ых функций мультипликативно.
 20. Найти количество чисел, не превосходЯЩИХ т и взаимно простых с т для т =
     25, 60, 250, 1 000 000.
 21. Сколько существует правильных несократимых дробей со знаменателем 288?


                                                  Ответы

1 . 57 599 = 2402 - 1 = 239 . 24 1 . 2. 1) 3; 2) 57; 3) 1 1; 4) 1 . 5. 2 18 • 38 • 54 • 72 • 1 1 . 13 . 17 . 19.
6. 1) 1 ; 2) 1; 3) 5. В последнем примере имеем: 1010 = 310 = 95 = 25 = 4(mod 7) ;
10100 = (1010)10 :::: 4ro :::: (-3)10 :::: 310 = 4 mod 7. Далее по индукции легко докаЗать, что 'V k
10 101 :::: 4(mod 7) .1 1. 8. 12. При k = 2 и 1 1. 13. 1) 1 ; 2) 3102 = 3100 • 32 = 9(mod 101) ; 3)
                    .



8900 = 828-32 • 84 = 84 :::: 62 = 7(mod 29) ; 4) 1. 1 6. 1) Решений нет; 2) х = - 1 + 7t� у = 2 - 13t,
t Е Z; 3) х = -7 + 19t, у = 8 - 2 1t , t Е Z; 4) х = 56 + 171t, у = 653 + 1994t , t Е Z. 17. 17.
18. 12 х 5 или 8 х 6. 20. 20, 16, 100, 400 000. 21. 96.
ГлаваLХИ/          ___________________________




                  НАЧАЛЬ Н Ы Е ПОНЯТИ Я
                        О Б ЩЕЙ АЛГЕБРЫ


    С   простейшими алгебраическими операциями               арифметическими действи-
ями над числами        мы встречаемся еще в начальной школе, но об алгебре говорим
только тогда, когда приступаем к решению задач, содержащих буквенные nеремен­
вые - известные и неизвестные. Тождественные иреобразования буквенных выра­
жений, решение алгебраических уравнений, где nод бУквами понимаются действи:..
тельные или комnлексные числа, составляют содержание               элементарной алгебры.
Одна из основных проблем здесь           решение уравнения n-ой степени в радикалах




т. е. задача отыскания формул, выражающих корни уравнения через его коэффи­
циенты nри помощи простых арифметических операций                  сложения, вычитания,
умножения и деления        и nроцедw извлечения корней. Например, для уравнения
второй степени   а2х2 + а1х + ао     О   эти формулы имеют вид


                                                      -а ,    .;
                                                             + ar 4а2ао
                                                                     -


                                                               2а2
                           '
Похожие формулы есть и для уравнений третьей (формула Кардано) и четвер­
той (формула Феррари) степени. Однако         для   уравнений, степень которых выше
четвертой, подобные формулы, вообще говоря, получить · нельзя. Этот результат,
опубликованный Нильсом Хенриком Абелем в            1824 году, не nриостановил попыток
исследования уравнений высших степеней. К этому времени уже было известно,
что всякое уравнение n-ой степени с комnлексными коэффициентами имеет ровно
n комnлексных корней, и усилия математиков были направлены на описание клас­
сов уравнений,   для   которых решение все-таки может бьrrь получено в радикалах,
и на установление условий, обеспечивающих подобную разрешимость. Эта задача
была блестяще решена молодым французским математиком Эваристом Галуа, чьи
результаты стали известны широкой математической общественности в               1830 году
(полное изложение результатов Галуа было дано Жозефом Лиувиллем в              1846 году) .
    Работа Галуа стала основой новой алгебраической идеологии - он перенес
центр тяжести исследования      (й данном случае задачи решения уравнений)          с соб­
ственно задачи на методы ее решения. Введенные им при этом понятия                группы,
                                                                           1
§ 1 . Отноwения ------ 25

поля, композиционногоряда и др. надолго оnределили nyrи развития алгебры. В част­
ности, поиятие груnnы оказалось столь nлодотворным в разных областях математи­
ки (в геометрии - груnnы nреобразований, в теории чи�ел - груnnы вычетов, в линей·
ной алгебре - груnnы матриц, в тоnологии - гомологические груnnы) и естествозна­
ниЯ (груnnы симметрий в кристаллографии и квантовой механике), что стало одним
из центральных объектов nриложения сил математиков различных наnравлений.
     Дальнейший прогресс в алгебре связан с расnространением понятия алгебраи­
ческой операции с чисел на объекты печиеловой nрироды - элементы абстрактных
груnп, матрицы, кватернионы, подстановки и т. n. Все это nривело к nостеnенному
nереносу интересов алгебраистов с исследования конкретных объектов (уравне­
ний, систем уравнений и т. д.) на абстрактные - груnnы, кольца, nоля, модули ­
и на изучение произвольных алгебраических операций.
     Именно абстрактные алгебраические оnерации и абстрактные алгебраиче­
ские системы являются nредметом изучения современной алгебры, которая окон­
чательно сформировалась в nервой половине ХХ столетия под влиянием работ
Д. Гильберта, Э. Артина, О . Ю. Шмидта, Б. Л. Ван-дер Вардена, А. И. Мальцева,
Дж. Биркгофа и др.


§ 1 . Отношения
Понятие отношения в математике служит для теоретико-множествеиного оnисания
связей между элементами множеств.
     Пусть А - некоторое множество с элементами {а, Ь, . . .} . Рассмотрим декар­
                                                        Е    Е
тов квадрат этого множества А х А = {(а, Ь) 1 а А , Ь А} - множество уnС!ря­
доченньiх пар элементов множества А.
     Пусть n - некоторое подмножество множества А х А. Мы будем говорить,
               Е                                                      Е
что элемент а А находится в оlf'lношении n с элементом Ь А и записывать это
как апь или n(a, Ь) в ТОМ случае, когда (а, Ь) n.   Е
     Множество n С А х А при этом называется двуместным (или бинарным) от­
ношением на множестве А.
     Рассмотрим несколько примеров, иллюстрирующих понятие бинарного от­
ношения.
     Отношение «не больше». Пусть А = IR. - множество действительных чисел.
В этом случае декартов квадрат А х А = IR. х IR. можно отождествить с nлоско­
стью IR.2 • Положим n = {(а, Ь) IR.2 1 а � Ь} . В этом случае множество n задает
                                   Е
на множестве действительных чисел отношение nорядка - число а находится
в отношении «Не больше•> с элементом Ь тогда и только тогда, когда а � Ь.
     Отношение сравнимости по модулю т изучалось в §             5.
     Отношение «функция». Пусть А = IR. - множество действительных чисел,
а f : IR. ---+ IR. - некоторая функция. Положим n = { (а, Ь) IR.2 1 Ь f(a) } . Это
                                                                      Е
                '                                                              =


отношение задает функциональную связь между числами а и Ь: если аRЬ, то
это означает, что Ь = f(a) . Важнейшими бинарными отношениями являются
отношения эквивалентности, порядка, и функциональные отношения l ) . Первые

   l) Примерам отношения эквивалентности может служить отношение сравнимости
      по модулю т ; примерам отношеf!ИЯ порядка - отношение •не больше•.
26 ------ Гnааа Lxvtl. HO'Ian�oкwe понiтия общей urебры

два типа отношений будуr определены и рассмотрены ниже, а здесь мы определим
                                           ·

только функциональные отношения.
     Бинарное отношение 'R- называется функционшгьны.м, если из a'R-b и anc
следует Ь = с. Т. е. каждому элементу а , стоящему на первом месте в отношении,
отвечает не более одного элемента, который может быть поставлен на второе
место. Леrко видеть, что всякое функциональное отношение определяет некоторую
функцию посредством задания ее rрафика.

Свойства отношений
Отношение на множестве А называют
  • рефлексивным, если для любоrо элемента а Е А выполняется ana;
  • антирефлексивным, если для любого элемента а Е А не выПолняется ana;
  • симметричным, если для любых а, Ь Е А из а'R-Ь следует Ьnа;
  • антисимметричным, если из а'R-Ь и Ьnа следует, что а = Ь;
  • транзитивным, если условия аnь и ьпс влекуr anc.


                                     Та6пицJ 1

      множество        IR   R.   1R ' �             N        L    L      р       р

      отношение             �    <             =   (mod m)   11   .1..   сын   земляк
                                 -                           +    -      -
   рефлексявность      +    +          +            +                            +
                                                                                     /
                       -    -    +     -            -                            -
 антирефлексивностъ                                               +      +       1
   симметричность      +    -    -     -            +        +    +      -     /+
                                                    -        -    -              -
                                                    .
 антисимметричностъ    +    +    +     +                                 +

   транзитивность                +     +            +        +           -       +


Свойства отношений будем иллюстрировать на следующих примерах. На мно­
жестве действительных чисел R. рассмотрим отношения =, � . < . На множестве
натуральных чисел N - отношения делимости ; и отношение = (mod m) (от­
ношение сра!;lнимости по модулю m). На множестве прямых плоскости L -
отношения параллельности 1 1 и перпендикулярности .L .. На множестве людей
Р - отношения 4:СЫН» и «земляк». В табл. указано, какими свойствами'·облада­
                                               1
ют эти отношения.


§ 2 . Отношение экв и валентности
Отношение, обладающее свойствами рефлексивности, симметричности и транзи­
тивности, называют отношением эквивалентности. Из отношений, рассматривав­
шихся в предыдущем параrрафе, таким свойством обладают отношения равенства
чисел, сравнимости по модулю т натуральных чисел, параллелъности прямых,
а также отношенИе «земляк>�> на множестве людей.
     Напомним понятие разбиения множества.
§ 3,        0тноwеии11 ПОр!!ДU   ------                                                      2?

    Семейство непустых подмножеств неnустого множества А называют разбие­
нием множества А, если выполняются следующие свойства:
 1 ) объединени� этих подмножеств совпадает с А ;
 2 ) подмножества поnарно н е nересекаются.
     Пусть 'R С А2 - отношение эквивалентности. Множество ii = {х                   Е А 1 x'Ra}
называют классом эквивалентности.


Теорема 1 . Различные классы жвивалентности образуют разбиение множества А .


..с Во-nервых, каждый элемент а                 Е
                                 А поnадает в некоторый класс эквивалент­

                                ii. Осталось проверить, что различные (т. е.
ности (выnолнено nервое свойство разбиения). Действительно, в силу рефлек­
сивности имеем a'Ra, откуда а                  Е
весовnадающие как множества) классы эквивалентности не nересекаются.
             Итак, пусть ii =/= Ь. Докажем, что ii n jj = е .
             Предnоложим (для приведение к nротиворечию), что наЙдется такой элемент
у    А , который одновременно nринадлежит ii и Б. Поскольку у
        Е                                                                   Е ii,
                                                                     имеем y'Ra
и, в силу свойства симметричности отношения 'R, a'Ry. Из того, что у Б, следует     Е
у'RЬ. Соотношения a'Ry и у'RЬ влекут (в силу транзитивности 'R) а'RЬ, откуда
вытекает (вследствие симметричности 'R), что Ь'Rа. Теперь уже легко убедиться
в том, что ii = Ь. Действительно, если х - произвольвый элемент ii, то' x'Ra
и (так как а'RЬ) х'RЬ, т. е. х Б. Доказано, что ii - подмножество Ь. Аналогично
                                          Е
устанавливается, что Ь С ii. Таким образом, ii = Ь. Получили nротиворечие.
     Теорема доказана. ""
             Теорему l можно обратить. Сnраведлива


Теорема 2. Всякое разбиение множества порождает на нем отношение эквивалент­
ности.

<1111   Это отношение задается так:

                   а'RЬ   {;}    (а и Ь принадлежат одному nОдмножеству разбиения).
Очевидно, что nри этом для 'R выnолняются свойства рефлексивности, симмет-
                    '



ричности и , транзитивности, т. е. это отношение действительно является отноше­
нием эквивалентности. ""



§ 3 . Отн ош ения порядка
Отношение называют отношением nестрогого порядЮ(l, если оно рефлексивно,

    Отношениями вестрогого nорядка являются отношенИя � . = на множе­
транзитявно и антисимметрично.

стве R., отношение делИмости ; на множестве N. Приведем еще один пример.
28   -------                                                             Глuа LXVI.I . Начальные ПOНIITIIII общей, алrебры

Пусть       А   -       некоторое множество;                   ,В(А) = {Х 1 Х С А}           -     множество всех его
nодмножеств ).
           2                Отношение         С   -       отношение нестрогого nорядка на                   ,В(А).
       Отношение называют отношением                               строгого порядка,         если оно антирефлек-
сивно, rранзитивно и антисиммеrрично.
       Примером такого отношения является отношение                                      <   на   IR.
       Отношения crpoгoro или нестрогогоnорядка называют отношениями порядка.
       Говорят, что элементы                 а    и   Ь       сравнимы по отношению               'R,   если имеет место
по крайней мере одно из соотношений:                               а'RЬ или Ь'Rа.
       Прммер. Рассмотрим отношение                       ;
                                       на множестве натуральных чисел.                                    100   и   25 , 2 и 6
       сравнимы no этому отношениЮ, а числа 16 и   не сравнимы.         31
       Множество с ВI}еденным на нем отношением порядка называется                                                   линейно
упорядоченным, если любые                    два ero элемента сравнимы по данномУ отношению,
и частично упорядоченным в                    противном случае.
       Например, множество                  JR Jiинейно уnорядочено по отношению � , а множество
N    частично упорядочено no отношению                             :.

§ 4 . Ал гебраич еские структуры. Группа ."'
Отображение              а : An -+ А        называют n-арной алгебраической                       операцией     на множе­
стве   А.     При n       =   1 используют термин унарная операция , а nри n = 2                                -   бинарная
операция.
       Примерами унарной и бинарной операций на множестве действительных
чисел могут служить соответственно операция смены знака и операция сложения.
       Множество              А    вместе с заданными на нем алгебраическими оnерациями
а1, а2, . . . , an        алгебраической структурой (А ; а 1 , а2 , . • . , an } ·
                         называют
       Пусть        G   -                                                * з) , обладающая
                            множество, на котором задана бинарная оnерация
следующими свойствами (аксиомы группы):

(G 1) V а, Ь G а * Ь Е G (т. е. операция * всюду оnределена) 4);
                    Е
(G2) V а, Ь, с Е G (а * Ь) * с = а * (Ь * с) (ассоциативность) 5>;
                Е             Е
(GЗ) З е G V а G а * е = е * а = а (существование нейтрального элемента);
                Е              Е
(G4) V а G 3 а' G а' * а = а * а' = е (существование обратного элеменff!:а).
                                                                                     '
     Тогда алгебраическая структура (G, *) называется группой.
     Если, кроме того, выполняется условие коммутативности
                    Е
(G5) V а , Ь G а * Ь = Ь * а,
то групnу называют коммутативной ми абелевой.
                                                      (
       Особенности терминологии и обозначений no отношению к групnам, в ко­    )
торы)(       (групповую)           оnерацию называют сложением и.ли умножением, отражены
в табл . 2.

     2) .8(А) называют булеанам множества А .
     з) Результат       действия операции н а пару элементов                 (а, Ь)   удобно записызать
                                   а * Ь.
                                            G замкнута относительно данной операции, т. е.
       11   инфиксной форме:
     4) Гозоря:т. также:
                                            G не выводНт за пределы G.
                              множество


                                              а • Ь *с или 41 * а2 * . . . • an понимаются
       операuиR • над элементами
     s) В силу этоrо свойства выр!IЖения вида
       однознsчнD, т. е. от рщ:станDвки скобок результат не завИсит.
§ 4. Аnгебраические структуры. rpynna                 ------                                                                        29
                                                             Табnица 2

                  операция                                        сложение                                  умножение        1




             название группы                                      аддитивная                           мультипликативная
    нейтральный элемент (е)                                   нулевой (0, О)                           единичный ( 1, I, Е)
   обратный к а элемент (а')                             противоположный ( -а)                             обратный (а_ ,)


Примеры групп
  1 . (Z, +) - аддитивная групnа целых чисел.
  2. (lR.\{0}, )   мультипликативная групnа действительных чисел без нуля. За­
                       ·       -



      метим, что алгебраическая структура (Z\{0}, ) групnой не является (не вы­    ·



      полняется свойство (G4).

  3. Пусть Zm {0, I, . , т - 1 } - множество классов вычетов по модулю т.
                               =           .. .



       Тогда (Zm ,                 +)   - аддитивная групnа.
       Остановимся на этой групnе поnодробнее. Во-первых, нужно оnределить
       групnовую оnерацию. Положим:                               ii + Б = а +Ь. Для nроверки корректности
       этого оnределения нужно убедиться в том, что класс вычетов, qбъявляемый
       суммой классов вычетов ii и                           Б,   не зависит .от того, какие nредставители
       слагаемых классов берутся . Пусть а1                            Е ii    и       Ь1    Е   Б.    То�да а 1 =    a(mod т)
       и     Ь1   =    b(mod т).                  По свойству сравнений а1 +                     Ь1   = а +      b(mod т), т. е.
       aj'   +� =                  а t Ь, что и требовалось. Ассоциативность сложения очевидна.
       Нулевым эЛементом в данной групnе будет класс                                                  О.   Противоnоложным
       элементом к                   ii будет класс вычетов - а .
       (Zт ;      +)       - nример конечной группы; эта групnа абелева и содержит                                                  т
       элементов.

  4.   (Zp \{0},           ·   ) (р - простое число) - мультипликативная групnа классов вычетов
       по модулю                   р.
       Так же, как и выше, провернется корректность определения nроизведения
       классов вычетов: ii                        · Б = �-   В роли единичного элемента, как легко ви­
       деть, выступает                    I. Для того чтобы найти класс вычетов                             х, обратный к            ii
       (где       а не кратно               р),     т. е. такой, что !i   ·   ii = 161,               нужно решить сравне­
       ние ах =                1(mod p) ,         которое сводится к диофантову уравнению ах - ру =                                  1.
       В данном уравнении коэффициенты nри неизвестных а и                                                 р взаимно просты,
       так как         р           - nростое число и а не кратно               р;           по теореме        7 это уравнение
       разрешимо в целых числах.

       Отображение                   ip : G -t G называется гомоморфизмом групn ( G, *)                              и   ( G, *) , если
это отображение                     сохраняет групповую операцию, т. е .
                               (



    б) В силу очевидного свойства коммутатявности умножения свойство ii · х                                  =   I
       в этом случае также будет выполняться.
30 ------- Гпава LXVII. Начапьные ПОН11ТИ11 общей аnrебры

Пр�меры гомоморфизмов
  1



 1.   1Р :   Z9 --+ Zз , где
                  �Р(О) = о,         �P(I) = �Р(4) = �Р(7) = I,     �Р (2) = cp(s) = ср(8) = 2.
 2.   Функция        ln   осуществляет гомоморфное отображение мультипликативной
      группы положительных чисел                 (JR.+ , )
                                                        ·    на аддитивную группу действительных
      чисел     (JR., +) . Действительно, 'r/ х, у > О ln (х · у) = ln х + ln у.
Взаим�о однозначный гомоморфизм называют                            изоморфизмо'.М .       Очевидно, что
из только что приведеиных примеров лишь второй является также примером
изоморфизма групп.
      В заключение данного параграфа установим некоторые


Простейшие свойства групп
  1. Группа имеет ровно один нейтральный элемент.
      Действительно, nусть имеется два нейтральных элемента                       е1   и   е2 • Тогда в силу
      аксиомы       (GЗ) имеем е 1 = е1 * е2 = е2 , т. е.         любые два нейтральных элемента
      совпадают.
 2. Обратный элемент к элементу группы определяется единственным образом.
    В са�ом деле, предположим, что а� и а� - элементы, обратные к а. Тогда
    по аксиомам (G4) и (GЗ) одновременно имеем




      откуда в силу ассоциативностиа� = а; .
 3.   Элемент, обратный к произведению элементов �руппы, есть произведение об­
      ратных к ним элементов, взятых в другом порядке: (а * Ь)' = 11 * а' .
      Проверяется это свойство непосредственно:

                      (Ь' * а') * (а * Ь) = Ь' * (а' * а) * Ь = Ь' * е * Ь = Ь' * Ь = е.


§ 5 . Кольцо и п оле
Пусть на множестве К определены две бинарные операции + и . 7>, называемые
сложением и умножением, так, что выполняются свойства (аксиомЫ кольца):
(Кl) (К, +) - коммутативная группа;
(К2) умножение ассоциативно: 'r/ а, Ь, с Е К (аЬ)с = а(Ьс) ;
(КЗ) умножение дистрибутивно относительно сложения:
                       'r/ а, Ь, с   ЕК     (а + Ь)с = ас + Ьс;      с(а+ Ь) = са + сЬ.
Тогда алгебраическая структура                (К, +, ·)      называется   кольцом.     Если, кроме того,
умножение коммутативно:
(К4) 'r/ а, Ь Е К аЬ = Ьа,

  ?) Знак умножения при записи выражений над элементами группы,              как правило,
      опускается.
§"5. Коnьцо и поnе _:_-�--....;..;.--- 31

то кольцо называют           коммутативным.         Если в кольце существует , нейтральный
элемент по умножению:

(К5) 3 е     ЕG    'V а   Е G ае = еа = а,
то говорят о      кольце с единицей.
     Пример 1 . Z[x] - множество многочленов с целыми коэффициентами вместе с есте­
     ственным образом введенными операциями сложения и умножения образует кольцо
    '(коммутативное коль,цо с единицей). Также образуют кольца многочлены с рациональНЫ"
     ми и вещественными коэффициентами Q[x] и JR[x] .
          (Zт , +, · ) - кольцо классов вычетов по модулю m.

                              (F, +, ) называется
       Алгебраическая структура           -     · полем, если выполняются свой-
ства (аксиомы поля):
(Fl) (F, +) - (аддитивная) коммутативная группа;
(F2) (F\{0}, · ) - (мультипликативная) коммутативная группа;
(FЗ) умножение дистрибутивно относительно сложения:
                                  'V а, Ь, с   ЕF    (а + Ь)с = ас + Ьс.
Очевидно, что всякое поле является кольцом. Обратное утверждение, вообще гово­
ря, неверно. Например,         Q[xJ - кольцо, но не поле (не выполняется свойство (F2)).
       Пример 2. Множества рациональных (Q) , действительных (JR) и комплексных (!С) чисел
       образуют поля. Более экзотическим nримерам поля является множество

                                       М = {а + Ьv'2 i а, Ь Е Q} .
       �  Поскольку это - числовое множество, содержащее О и 1 , для того, чтобы убедиться
       в наличии структуры поля, достаточно проверить замкнутость М относительно операций
       сложения (что очевидно) и умножения. Действительно,
                                                        ..J'i
                                       1           а-ь
                                                           = с + dv'2,
                                    a + bvг-:;..: а2 - 2Ь2
                                                 =

                                                                 ь
       где
                                       а
                                  с= 2 - 2Ь2 ,       d = - а2 - 2Ь2 Е Q.
                                    а
       Заметим, что
                                                а2 - 2Ь2 f- О,
       так как в противном случае ..J'i был бы рациональным числом, что неверно.    .,._

              Существуют и конечные nоля, При меры, рассмотренные в § 4, показывают, что если
       р   - nростоё число, то множество классов вычетов по простому модулю р с введенными
       на нем операциями слож.ения и умножения ((Zp, +, ·) ) - поле.
            Известно, что число элементов любого конечного поля ( порядок поля) равно pk для
       некоторого простого числа р и некоторого натураJ!ьного числа k . . Кроме того, для любого
       числа вида pk поле такого порядка существует и определяется однозначно (с точностью
       до изоморфизма). Обозначение: GF(pk ) (Galois field - поле Галуа). В частности, GF(p)
       есть поле классов вычетов по модулю р .
32   -------                                          Гл111111 LXVII. Начаnыiые f10НIПМII общеА алtебры

§ 6. Груnnы с ам осовмещений
     мн огоугольник ов и мн огогранников
Сведения, излагаемые в этом параграфе, будут использованы при решении задач
с помощью теории Пойа.
     Пусть F геометрическая фигура. Под самосовмещением фигуры F понима­
                 -


ют такое перемещени� (движение) F (в пространстве или на плоскости), которое
переводит F в F. Тривиальным примерам самосовмещения является тождествеи­
ное преобразование е , при котором каждая точка переходит сама в себя.
     Рассмотрим множество G всех самосовмещений фигуры F. Произведение 9 1 ·92
двух самосовмещений g 1 и 92 оnределим как композицию движений Dt (92) это
движение, возникающее в результате последовател�;tного выnолнения 92 , а затем g1 •
Легко проверить, что (G, ·) - rруппа. Чем «более симметричной>> будет фигура F,
тем «более богатой)) будет ее группа самосовмешений. Например, для круга и шара
соответствующие группы бесконечны.
                        '


rруппа вращений правильноrо n-уrольника. Под вращением правильного n-уголь-
ника будем понимать поворот в ero плоскости, приводЯщий к его. самосовмеще­
нию. Очевидно, что если nоворот нетривиален (т. е. не является тождественным
преобразованием), то его центром является центр nравильного n-угольника. По­
скольку nри вращении всякая вершина должна перейти в. в.ершину, угол поворота
(с точностью до угла, кратного 211') равен k�, k = О, l , . . , n - l. .




fРуппа симметрий правильиого n-уrольника. Под симметрией правильного n-уrоль­
ника будем nонимать его самосовмещение в пространстве. К перечисленным выше
поворотам в плоскости добавляются «Опрокидывания)) многоугольника, т. е. по­
вороты на      180°
               вокруг осей симметрии многоугольника 8) . Их ровно n штук. Если
n четно, то осями симметрии являются n/2 прямых, соединяющих пары проти­
воnоложных вершин многоугольника, и n/2 прямых, соединяющих середины его
nротивоположных сторон. При нечетнам n каждая из осей симметрии nроходит
через некоторую вершину n-угольника и середину противоnоложной стороны.
fРуппы вращений мноrоrрапииков. Под вращением многогранника будем понимать
его самосовмещение ..
     l . Куб. Сначала покажем, что групnа вращений куба содержит 24 элемента.
         Будем считать; что куб расnоложен таким образом, что о его гранях можно
         говорить: нижняя, верхняя, передняя и т. д. Самосовмещение куба nолностью
         оnределяется тем,
           1 ) какая грань из шести станет нижней и
           2) какая из смежных с ней граней будет передней.
               Согласно правилу nроизведения имеется всего 6 · 4 24 разных само-
               совмещения. Перечислим их:
                 • тождественное nреобразование;
                 • nовороть1 на ±90°, 180° вокруг nрямых, соединяющих- центры про­
                   тивоположных граней (таких вращений 3 3 9);     ·




      S) Эти иреобразования равносильны осевым симметриям.
О 6. ·fj)ymы самОСОIМ8щений мноrоуrот.ников и мноrоrранников   -------              33

               • повороты на 180° вокруг прямых, соединяющих середины противо­
                 положных ребер куба (6);
               • повороты на ±120° вокруг диагоналей куба (8) 9>.

      Легко проверить (рассмотрев, например, подстановки на множестве вершин,
      порождаемые вращениями), что все эти самосовмещения различны; так как
      всего их ровно 24, других самосовм�щений нет.
  2 . Тетраэдр. Под тетраэдром будем понимать правильный тетраэдр. Будем счи­
      тать, что тетраэдр расположен в пространстве таким образом, что о его rранях
      можно говорить: нижняя, передняя, задние левая и правая. Самосовмещение
      тетраэдра полностью определяется тем,
       1) какая rрань из четырех становится нижней и
       2) какая из оставшихся трех rраней будет передней.
          Таким образом, всего данная rpyпna содержит 4 3 = 12 элементов:
                                                                     ·




            • тождественное преобразование;

            • . повороты на ± 120°, вокруг высот тетраэдра (всего 8 таких поворотов);
            • повороты на 180° вокруг прямых, соединяющих середины скрещи­
                вающихся ребер тетраэдра (таких поворотов 3).
     Все названные самосовмещения различны, общее их число 12; поэтому они
     исчерnывают рассматриваемую группу.
  3. Правильная n-yroлJtнaя пирамиДа. Очевидно, что группа вращений правильной
     n-угольной пирамиды, отличнQй от правильного тетраэдра, изоморфна rруппе
     вращенИй правильного n-уrольника, лежащего в ее оено:вании.
  4. Двойная пирамида (диэдр). Эта геометриЧеская фигура представляет собой
     объединение двух одинаковых правильных n-угольных пирамид, чьи осно­
     вания совмещены, а вершины находятся по разные стороны от QСнования.
     Если диэдр не является октаэдром, то его rруппа вращений изоморфна rруппе
     симметрий правильного n-угольника.
     Как известно, октаэдр - многогранник, двойственный кубу (центры rраней
     октаэдра являются вершинами пекотарого куба; центры rраней куба являются
     вершинами пекоторога октаэдра). НеудИвительно поэтому, что rруппы вра­
     щений октаэдра и куба изоморфны. То же справедливо и для rрупп вращений
     двух оставшихся правильны� многогранников 10) .
  5. Икосаэдр и додекаэдр. Рассуждая так же, как и в случае куба или тетраэдра,
     легко найти число элементов rруппы самосовмещений додекаэдра, зная, что
     он имеет 20 вершин и из каждой вершины исходит 3 ребра.

   9) Рассмотрим, например, nоворот куба ABCDA1 B1C1 D1- �oкpyr диагонали АС1 .
     этой nирамиды является nравильный треугольник ВА 1 D (каждая ero сторона -
     Высота треугольной пирамиды ABDA1 лежит на диагонали АС1 ; основанием

     диагональ rрани куба), который самосовмещается nри nоворотах на уrлы,
     кратные   120° .
   JO) Всего nравильных мноrоrранников - ровно пять: тетраэдр, куб, оКтаэдр, ико­
     саэдр, додекаэдр.

2-2331
34   ------- Гnau L.XYII. Начаяьные IIOIIIII
                                          IТ I о&ц.й амебр,ы

                                                           Упражнения

     1 . Какими свойствами (рефлексивностъ, антирефлексивность, симметричность, анти­
         симметричностъ," транзитивностъ) обладают следующие бинарные отношения на мно-
      . ,жестве действительных чисел?

            1 ) :e'R:g *'*   :е2 = ri;
            2) :e'R.y *=*    :е2 + 1/ = 1 ;
            3) x'R.y *'*     :еу > 1 ;
            1) :e'R.y *=*    11 = l z l ;
          . 5) :I:'Ry *'*    z2 + х = у2 + у ;
            6) :e'R.11 *=*   :е3 + ж 113 + 11;
            7) x'R.y *=*     ж - у Е Z;
            8) z'R.y *=*     х - у Е N.


     2. Какие из отношений nредЫдуШей задачи являются отношениями эквивалентности?
        Для к'аждоrо из таких отношений выяснить, что представляют собой; классы эквива- ·
        ленткости и сколько элементов они содержат.
     3. На множестве учеников класса введем отношение «учится лучше». Будем говорить
        «Ученик А учится лучше ученика В•, если по большинству контрольных работ А имел
        оценки выше, чем В. Обладает ли данное отношение свойством транзитив,ности?
     4. На множестве А введено симметричное и Транзитивное отношение 'R. такое, что

                                                            Va       3Ь       a'R.b.

          Доказать,   что отношение              'R. рефлекси'ВЙо.

                  .             .                                .
                                                                                             .


Соmаwенме. В задачах данного раздела е обозначает нейтральный элемент групnы.
    Пусть А . = { а 1 , а2, • • • , аа } - конечное множество, на когором определена бинарная
операция * . таблица иЗ n строк и n столбцо!!, 'В кт=орой на nересечения. i- й строки и j- го
столбца стоит элемент множества                      А,   равный     а0 .* aJ , называется таблицей умножения,          или
квадратом Кэли.

     5. На множестве { 1 , 2,            3, 4, 6, 1 2}   оnределим две бинарные оnерации:

           1) а * Ь = (а , Ь)       (наибольший общий делитель) ;
           2) а * Ь = [а , Ь]   (наименьшее общее кратное).

           Составить дця этих оnераций квалраты Кэли.
                                                                                                           а,ж + Ь1
     6.    Составим А1атрицу коэффициентов дробио-линейной функции /; (z)                              =            :
                                                                                                           e;z + d;
                                                                                                           -.---




                                                           А; =      (   а;
                                                                         С;
                                                                              Ь;
                                                                              d;
                                                                                   )   .

           Какая матрица будет соответствовать сложной функции /; (/; (z))?
     7.    На множестве функций

                                     {   z
                                               .!_ ж - 1 ж + 1 1 - х l + ж -1 -
                                                                                     -
                                             ' ж ' ж + 1 ' . ж - 1 ' l + :t ' 1 - ж ' ж '
                                                                                          ж
                                                                                                   }
                                                                                       .
          выберем в качестве бинарной олерации комnозицию функций (будем считать, что
           областью опредеfiения всех функций является множество                           R \ { - 1 , О, 1}).   Составить
           квадрат Кэли для данной оnерации. Доказать, что рассматриваемая алгебраическая
           структура является групnой.
                                                                                                                  ----�--��--�- 35
Оnи� --
  8. На множестве (Q \ О) � Q введена операция
                                        (а, Ь)(с, d) = (ас, Ьс + d) .
     Доказать, что данная алгебраическая структура является груnпой.
  9. Доказать, что в квадрате Кэли конечной группы каждый элемент группы встречается
     в каждой строке (и каждом столбце) ровно один раз.
 10. Составить квадрат Кэли для следующих групп:
     1 ) вращений правильного треугольника;
     2) вращений квадрата;
     3) вращений правильного пятиугольника;
     4) симметрий ромба, не являющегося квадратом;
     5) симметрий правильного треугольника;
     6) симметрий прямоуrольника, не являющегося квадратом;
     7) симметрий квадрата.
 1 1 . Доказать, что группа из задачи 7 изоморфна группе симметрий квадрата.
 12. Какие из следующих числовых множеств образуют аддитивные группы?
                            Z, 2Z, N, 2Z + 1, Q+, Q, IR \ Q, {- 1 , 0, 1}.
 13.   Какие из следующих числовых множеств образуют мультипликативные группы?

        IR, IR \ {0}, R+ , Z, 2Z + 1, Q, Q \ {0}, { 1 , - 1 } , { 1, 2,           i} • IR \ Q, {2n l n E Z} .
 14. Доказать, что если в группе каждый элемент себе обратен ( V а а * а = е) , то группа -

 15. Найти с точностью до изоморфизма все группы, состояЩие не более чем из 4
     абелева.


 16. Пусть rp : G -t Н - сюръективное гомоморфное отображение абелевой группы G
     элементов.

     на группу Н. Доказать, что Н - абелева группа.
 17. Пусть (G, } - групnа, g Е G. Доказать, что отображение rp9 : G -t G , заданное прави­
     лом rр9(ж) = g- 1 жg, является изоморфизмом.
                 ·




 18. Пусть (G, } - конечная группа. Доказать, что
                                                                     n
                                       V g Е (J.       3n        g           е.
                 ·




                                                            ЕN
                                           n
                                                                         =
     Наменьшее n > О, при коmором g = е , называют порядком элемента g .
 19. Порядком конечной групnы называется количество ее членов. Доказать, что конечная
     групnа четного порядка обязательно содержит элемент второго порядка.
 20. Пусть групnа обладает единственным элементом второго порядка. Доказать, что этот
     элемент перестановочен с каждым элементом группы.


                                                   Ответы

1 . См. табл. 3. 2. 1 , 5 , 6, 7. 3. Нет. 5. НОД (табл. 4). НОК (табл. 5). 6.         А; А; .   7. См. табл. 6.
8. Указание. Нейтральный элемент е = (1, 0) , обратный к g = (а, Ь) :

                                          g
                                              -1
                                                   =   (�. -�).
9. Возьмем строку, соответствующую элементу а. В ней встретится элемент Ь, если для
некотороrо элемента ж выполняется равенство
                                                   а * ж = Ь.                                                      (1 )
36   -----'---                                                                      Гnau.LXVII. Начаnьнwе лoii!IТIIII общеА ureбpw
                                                                    Таблица    З


     м                      'R.                    рефл.            антирефл.                симм.                  антисимм.         транз.

     1                  z2 == 712                   +                   -                         +                    -                   +
     2                 2
                     z + у2 1                       -                   -                         +                    -                   -
     3                   zy > 1                                         -                         +                    -                   -
     4                  У = !х \                    -                   -                                              +                   +
     5            z 2 + :с fl + y                   +                   -                         +                    -                   +
     6            :сз + z = уз + у                  +                   -                         +                    +                   +
     7                :c - y E Z                    +                   -                         +                    -                   +
     8                z-yEN                         -                   +                         -                    +                   +


                                   Таблица 4                                                              Таблица 5

                    l          2      3        4     6        12                             1        2         3      4        6 . 12

              1     1          l      1        1     1         1                    1     2           2       3        4        6    12
             2      1          2      1        2     2        2                    2      2           2       6        4        6    12
             3      1          1      3        1     3         3                   3      3                   3        12       6    12
             4      1          2      1        4     2        4                    4      4           �       12       4        12   12
             6      1          2      3        2     6         6                   6      6           6       6        12       6    12
             12     1          2      3        4     6        12,                  12     12          12      12       12       12   12


                                                                    Таблица 6

                                          1          :с 1            х+1                1-х                1 +z                 1
                                                                                                           1 :1!
                        z                 -                          --                                                     -   -          -х
                                          z          z+l             х-1                l +z                                    х
                                          1          х-1             х+1                1 - :t             1 + :с            1
         z              х                 -                          --                                                     --             -:с
                                          х          z+1             :с - 1             1 + :t             1-х               ж
         1              1                            z+1             ·1-ж               1 + :t                  1                          l.
                        -                 ж          --                                 --                                   -ж           --
         z              х                            :t - 1         / 1 +х              1 - :t                  :с                         х
     :t - 1         з: - 1             1-х             1               1                                                    1+х           z+1
     --             --                                --               -                 -ж                  :1!            --            --
     :t + l         ж+1                l +z            ж               ж                                                    1-х           х- 1
     z+1            ж+ 1              l +x                                                    1              1              1-х           z-1
     ж
     --             --                --                -z              х                -   -               -              --
          1         х-1               1 - :с                                                 :с              х              I+x           :c + l

                                                                                                            -а:
     1 - :z:         1-х              х- 1               1             1                                                    х+1           l +x
     --                                                               --                  х                                 --            --
     1 + :z:         l +x             :t + l                           х                                                    з: - 1        1 - 11:

                                                         з:
     l +z            1 +х             х+1                                                  1                   1            з: 1          1 - :с
                    --                                                 -х                 -                 -  -
     г з:            1-х              з: i                                                з:                   з:           х+            1 +х

                                                                                                                              :z:
        1                1                           l + :z:          1 - :с            x+l                з: - 1                           1
      --                --                -х         --              --                 --                                                  -
       з:                х                           1-z              l +x              х- 1               z+1                              z
                                           1         1 z              1+х               х- 1               z+l                1
      -х                - з:           --            --              --                 --                                    -             z
                                           х         1 +z             1-ж               ж+l                ж-                 z
�Ы          ------- �
Аналогично, в столбце, соответствующем элементу а, встретится элемент Ь, если для
некоторою элемента у выnолняется равенство

                                                                 у * а = Ь.                                                                  (2)
Таким образом, задача сводится к доказа�ьству существования и единственности решения
                                      (l)        (2).                                  ( l}   слева на элемент а' (элемент,
                                             = а' * Ь . Значит, если решение уравнения
каждого из уравнений                         и          Умножив равенство
обратный к а), получим                 :r:                                                                 ( J) существует, то оно
единственно.           С    другой стороны, неnосредственной подстановкой в                                 (1)   убеждаемся, что
а' * Ь          решение.
                                                                          (2): у Ь * а' .
                           JR+ , Q\{0 } , {- 1 , l } ,
          Аналогично, находим решение уравнения                                    =



12.      Z , 2Z, Q.   13.   R\{0} ,                                    { 2"ln Е Z} .
14. аЬ · аЬ = е :::} аЬ = (аЬ) - 1  ь- 1 а- 1 = Ьа.


                                                                  n = 4.
15. Указание.        Исnользовать результат уnражнения               9.
           Приведем набросок решения для случая
           Один и з элементов груnnы                    нейтральный (е) ; пусть три других                   а, Ь и   с.   Рассмотрим
два возможных случая.

           1 . Каждый       элемент груnпы себе обратен (а2 = Ь2                              с2        е ) , т. е. каждый элемент
диагонали квадрата Кэли                 -     е. Ясно, как выrлJI:дЯТ строка и столбец, отвечающие е. Теперь
нам nредстоит заполнить пустые клетки в таблице


                                                             е     а     ь     с

                                                            а      е

                                                            .ь           е

                                                             с                 е

           На пересечении второй строки и третьею столбца может стоять только элемент с, так
как во второй строке уже есть элементы а и                          е , а в третьем столбце - элемент Ь                    (напомним,
что      в каждой строке и каждом столбце квадрата Кэли по одному разу встречается каждый
элемент группы). Аналогичные рассуждения nозволяют однозначно заполнить оставшиеся
клетки таблицы.
                                                                                                                  (GI), (GЗ) и (G4).
                                                                             Это можно сделать непосредственно либо
           Операция, заданная полученной таблицей, удовлетворяет аксиомам
Осталось проверить выполнение аксиомы                              (GZ).
привести пример груnпы, имеющей данный квадрат Кэли.

           2.   Не кажДый элемент группы себе обратен. Пусть, например, а2 = Ь . Имеем таблицу


                                                             е     а     ь     с

                                                             а     ь

                                                             ь

                                                             с



    Хотя в ней nустых клеток больше, чем в предыдущем случае, но и она заполняется
однозначно. Здесь у,цобно наЧать с пересечения второй строки и четвертоrо столбца.
16.      Указание.    Воспользоваться тем, что у каждою                       Элемента        груnпы Н есть прообраз в                        G
и тем, что '</ z , у        Е G rp(:tty) = rp(y:r:)                                                G.
                                                        е и g - 1 (:x:y)g = (g - 1 zg ) (g - 1 yg) .
                                                           в силу коммутатявности
    7.
1   Указание. Заметить, что g- 1 eg
18. Указание. В силу конечности                     груnпы в последовательности степеней                           е , g 1 , g2 ,   • • •   есть
од!iнаковые элементы.
38   -----�----'--                                   Гnau LXVII.   Начаn�о��ые   ПOIIIТМII   общей аnrебры

19. Если   - элемент, обратный к а , то а - элемент, ()братный к а . Стало быть, элементы
           а
            '                                                            '

порядка выше второго (для каждого такого элемента а имеем а =1= а' ) разбиваются на пары
взаимно обратных. Поэтому в rруцпе (с четным числом элементов) содержится и четное
число элементов порядка 1 и 2. Но порядок 1 имеет только нейтральный элемент. Значит,
порядок 2 имеют нечетное число элементов.
20. Пусть g =1= е , g2 = е , а Е (} .:.... riроизвольный элемент rруппы. Докажите, что aga- 1 -
                                               ·




элемент второго порядка. Из условия задачи теnерь следует: aga- 1 = g, откуда ag = ga.
Г:ПаваLXV/1/          _____________




                         КО МБИ НАТО РИ КА



    В разных областях · науки и техники приходится решать задачи, содержание
которых - комбинирование различных элементов и объектов в группы и опреде­
ление числа различных способов, которыми это можно сделать. Такие задачи назы­
вают комбинаторными, а соОтliетствующий раздел математики -                 комбинаторикой.
    Комбинаторика           часть математики, изучающая способы решения задач
пер�числения и пересчета элементов в конечных множествах. Задача                   перечисления
состоит в вьщелении элементов из некоторого заданноfо конечного множества,
обладающих определенными свойствами, а задача
                                  ·                           пересчета    - в нахождении
числа таких элементов. Например, задача: Оnисать все возможные расnоложения
8 одинаковых ладей на шахматной доске, nри которых ладьи не бьют f.JPYГ друга -
есть задача перечисления, а задача отыскания количества указанных расстановок
есть задача пересчета.
    Истоки комбинаторной проблематики кроются в азартных играх. Умение
оценивать количество способов, которыми можно nолучить данную сумму очков
nри бросании нескольких игральных костей или данную комб11нацию цифр в ру­
летке, определение шансов на получение того или иного расклада в карточных
играх и другие, аналогичные проблемы - вот первоисточники современной ком­
бинаторики.
    Даже Исаак Ньютон бът не чужд подобной проблематике. В                    1 693 году некто
Сэмюэл Пиле, президент Королевского · Общества (так именовалась британская
Академия наук), поинтересовался у Ньютона, какую из ситуаций следует nред­
почесть при игре в кости - выпадение. по крайней мере одной единицы при
бросании   6   костей или появление не менее двух единиц nри бросании                12   костей.
Ньютон ответил, что «Легкие вычисления» показывают nреимущества первой си­
туации и привел соответствующие расчеты в подтверждение своего мнения
                                                                                           1 ).
    Впервые строгое научное исследование комQинаторных nроблем было пред­
принято Блезом Паскалем и Пьером Ферма. В дальнейшем Якоб Бернулли, Готф-
рид Лейбниц, Леонард Эйлер и многие другие вЫдающиеся математики и есте-
                "


ствоиспытатели занимались комбинаторными задачами и разработали основные
методы их решения, не потерявшие своего значения и поныне.
    По-видимому, одной из первых комбинаторных задач следует считать задачу
О ТаК н8зываеМЫХ «МаГИЧеСКИХ КвадраТаХ», упОМИНаНИе О КОТороЙ Встречается еще


   J) Следует отметить, что на Пипса арrумеf!Ты Ньютона не произвели впечатления
      и он остался при своем убеждении об эквивалентности этих ситуаций.
40   --------'-- l'ilaвa LXVIII. КомЬмнаторика

в китайских наставлениях. Согласно nреданию, Фу Си (мифический nрароди­
тель китайской цивилизации) nолучил nанцирь череnахи с начертанным на нем
магическим квадратом от Великого имnератора (божества) в знак nризнания
за nрофессионально выnолненные технические работы на реке Ло.
     Напомним, что магическим квадратом называется такое расположение n2
натуральных чисел в клетках квадрата n х n, что суммы чисел по строкам,
столбцам и диагоналям совnадают. Магический квадрат, полученный Фу Си,
является квадратом третьего nорядка ( n = 3) и имеет вид

                                    4 9 2
                                    3   5 7
                                    8   1   6

Для него Scrp = Sr:roлб Sдиаr = 15. Нахождение числа всех магических квадратов
порядка n > 4 представляет собой очень трудную задачу.
     Другой классической комбинаторной задачей, стимулировавшей разработку
теории и методов комбинаторного анализа, является задача Эйлера о 36 офице­
рах, в которой требовалось построить 36 офицеров 6 различных воинских званий
и 6 различных родов войск для парада в каре размером 6 х 6 так, чтобы в каждой
шеренге и каждой колонне бьт ровно один офицер данного воинского звания
из данного рода войск. Она положила начало теории латинских квадратов и ла­
тинских прямоугольников, нашедших широкое применение в теории планироваЩtЯ
эксперимента и прикладной статистике, и надолго оnределила тематику исследо­
ваний в комбинаторике.
     Задача эта долго не поддавалась решению (Эйлер высказал гипотезу о невоз­
можности требуемого размещения) и только в 1900 году было установлено, что
Эйлер бьm прав и задача решения не имеет.
     Задача о числе разбиений натурального числа n на слагаемые бьmа поставлена
Лейбницем в 1 669 году и эффективно решена Эйлером, который разработал
и с успехом использовал для решения этой и подобных задач метод производящих
функций, задаваемых в виде бесконечных nроизведений.
     Прикладное значение комбинаторных методов бьmо осознано сравнительно
недавно - в начале ХХ века, когда бурное развитие теории вероятностей и ее. при­
ложений потребовало развитой комбинаторной техники и активизировало работу
ученых в этом направлении. В даЛьнейшем оказалось, что комбинаторные методы
незаменимы в теории rрафо,в и статистике, теории информации и крнnтоrрафии,
линейном проrраммировании и теории массового обслуживания. Они находят
широкое nрименение при nостроении блок-схем, алгоритмов и расnисаний. Даже
в таких совершенно абсТрактных областях, как теория чисел, теория групп, теория
представлений, теория неассоциативных алгебр и т. д., комбинаторные методы
оказываются удивительно эффщсrивными и результативными.
     В настоящее время этот раздел математики активно развивается учеными раз­
личных направлений. В немалой ст�пени это развитие стимулироnано запросами
приложени:tf (n nервую очередь теорией блок-схем) и широкими возможностями
использования современной электронно-вычиСЛителl!НОЙ техники.
§ 1. Правило произведении         -------�--                                                                                                        41

     В элементарной комбинаторике, связанной с размещением груnпы однород­
ных объектов по ячейкам, при наличии различных ограничений на способы подо{)l..
ного размещения, большое значение имеют принципы подсчета численностей вы­
борочных совокуnностей, называемые                                   правшюм произведения и правилом сложения.


§ 1 . Правил о произведения
Теорему, которую мы сейчас сформулируем и докажем, часто называют                                                                         основным
принципом комбинаторики.                    ·




Теорема 1 (правило произведения). Пусть производится выбор n объектов из множества
объектов произвольной природы. Если первый элемент может быть выбран а, спосо­
бами, второй - а2 способами, независимо от того как выбирался первый, третий ­
аз способами, независимо от того как выбирались первый и второй, и т. д. , то общее
количество способов, которыми подобный выбор может быть осуществлен, равно
произведению а, · а2 · . . . an.      ·




<1111 Доказательство проведем методом математической индукции.
     При   n=1       утверждение очевидно. Пусть n                                          = 2.            Закодируем отбор уnорядо­
ченной парой чисел (i, j) , где                        i - один из                  вариантов выбора первого элемента,
а j - второго. Все способы выбора пары элементов можно описать прямоуголь­
ной таблицей, приведеиной ниже.

                                      (1 , 1)  (1, 2) ( 1 , 3)
                                     (2, 1) (2, 2) (2, 3)
                                               .... .. ...
                                     • • • о • • • о         ..      .        •••   • • • • • • • • о • • • • • •




                                   (а 1 , 1 ) (а 1 , 2) (а 1 , 3)
     В таблице      а1     строк и         а2     столбцов, а, значит,                          а 1 а2  •
                                                                                                                  элементов. Утверждение
для случая   n = 2 доказано. .
     Прещ:юложим теперь, что правило произведения спрЩ!едливо при                                                                        'fl, = k � 2 .
Последовательцость и з k+ 1 шагов выбора будем кодировать уnорядоченным набо­
ром чисел    (i1 , i2,   • • •   , i k , iн1 ) , где ij           - некоторый вариант выбора j -ro элемента.
Таких наборов - столько же, сколько                                          упорядоченных пар ((i , , i2, . . . , i k ), iн, ) ,
в которых первый элемент - уnорядоченный набор из                                            k элементов. По пред­
положению число наборов                         (i 1 , i2,   • • •   , ik )    равно          а1 а2 •         •
                                                                                                                  • • •
                                                                                                                          •
                                                                                                                              ak ;   второй элемент
этой пары -      i k+l     - по условию может быть отождествлен с любым из способов,
которьlми може1: быть. отобран                          (k + 1 )         -   й объект. Поскольку этот выбор можно
осуществить     ak + 1     способами, то всего пар будет

                           (а1 · а2 · . . . · ak ) · ан , = а 1 · а2 · . . . · ak · ан , ,
что и требовалось доказать. ..,..

     Применим правило произведения к решению двух важных комбинаторных
задач.
42 -------..,..--                                                           Г11aвa LXVIII . КоМбИнаторика

1 . 1 . Число перестановак
Пусть имеется n различных элементов. Перестановкой n элементов называют их
расположение на n различных местах. Подсчитаем число таких nерестановок.
Каждую nерестановку можно получить в результате nоследовательного выnолне­
ния n действий.
    Первое действие - выбор места для nервого элемента - выполняется n
способами.                                                       .
    Второе дейсТвие - выбор места для второго элемента - выполняется n - 1
способами, поскольку одно место уже занято, и число свободных it:ecт на единицу
уменъшилось. И так далее. Наконец, размещение последнего, n-ro элемента
осуществляется однозначно.
    По правилу nроизведения число всех nерестановак n элементов равно

                             /n   ·   (n - 1) . . .
                                               ·      ·   1   =   n!   ·1
1 .2. Число подмножеств конечного множества
Пусть А - множество, содержащее n элементов. Для малых n подсчитаем число
всевозможных nодмножеств множества А. Для этого составим следующую таблицу
(табл. l).

                                           Табпмца 1

    n            'А               все nодмножества А                        чисЛо nодмножеств

    1            {а}                        0, {а}                                    2
    2           {а, Ь}                0, {а} , {Ь}, {а, Ь}                            4

    3          {а, Ь, с}      0 , {а}, {Ь}, {С}, {а, Ь},
                                  {а, с} , {Ь, с}, {а, Ь, с}                          8

    Возникает nредположение, что число всех nодмножеств n-элементного мно­
жества равно 2n . Справедливость его легко доказать с помощью правила nроиз­
ведения. Действительно, произвольмое подмножество n-элементноrо множества
можно получить в результате выполнения следующих n действий: 1-е действие
«определяет судьбу)!> 1 -го элемента множества - быть ему в формируемом под­
множестве или нет, 2-е действие касается 2-го элемента, ... , n-e действие - n-го
элемента. Таким образом каждое из n действий может быть выполнено двумя
способами. Согласно nравилу произведения, число способов выполнить все n
действий, а значит, и число всех ч;одмножеств исходного множества равно 2n .


§ 2 . Выборки. Разме щения
Пусть задано некоторое конечное множество А = { а1 , а2 ,  an } - генеральная
                                                                            • • •


совокупность. Из элементов генеральной совокупности образуются выборки:
О Э• СОчетаниt    ----.:.---                                                                        43

     Выборки кла�;сифицируются следующим образом.
     В зависимости от того, существен порядок элементов выборки или нет, ее
называют упорядоченной или неупорядоченной.
     В зависимости от того, мoryr или не мoryr элементы выборки повторяться,
ее называют выборкой с повторениями или выборкой без nQ8торений. Упоминание
об отсуrствии повторений часто опускают, в то .время как допустимость повторений
элементов в выборке всегда специально оговаривается.
     Число элементов выборки называют ее объемом. Выборку объема r называют
r-выборкой.
     Размещением из n элементо6 по т называется упорядоченная т-выборка
из n-элементной генеральной совокупности.
     Пример. Пусть n = 3, т 2. Обознач�м элементы исходного 3-элементного                    множества
     а, Ь, с. Выпишем всевозможные размещения из 3 по 2 (без nовторений):
                             (а, Ь), (а, с), (Ь, а), (Ь, с), (с, а), (с, Ь).
     Если говорить о размещениях с повторениями, то к указанному списку добавится еще
                                                  ·                     ·                ·

     3 размещения: (а, а), (Ь, Ь), (с, с).

     Число размещений из n по т без notrfopeний обозначают А� , а с повторени­
ями AW. Наnример, А� = 6, Aj = 9. Несложно nолучить общие формулы для чис­
ла размещений. Если элементы размещения не мoryr nовторяться, то число cnoco-                            ·


бов, каким можно выбрать каждый очередной элемент размещения, будет на еди­
ницу меньше, чем для предшествующего ему, а так как первый элемент размещения
выбирается n способами, то с помощью правила произведения получаем формулу
                             1 А� = n(n - l)(n - 2) . . . (n - т + l). j
Полученное произведение содержит. т множителей, его иногда обозначают так:
(n)т . В размещенИи с повторениями каждый очередной элемент может быть
выбран n способами, nоэтому




§ 3. Сочетании
Сочетанием из n по т называют неупорядоченную т-выборку из n-элементной
генеральной совокупности.
     Пример 1. Пусть n = 3, т = 2. Обозначим элементы исходного 3 -элементного множества
     а, Ь, с . Выпишем всевозможные сочетания из 3 по 2 (без повторений): аЬ;ас, Ьс. Если
     говорить о сочетаниях      с nовторениями, то к указанному списку добавится        еще 3 сочета­
     ния: аа, ЬЬ, се .

      ..,. Число соче�аний. из   n   по   т   (без повторений) обозначают   с:' или   (:) , а с nовто­
     рениями      -
               с:' . Например , Cf = 3, С� = 6 .
          Выведем формулу для С::' . Всякое размещение из               n    по   т   можно получить
     с помощью процедуры из двух дейсТвий:
        1} выбор элементо�;�, входящих в размещение (другими словами, выбор сочетания
             из   n по т);
        2)   nерестановка выбранных элементов.
44   ------                                                                                        rnaвa LXVIII. к�натормка

               По nравилу nроизведения nолучаем А:;' = C:J' · т!, откуда

                                             С::'       n(n - l)      (n - т + 1)
                                                                    ...
                                                    =                             .
                                                                     т!
       Умножив числитель и знаменатель nолученной дроби на (n                                     т)! , nолучим

                                                        с:' -        n!
                                                         n                              .,
                                                             -
                                                                 m!(n - m)! '

Число соч�ий с повторениями.                         «Закодируем� сочетание с повторениями после­
довательностью из нулей и единиц следующим образом: сначала запишем столько
единиц, сколько раз в сочетание входит первый элемент :исходного множества,
затем - 0 , -затем столько единиц, сколько раз в сочетание входит второй элемент
исходного множества , затем                  -   О   и т. д.     (после единиц,              соответствующих послед­
нему элементу,            О   не ставим) .

       Прммер 2. Пусть n = 3 , т             5. Тогда аааЬс имеет кодировку 1 1 10101; аЬЬЬЬ - 101 1 1 10,
       ссссс - 001 1 1 1 1 .

       Заметим, что в кодирующей последовательности ровно n + т - l элементов: т
единиц (столько, сколько элементов в сочетании) и n -                                        1   НfЛей (отделяющих друг
от друга n наборов единиц, соответствующих n элементам исходноГо множества) .
Очевидно, что любой последовательности такого вида соответствует некоторое
сочетание с повторениями из n по т .

       Пример З . При n        3, т          5   nоследоевтельности                1 1 1001 1 отвечает сочетание ааасс,
       а O l l l l lO - ЬЬЬЬЬ.
       Таким образом, установлено взаимно однозначное соответствие между мно­
жеством сочетаний из n по т и множеством последовательностей из т единиц
           1
последовательности указанного вида нужно определить т. позиций для единиц
и n    -
               нуля. Несложно п()дсчитать число последних: для построения любой


из n + т        -    1    возможных; поэтому число последовательностей равно                                      CJ:'+m-l .
Доказано, что


                                                    1 С;'    =   C::'+m+       1
       Рассмотрим несколько задач, при решении которых исnользуются сочетания
с повторениями.

     • Каким числом способов можно разместить n одинаковых шаров по                                                 k   раз­
       личным урнам, если в каждую урну разрешается поместить любое количество
       шариков           (допустимо,   в том числе, что урна может остаться пустой) ?
       Решение. Присвоим урнам номера от                             1    до       k.   Будем считать, что, помещая
       шар в урну, мы присваиваем ему ее номер. Тогда размещение шаров по урнам
       сводится к построению последовательности, в которой                                         n элементов и каждый
       из них принимает одно из                  k   значений. Таким образом, ответ к задаче:                       с;: .
     • Каким числом способов могут распределиться голоса                                         1 миллиона избирателей
       среди    42       избирательных блоков?

       Задача сводится к предьщущей . Оrвет:                         CJf .
§ 4, Перестаиовки С ПОIТОренИIIМИ                   --------'--                                                                                                       45

 ·   •   Найти число решений уравнения
                                   Х1 + Х2 + . . . + Xk = n
         в неотрицателъных целых числах ( n - любое целое неотрицательное; k -
         целое положительное).
         Опять задача сводится к числу распределений одинаковых шаров по различ­
         ным урнам, если считать, что Xt - количество шаров, помещаемых в i-ю
         урну, n - общее число шаров, k - общее число урн. Ответ: с; .
     •   Найти число решений уравнения
                                                                   Х1     +    Х2 +      .   ..   + Xk = n
         в натуральных числах (n, k - целые положитеЛьные, k � n).
         Введем новые переменные:
                                Xj Yi + 1 (i = l , . ' k).                                              . .




         Относительно новых переменных Yi получим уравнение уже в неотрицатель-
         ных целых числах
                                У1 + У2 + + Yk = n k ,                              · · .



         число решений которого
                                                                            n-k1 -- ck-
                                                                   Ckn-k - cn-       n-11 ·
         Читателю предлагается подумать над тем, как ответ может быть получен
         непосредственно (без сведения к предыдущей зада':lе).


§ 4 . П ерестановки с повторениями
Перестановкоми с повторениями называют упорядоченные выборки, в кОТорых
,каждый элемент генеральной совокупности встречается фиксированное (свое для
каждого элемента) число раз.
       Пусть А = {а1 , а2, • • • , ak } генеральная s;овокуnностъ. Число перестаковок
с повторениями, в которых элемент а 1 встречается n1 раз, элемент а2 - n2 раз,
... , элемент й.А: - nk раз, обознача�т P(n1 , n2, . , nk ) · Выведем формулу для
P(n 1 , n2, . , nk ) · Обозначим через n общее число элементов в каждой выборке
                                                                                                         . .




указанного вида: n = nt + n2 + . . + nk .
                 . .


                                                                    .


       Рассмотрим формирование перестаковки с повторениями как процедуру
ИЗ следуюЩИХ k шагов.
1-1 шаr. Определяем n 1 мест, которые будет занима'Iё элемеит а1 •
1-1 шаr. Определяем n2 мест, которые будет занимать элемент а2 •

k-й шаr. Определяем nk мест, которые будет занпмать элемент ak .
     1 -й шаr выполняется с:� способами,
         2-й шаг - c�:_n 1 способами,
         . . . . . .. . . . . . . . .. . . . . . . . . . . . . �   ., .   . . � .. . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
46   ------                                                                        Гпава LXVIIt. Комбинаторика

Общее число перестанопок .с повторениями находим по правилу произведения:
cn · cn2 сnз            cn"
 n n-n1 n-n1 -n2 • •      n-n.-n2-. . . -n"_l -
                              •



                     n!               (n - n1)!          (n - n1 - n2)!
            =                 ·
               n1 !(n - n1)! n2!(n - n1 - n2)( nз!(n - n1 - n2 - nз)! · ·                      ·




                          (n - n1 - . . . - nk- J)!               _
                                                                           n!
                     . .·
                          nk!(n - n1 - . . . - nk)! - n1 !n2!nз! . . . nk!(n - n1 - . . . - nk)! ·
Замечая , что (n - n1 - . . . - nk)! = О! = 1 , получаем окончательный результат:
                                                n!
           P(ni , n2, · · · · nk) =                           ,   где n = n, + n2 + . . . + nk.
                                         n1 .n2 .1 . . . nk.1
                                            1
     Пример. Сколько различных •Слов• можно nолучить, nервставляя буквы слова •колоколь­
     чик•?

     -. В слове 1 1 букв, буквы •к• и •О• встречаются по три раза, буква •Л» - дважды, осталь­
     ные - по одному разу.

                              = 1 1 · 10
                  11!
     Ответ:                           . · 9 8 · 7 5 · 2. .,.
                                              •    ·

              3!3!2! 1!1!1!

§ 5 . П ол ин омиал ьная ф ормула

Теорема 2.Для любых натуральных чисел n и k и любых чисел Х!, Х2, . . . , Xk справед­
ливо равенство




Пояснение. Суммирование производится по всем решениям уравнения n1 +n2 + . . . +nt = n
в неотрицательных целых числах. Таким образом, в силу результатов § 3 число слагаемых
                                                                               -
в данной сумме равно              С:.
"iil Запишем n-ю степень суммы как произведение n множителей, после чего
раскроем скобки, не приводя подобных и не меняя порядка множителей:
  (xi + х2 + · . . + xk)n = (xi + х2 + . . : + xk)(xl + х2 + . . . + xk) . . . (xi +х2 + . . . + xk) =
                          ::: х!Х! • XJ + XJXJ . . . Х2 + • . . + XkXk . . . Xk ·
                                        • •




Если КЮIЩое слагаемое рассматривать как n-буквенное «слово», то в полученной
сумме присутствуют все «сЛова» из n букв, в кОторых каждiт буква принимает
одно из k значений: х 1 , х2, . . : , Xk , причем КЮIЩое такое слово встречается ровно
один раз. После приведения подобных коэффициент при х�• ��2 xZ" будет равен            • • •



числу n-буквенных слов, в которых буква х1 встречается n1 раз, х2 - n2 раз,
. . . , Xk - nk раз, т. е. числу перестанопок с повторениями
                                               \
                       Р (n1 , n2, . . . , nk) :о;= 1 1
                                                          n!
                                                                        х1n1 хn2       n"
                                                                              2 . . . xk .
                                                   n1 .n2 . . . . nk 1.
Теорема доказана. .,..
§ 5. Пмююмюм�а• �nа              ______                                                                              47

     Замечание 1 . Частным случаем полиномиальной формулы является формула бинома
     Ньютона
                                                         n
                                           (z + y)n ::= Е C�zn-iyi .
                                                        i=O
                                                                                      k   =   2 , z1   =   z, z2   = у,
          = i, ТО n1
     Действительно, если в полиномиальной формуле положить
     n2                =   n-i   И




,-




     Замечание 2. Другим широко известным частным случаем рассматриваемой формулы
     является формула квадрата суммы               k    слагаемых
                                                            2=
                                 (zt + z2 + . . . + zk )         Е z� + 2 Е z;z;.
                                                                  i             i<j
     Пример 1 . Получить формулу куба суммы трех слагаемых.

      � Уравнение      n1 + n2 + n3    = 3 имеет Cj = Cg = 10 решений в неотрицательных целых
     -числах:
                                          (3 , О, 0), (2 , 1, 0), (1, 1 , 1),
     а также тройки чисел, nолучающиеся из указанных nерестановками элементов. Таким
     образом, в формуле три различных nолиномиальных коэффициента:

                                                   Р(3, О, О)    = 1,

                                                   Р(2 , 1 , О) = 3 ,
                                                                 =
                                                            /

                                                   P( l, 1, 1)        6.
     Искомая формула:




     Пример   2. В разложении много-члена (2 z + z2 ) 5 -              найти коэффициент nри           z5.
     � Применяя nолиномиальную формулу, nолучаем:




                                           =                                                                          (1)

     Дл я того чтобы оnределить, какие слагаемые в nолученной сумме содержат z5 нужно                         ,


     решить в неотрицательных целых числах систему двух линейных уравнений с тремя


                                               {
     неизвестными
                                                   n,   +   n2 + nз   =    5,
                                                         n2 + 2nз     = 5.

     n2 nринимает значения: 1 , 3 или 5. Все решения системы удобно заnисать в виде табл. 2,
          Из второго уравнения следует нечетность n2; в силу неотрицательности nеременных
48   --------�                                                                Гпава LXVIII . Ком�орика
                                            Таблица 2

        n1                      n2                    nз
                                                                                 5!(- 1 )n2 2nJ
                                                                                     n 1 !n2!nз !
         2                           1                  2                              -120
         1                           3                  1                              �40
         о                           5                  о                               -1

     к которой nриnишем столбец значений коэффиЦиентов nри х 5 в отвечающих каждому
     решению слагаемых в ( 1).
          Таким образом, коэффициент nри х5 равен -120 - 40 - 1 :::;: -1 6 1 . ..,.



§ 6 . Комбинаторн ые тождества
В этом параграфе будет доказан ряд соотношений для биномиальных коэф­
фициентов. Все они интересны сами по себе и многие будут :Использоваться
нами в дальнейшем. Однако не менее интересны способы их доказательства
(или получения). Мы будем, как правило, предлагать доказательства, исходящие
из комбинаторной природы соотношений. Общая схема рассУJIЩений здесь такова.
Пусть доказывается тождество f(n, т, . . . ) = g (n, т, . . . ). По виду левой и правой
частей реконструируется задача на подсчет числа комбинаций определенного вида
(n, т, . . . выступают в роли параметров), решая которую одним способом� полу­
чаем в качестве ответа f(n, т, . . . ) , а другим способом - g (n, т, . . . ) .
     В нижеприводимых соотношениях значения параметров предполагаются та­
кими, чтобы все биномиальные коэффициенты имели смысл (например, если
в формуле присутствует с� ' то предполагается, что о � k � n ) .
     Имеют место следующие тождества:


              n                                     n
          3) 2: с: = 2n ;                       4) 2:(- 1)"' с: = о           (n �   1);
             k=O                                     k=O    •

              n           j                                           k
          5) L:< - 1)нс: = I ;                  6) c�+n = 2: c:..c:-l (т, n � k);
             k= l    n                                          1=0
          7) 9fn = L )c:)2 ;
                      k=O
                                                              �+1 .
                                                      .1:

          9)   с:с;: = с: С::;:: ;             10) 6    т p = I.Jm+k+
                                                   ""' сm+            l•
                                                     р=О
                k                                  т
         1 1) 6          .
                           m+l
              ""' сnт+p = cn+k+l    m+l .
                                 - cn •        12) Е c:c:_-kk = С::' . 2m ;
               =
              Р О                                    k=O
                                                     t            с: = t .!..
                  1                                                       1
         13) 6 ;;Спk = k1 Cm ;
              �                .1:
                                               14)
                                                          (-1 ) -
                                                                .1:

               n=k                                   k= l   k          k=l k
§8. Комбии8ТОf!!Ые тождества ------- 49

<1111 1)   Каждому k -элементному подмножеству n-эле�ентного множества посrавим
           в соответствие его дополнение до всего мноЖества. Нетрудно видеть, что
           при этом задается взаимно однозначное соответствие между k -элементными
           и   (n   - k ) -элементными подмножествами n-элементного множества. Если


           ответствие, то эти множества содержат одИнаковое количество элементов.
           между двумя конечными множествами существует взаимtю однозначное со­


           Таким образом, число сочетаний из n по k совпадает с числом сочетаниit.
           из n по n - k .
  2)       Пусть в парламеше n депутатов, включая спикера. Подсчитаем число спосо­
           бов составить ·парламентскую делегацию из k человек. С одной стороны, это
           число сочетаний      с� .
           Произведем подсчет по-другому.             Для         того чтобы сформировать делегацию,
           включающую спикера, нужно из n                     -    1 рядовых депутатов выбрать k 1 ;
           это можно сделать      с:: 1    способами. Если же спикер в делегацию не входит,
           то ее Членов можно выбрать           с�-1      сnособами         (из   n -     1   рядовых депутатов
           выбирается, k человек) . Таким образом, всего имеется                         с::/ + С�_1         способов
           составить делегацию.
  3) 2n        -    число всех подмножеств n-элементного множества. Так как                             С�   -     число
           всех его k -элементных подмножеств, то просуммировав                               с:     по k от   О   до n ,
           вновь получим общее число всех подмножеств.
       Другой способ доказательства состоит в применении формулы бинома Ньютона
                                                n
                                    <t + x>n =    c:�k ·          2:
                                                                  k=O
           Положив в ней х=         l,   получим требуемое.
  4)       Тождество доказывается подстановкой в приведеиной выше формуле х =                                        -1.
           Приведем также комбинаторное доказательство.
                                                                                     ·




           число элементов. Оно совпадает с количеством способов составить парла­
           Найдем количество подмножеств n-элементного множества, имеющих четное


           ментскую делегацию из четного числа человек, если в парламеяте всего n
           депутатов.
           Произвольмая делегация такого вида может быть получена в результате выпол­
           нения следующей процедуры. Сначала относительно каждого из депутатов,                                            ·


           не считая спикфа, будем nринимать решение, войдет данный депутат в де­
           легацию или нет. Согласно правилу произведения, эти решения могут быть
           вынесены      2n-I   способами. Спикер включается в делегацию только в том
           случае, когда в ней нечетное число «рядовых» депутатов. Таким образом,
           общее число делегаций с четным числом . членов равно                          2n - t .
           Поскольку общее число nодмножеств есть                         2n ,   подмножеств с нечетным
           числом элементов также          2n -l , то есть столько же, сколько и с четным Числом
           элементов. Значи�
                                                                              .....А
                                 Cnl + сnз +. cns +   · · ·
                                                              =   сnо + сn2 + t.ln   +   · · ·   ,




           n-элементного множества соответственно с нечетным и четным числом эле­
           поскольку части записанного равенства выражают собой число подмножеств


           ментов. Полученное равенство равносильно доказываемому.
50 --------.,--� fllaвa LXVIII. Ком6инаторика

5) Данное соотношение является другой формой записи предыдущего тождества.
6) Решим: такую задачу: Имеется т мужчин и n женщин. Из них нужно сформиро­
   вать делегацию из k человек. Каким числом способов это можно сделать? Ответ
   очевиден: C�+n . Будем классифицировать делегации по числу мужчин. Если
   в делегацию входят s мужчин и k s женщин, то мужчин можно выбрать
   С:Л способами, а женшин c:-s способами; значит, число делегаций с s
                                                        '--




   мужчинами равно c:nc:- s . Суммируя c:nc:-s по s от о ДО k , получим общее
                                        -




   число делегаций.
7) Для доказательства достаточно в предыдущем соотношении положить k =
     т= n и применять 1).
8) Доказательство тождества может быть получено из решенJШ следуюшей за­
   дачи:. Каким числом способов можно из n кандидатов выбрать k депутатов
   и среди последних спикера ? Депуrаты выбираются с: способами, после чего
   спикер выбирается k способами; таким образом, общее число способов равно
   Сй ·k. То же число можно подсчитать по-другому. Будем сначала (всенародным
   голосованием) избирать спикера (из n кандИдатов) , а затем из оставшихся
   n - 1 кандидата      еще k - 1 депутата: Указанная процедура может быть
   выполнена n С�: 1 способами. Доказано, что kC: = nC�: 1 . Отсюда вытекает
                           ·



   полезное рекуррентное соотношение Сй          Ic::l , применяя которое не­
                 (
   сколько точнее: k) раз, можно вновь вывести формулу для числа сочетаний:
                                 n n- 1           k 2
                 Cn = k Cn - 1 = k . k ..:.. 1 . Cn --2 = . =
                  k   n k -1
                                                                 .   .




                      _ !: � .           n-         k + 1 ,.о        _   n(n - 1) . . . (n    k   + 1)
                      - k . k- 1 ··· .          .   1         Vn- k -                k!
9) Это тождество - обобщение предЫдущего (если в 9) положить т = 1 , то
    получим          8))
                 и может быть доказано с помощью решения задачи, также яв­
    ляющейся обобщением ранее рассмотренной: · Каким числом способов можно
    выбрать из n кандидатов k депутатов и среди последних членов президиума ?        т
10) 1-й способ. Докажем тождество математической иидукцией по k. База индук­
    ции. При k = О имеем верное равенство:
                                                     +1
                                            Cтm = cmm+l = 1              ·




     Индукционный шаг. Пусть доказываемое утверждение верно при k = n:
                                            n
                                         I: с;::+р = С:::t�н·
                                         р=О
     Прибавив к обеим частям равенства C:J:+n+ 1 , получим
                       n+l
                       I: с:::+Р = c:::t�+ 1 + C:::+n+1 = [в СИЛу 2)] = C:::t�+2 ·
                       р=О
     Таким образом, соотношение 10) справедливо и при k n 1 .                             +
     2-й способ. Общее число         (т+
                                   ! ) -элементных подмножеств множества { 1 , 2, 3,
     ..  .   , т + + 1}
              k    равно C:::t�+ 1 (правой части доказываемого тождества) . Будем
§ 8• Комбннаrорнwе ТOJUI8CТU               ------                                                                                  51
                                                                                 '


     классифицировать указанные nодмножества no их наибольшему элементу, ко-
     торый, очевидно, nринимает значения т + 1, т + 2, . . . , т + k + 1 . Найдем
     число nодмножеств с наибольшим элементом т + р + 1 . Поскольку наиболь­
     ший элемент уже выбран, оставшиеся элемеНтов выбираются из множества    т
     { 1 , 2, . .      значит, число таких nодмножеств равно С:::+Р. Суммируя
                      , т + р}
     С:::+р по от до k, вн01�ь nолучим общее число
              .                        -



                        р О                                   ! ) -элементных                            (т +
     nодмножеств (левую часть доказываемого тождества) .
1 1) Тождество доказывается на основе предыдущего:
                            k       n+k        n-1
                          I: c�+P = I: cr - I: cr = [p = i - тJ =
                          р =О      i=m        i=m
                                    n+k-m          n-1-m
                                          С:::+Р -   2:  с:::+Р = с::'+"\�. - с;:+ • .
                                                                         2:
                                     р= О           р =О
12). Решим задачу: Каким числом способов можно из n кандидатов выбрать т депу­
     татов и среди депутатов некоторых (может быть, всех, а может быть, никого)
     наградить?
                                                                                         ·




     С одной стороны, деnутаты выбираются с: сnособами, а награжденные
     выделяются 2m способами (столько nодмножеств имеет множество из                                                               т
     элементов) , и, значит, ответ к задаче: С: · 2m .
     С другой стороны, если число награждаемых деnуТатов равно k    k                                                      (О � � т),
     то их можно выбрать С� способами, nосле чего остальные т - k деnутатов
     выбираются c:.:kl: сnособами. Суммируя c:c::kk по k от о ДО      вновь                                                   т,
     получим ответ к рассматриваемой задаче. Тождество доказано.
1 3) Используя соотношение 8), nреобразуем общий член суммы:

                                                               .!. cnk - .!.cnk-- 11 ·
                                                                             k
                                                                         _



                                                               n

     Имеем:
                                                т                        т
                                               "" 1 k- 1       l "" k-1                                   k
                                                                                     = f в силу 10)] = k Cm.
                                               L....J k Cn-1 = k L....J С,н
                                                                                                             .
                                                                                                                       1
                                               n =k                      n=k
14) 1 -й способ.




                              1
           =-1                    (' .!. �
                                   ж L...
                                                      k
                                               с:(- ж) ) dж = -              /1 ..!.ж ((1 - ж)n - l ) dж = [tdt= l -dж
                                                                                                                   - ж ;]
                          о          k=l ..i                                 о                           .
                                                                                                                               =




             1 tn - 1 dt = 1 tn
                      о                              1
                                                                          1 (l + t + t + .
                                                                                         2
                                                                                                         +t
                                                                                                                 n- 1 ) dt =
                                                         Т::Т dt =
                                                           1
                                                                         1
                                                           -

           =              т=t"
                                                                                                 ·




                                                 о                       о
                                                                                             .       .




                  1
                                                                     ·
·   52 ------ Гпава LXV\11. Комбмнатормка




                                                                                                        n
         2·й тособ. Воспользовавшись                  13)   тождеством, заменим            t с:   на   � } CJ
                                                                                                       ]=k
         и   в l11iJIУЧенной двойной сумме поменяем порядок суммирования:

                t(-I)k -t �c: = Ё<-t)k- 1 t �cJ =
                k=l             k==l       j=k J
                                 n j                                n
                              = L: � L:<- t)k -1cJ = [в силу 5)} = 2: � .                              ...,
                                j""l J k=l                         j=l J

    § 7 . Формула в кп ючения - искп ючен ия
    Мощностю конечного множества называется число его элементов. Мощность
    множества А будем обозначать IAI . В этом параграфе мы выведем формулу для
    мощностиобъединения конечного числа конечных множеств. В случае двух и трех
    множестn имеем соответственно:
                               IA u BI IAI + IBI - ! A n BI ;
                                                =


         IA u .вu Cl = IAI + IB I + ICI - /А n В/ - /А n Cl - ! В n Cl + IA n В n Cj .
    Действи�ьно, в сумме IAI + I BI каждый элемент, принадлежащий одновременно
    и А, и В,учитывается дважды; поэтому после вычитания из I AI + !B I мощности
    пересечен1111 этих множеств получим в точности число элементов А U В . Анало­
    гичными рассуждениями обосновывается вторая формула (рис. l).




               Рис.   1.    Геометрическая иллюстрация формул вЮIЮчения-исключения

         В обшем случае имеет место следующая

    Теорема 3 (;рмуnа вкniОЧения-искniО'IеНИ!I) .          Пусть   А 1 , А2 , . . . , An   конечные множе-
    ства. '/Ьгда
                                                       n
                           IAt U A2 u . . . U Aпl   = L IAi l - L /Ai n AJ I +
                                                      i=l           l�i<j�n
               +      L /Ai n Aj П А�; / - . . . + ( - l)n-I IAt n А2 n . . . n Anl ·                         (1)
                   l�i<j<k.;;;n
1 8. ФунЩм Эйпера   -----,----                                                                           53

• Возьмем произволъный элемент из объединения данных n множеств и nод­
считаем его «ВКЛад» в nравую часть доказываемой формулы. Пусть элемент входит
ровно в т мнqжеств Ai (т � n) . Тогда в сумме :Е /Ai/ он учитывается т раз,
в сумме :Е /Ai П Aj / - С� раз (в стольких поnарных пересечениях т множеств
он содержится), в сумме :Е /Ai n Aj п Ak / - С� раз и т. д. Общий вклад элемента
выражается формулой т с� + с;;. - . . . + (- l)m- •cm и равен '1 в силу тожде­
ства 5) предыдущего параграфа. Таким образом, nравая часть (1) равна общему
числу элементов из объединения n множеств, что и требовалось доказать. .,.
    Замечамме. При решении мноrих задач применяется следуюЩИЙ вариант формулы
    включения-исклю�ення. Пусть дЛя любою i множество А1 является подмножеством
    некотороrо множества А. Обозначим через 11 дополнение к А; до множества А :
    1; = А \ А1 • Как известно, доnолнение к объединению множеств есть пересечение их
    дополнений 2>; поэтому                                                          1

                    IAt n . . . n   A,.l = IA \ (At u . . . u A,.)l = IAI - IAt u . . u А,. \.
                                                                                   .


     Воспользовавшись формулой ( 1), окончательно получим
                                      n
      IA1 n . . . n A..I   =   IAI - 2: \ А; !,+ 2: IA; n A11 - . . . + (- l)"IA• n A2 n . . . n A,.\.
                                     1=1        t..;i<j..;n


§ 8 . Функция Эйлера
Применяя формулу включения-исключения, выведем формулу для функции Эй­
лера rр(т). Напомним, что rр(т) количество натуральных чисел, не превосхо­
дящих т и взаимна nростых с т. Пусть натуральное число т имеет следующее
каноническое разложение на простые множители: т                    р�1 р�1 p�n . Введем
в рассмотрение следующие множества: А = { 1 , 2, . . . , т }, Ai = {j / j Е А, j ; Pi },
                                                                                           • • •




Ai А \ Ai ( i = 1, . . . , n) . Число взаимно просто с т тогда и только тогда, когда
оно не делится ни на один простой делитель т. Поэтому множество чисел, не пре­
восходящих т и взаимно простых с т, совпадает с множеством А1 n .A2 n . . . ПАn .
Таким образом, rр(т) есть мощность указанного множества.
     Отметим , что Ai = {pi , 2pi , . . . , т} и /Ai l = � · Несложно найти и мощность
nересечения двух множеств: /Ai n AJ 1 = Р;; (множество Ai n Aj состоит из чисел,
кратных произведению PiPj ) , и вообще мощность пересечения любого числа
из множеств Ai :



(рассуждения аналогичны). Теперь все готово для того, чтобы применить формулу
включения исключения. Имеем:
                                            n
      =                         =
rр(т) /А1 n . . . n An l /AI - L: /Ail + L: IAi n Aj l -                         ...   +
                                           i=l          l�i<j�n
   2) Закон де Моргана.
54 ------ Глава LXVIII. Комб11наторика

         +   ( - 1У
      = т - L Pтi + 2: P-тiPJ- - . . . + ( -1)s L Pi, т Pi, + . . . + (- 1)n_т_ =
                                                                                Pt           Pn
             ( Pt_.!._) (i - _.!._) . (1 - P_!__n ) .
                                                                 · · ·               · · ·




      =т 1-                 - Р2
                                     ..

(При раскрытии скобок в последнем произведении получается предыдущая сум­
ма.) Итак, доказано, что

                                   <р(т) = т   f:ri=t ( 1 - Pl� ) .
§ 9 . З адача о беспоряДках и встречах
В популярной литературе по теории вероятностей часто встречается
Задача о рассеянной секретарше. Секретарше нужно отправuт·ь n различных писем
по n различным адресам. Она подписывает конверты u случайным образом вl(,Jlады­
вает письма в конверты. Какова вероятность того, Чff!O ни одно письмо не дойдет
до своего адресата ?
       Оказывается, искомая вероятность не так мала, как может показаться на пер­
вый взгляд, и, что замечательно, имеет пределом (при n -t оо) � = 0,367879 . . . .
Данная задача является (литературным) вариантом широко известной комбина­
торной задачи о беспорядках, решением которой мы сейчас и займемся.
       Перестановка (a t, а1, . . . an ) чщ:ел 1, 2, . . . , n называется беспорядком, если
для любого i ai =1- i. Через Dn обозначим число всех беспорядков из n элементов.
Заметим, что в задаче о_ секретарше искомая вероятность Pn равна отношению Dn
к общему числу всех перестановок n элементов: Pn = * .
       Пусть А= {(а1 , а2, . . . , an)} - множество всех перестановок чисел 1, 2, . . . , n;
Ai = { (а1 , а2, . . . , an ) 1 ai = i } - множество тех перестановок, у которых на i-м
месте стоит число i , Ai = А \ Ai (i = 1, . . . , n) . Тогда множество беспорядков
совпадает с пересечением множеств А1 n А2 n . . . n An , а Dn равно его мощности.
Для того чтобы применить формулу включения-исключения, нужно найти мощ­
ности соответствующих множеств.
       Имеем: IAI = n!, V i IAil = (n - 1)! (так как во всех перестановках, входящих
в Ai , положение одного числа фиксировано, то число таких перестановак совпада­
ет с числом перестановок n - 1 элементов), если i =1- j , то IAi П Aj l = (n - 2)! (здесь
фиксированы положения двух элементов); вообще: мощность пересечения k мно­
жеств равна ( n- k )! ( k чисел <<знают» свои места, переставляются оставшиеся n- k ) .
       Заметим, наконец, что n множеств Ai образуют С� попарных пересечений,
... , С� пересечений по k множеств (k :::; n). Таким образом,
                                n
Dn = IAt n . . . n Ani = IAI - L IAi l + L IAi П Aj l - . . . +
                               i=l      J :;:;;i <j :;:;;n
§9. Задача о беспорядках и встречах    ------                                                      55




     = n! - C�(n - 1)! + C�(n - 2)! - . . . + ( -1)k C�(n - k)! + . . . + ( - 1)"C:: (n - n)! =


        n
     = L: ( - 1)k -            (
                  n! - n' 1 -1 -1 - -1 +
                        • - 1 f + 21 3 f                . • + (-1)
                                                                     n -1
                                                                       n.f
                                                                             )   •                (1)
       k=O         Lf
                  "' ·  -

                              ·    •  •             .




      Возвратимся (в последний раз) к задаче о секретарше . И з получеnной фор.,­
. мулы для числа беспорядков следует:

         lim
       П-+СJ9 Pn = n-+00
                         Dn
                         n. П-+00
                                           (
                                         1 1 1
                    lim -1 = lim 1 - -1 + -, - - + . . . + (-1)n - = е- 1 .
                                         1 . 2. 3!
                                                                             1
                                                                             n!
                                                                                         )
Рекуррентные формулы для числа беспорядков. На основе формулы ( 1) получим
интересные соотношения для Dn .
                                (
       Dn+l = (n + 1 ) ! 1 - -1!1 + -1 - ... ( n 1
                                     2!      +     -1)    -
                                                          n! + ( - 1 ) " +1 1
                                                                           (n + 1)! =
                                                                                             )·
                                               (
               = (-1)"+ 1 + (n + 1)n! 1 - .!_1! +, .!_2! - . + (-1)" 2.
                                                                .     .

                                                                          n!
                                                                                =    )
               = (- 1)"+ 1 + (n + 1)Dn .                                              (2)
Полученное рекуррентное соотношение

                                    \ Dn+l = (-1)"+ 1 + (n + 1)Dn \
очень похоже на соотношение, позволЯющее рекуррентно вычислять факториалы:
(n + 1)! = (n + 1) · n! (все/отличие - слагаемое (- 1)"+1). В связи с этим обстоя­
тельством число беспорядков Dn иногда называют субфакториалом (или псевдоф­
акториалом). Зная, что D = О, с помощью (2) найдем несколько значений Dn :
                         1
      D2 = 1; D3 = 3 · 1 - 1 =.2; D4 = 4 · 2 + 1 = 9; Ds = 5 · 9 - 1 = 44.
Еще одно соотношение получается так:
   Dn.f-2 = (n + 2)Dn+l + ( -1 )"+2 = (n + l )Dn+l + ( - 1)"+2 + Dn+t =
          = (n + 1)Dn+l + ( - 1)"+2 + (n + 1)Dn + ( 1)"+ 1 = (n + 1)(Dn+t + Dn)·
                                                               �




Заметим, что рекуррентной зависимости
                                     1 an+2 = (n + Щan+l + an) 1
наряду с последовательностью псевдофакториалов Dn удовлетворяет и последо­
вательность (обычных) факториалов n! (убедитесъ в этом самостоятельно).
    Обобщением задачи о беспорядках является задача о встречах. Говорят, что
перестановка (а , а2 , , an ) чисел 1, 2, . . . , n имеет k встреч, если ровно k чисел
                   1        • • •
                                                                            '


56 ------__,.---"'- Гnава LXVIII. Комбинаторика

«остаются на своих местах>> (когда порядковый номер элемента в перестановке
совпадает с его величиной: а; =          i).
                                    Число пересталовок n элементов с k встре­
чами обозначим Dn ,k . Отметим несколько частных случаев: Dn ,o = Dn ; Dn ,n = 1 ;
Dn,n-l = О . Последнее равенство вытекает из того, что если все элементы пере­
становки, кроме одного, занимают «свои» места, то и этому элементу не остается
ничего другого, как занять место, чей номер совпадает с ним, и, таким образом,
ровно n - 1 встреч не может быть!
     Каждую перестановку n элементов с k встречами можно сгенерировать,
выполняя следующую процедуру:
1-й шаг. Выбрать k элементов, остающихся на своих местах.
2-й шаг. Оставшиеся n - k элементов переставить так, чтобы ни один из них
         не занял «своего» места.
Первый шаг выполняется с: способами, второй Dn -k способами. С помощью
                                                      -



правила произведения получаем форМулу для числа встреЧ

                                    1 Dn,k = c: Dn-k· l
§ 1 О. Ч исл о сюръекций
Пусть Х и У   некоторые множества. Отображение f : Х -+ У называется сюрь­
                  -


екцией, если всякий элемент множества У является образом некоторого элемента
множества Х:
                         't у Е У 3 х Е Х     f (x) = у.
Определим образ множества при заданном отображении как множество образов
всех его элементов: /(Х) = {J (x) 1 х Е Х}. Отображение J : Х -+ У является
сюръекцией тогда и только тогда, когда / ( Х) = У.
     Пусть Х и У     конечные множества:
                      -




                  Х = {x l , Х2 , · , Xn } , У ':= {у\, У2 • Ym } ,
                                   · .                     · · ·   ,




. причем n � т. НаЙдем число всех сюръекций J : Х -+ У.
     Введем   в   рассмотрение следующие множества:
                             А = {/ : Х -+ У}
- множество всех отображений из Х в У;
                       F = { ! : Х -+ У 1 / (Х) = У}
- множество всех сюръекций;


    Легко видеть, что F = А1 n А2 n . . . nА т . Вновь находит применение формула
включения-исключения!
    Каждое отображение J : Х -+ У можно задать размещением (с повторениями)
объема n : ( J (x 1 ) , f (x2 ), , J (xn)) . Для отображений J Е А элементы указанного
размещения выбираются из т-элементного множества У ; для f Е Ai - из (т- 1 ) ­
                           • • •




                                                      (i
элементного множества У\ { yi } ; для J Е Ai n Aj =1- j)'- из (т - 2) -элементного
§ 1 1 . Обобщеllие фopмylllol IКJIIO'IetiИ!I•ИCКЛIO'I811ИI ------- 57

множества У \ {Yi , Yj } и т. д. Формула для числа размещений с повторениями уже
известна читателю; применив ее, получим
                 IAI = т"; \Ail (т - 1) " ; IAi n AJI = (т - 2)71;
Таким образом,
                                 т
IFI = IA1 n . . . n Атl = IAI - L \Ail + L !Ai n AJI - . . . +
                                i=l     J";i<j";m
     +(-l)k
                        = тn - т · (т l ) n + С�(т - 2)n - . . . + (-l)m-l     ·   с;::- 1   · 171•
     Итак, число сюръекций n-элементного множества в т-элементное множе­
ство равно
                                     т-1
                                 \FI L( l )k C� (т k)71•
                                          -            -



                                     k=IJ
       Пример.  различных шаров нужно разместить по т различным ящикам так, чтобы ни
                 n
       один ящик не остался nустым. Каким числом способов это можно сделать?

       <4 Распределение шаров по ящикам можно рассматривать как отображение множества

       отображение является сюръекцией. Число сюръекций nодсчитано выше. •
       шаров в множество ящиков; отсутствие nустых ящиков соответствует тому, что указанное




§ 1 1 . О бобщение формуn ы в кn юч ения - искпюч ения
Пусть А - некоторое множество, А 1 , А2 , , An - его подмножества. Определим
                                               • • •


функцию w(n) следующими соотношениями:
                             n
   w(O) = IA\, w( l ) = L IAi\, w(k) =                         (k � n).
                        i=l
Пусть N(r) - число элементов множества А, которые принадлежат ровно r раз­
личным множествам Ai (если r О, то - ни одному). С помощьrо введенных
функций формула включения-исклrочения принимает следующий вид:
                       N(O) w(O) w(l) + w(2) - . . . + (-I)�'�w(n).
В этом параграфе мы докажем, что имеет место и более общее соотношение:



    Возьмем произволъный элемент множества А и подсчитаем его «ВКЛад»
в правую часть доказываемого равенства. Возможны,следующие случая:      3
  1)Элемент входит менее чем в r различных множеств Ai , тогда он не принад­
    лежит никакому пересечению r и более упомянутых множеств, и вклад его
    в ПРавую часть (1) равен нулrо.
                                                                                                       '



58 ------- Гnau LXVIII;                                                                     Комбмнаfорика

 2) Элемент принадлежит ровно  r множествам Ai, тогда он принадлежит ровно
    одному пересечению r множеств и не принадлежит никакому пересечению
    большего числа множеств; таким образом, вклад элемента равен 1.
 3) Элемент принадлежит k множествам Ai, причем k > r . Тогда он входит в q
    пересечений r множеств Ai, в с�+ 1 пересечений r + множеств Ai, в С�      1
    пересечений j множеств Ai (j k ). Вклад указанного элеменха в правую
                                                     �
    часть ( 1) равен
                 1:
                2.:::: ( - 1)j- rcj-rcf.   =   [в силу комбинаторного тождества            1 )] =
                i= r
                               k                                 k
                      ==   2.:::: ( -l)J-rejc� = [в силу 9)] 2.:::: (- 1 )i-rс� с�=;       =


                           j=r                                  j=r
                                         k -r
                      = [i = j - r] = ck 2)-1)i ci�r            [в силу 4)]       =   О.
                                         i=O
Таким образом, формула из правой части ( 1) дает число элементов А, входящих
ровно в r подмножеств Ai. Это и требовалось доказать.
                                               А , 5О читают журнал В, 5О - С, 30 - А
                           ,
    Прммер. Из lОО студентов 60 читают журнал
    и В, 20 - В и С , 40 - А и С , 10 - А, В и С. Сколько студентов не читает ни один
    из трех журналов? Сколько студентов читает ровно два журнала?

     .. в данной задаче в роли исходного множеСТВ<\                            100 студен­
                                                             А выстуnает множество из

    Имеем: w(O} = 100; w(l) = 60 + 50 + 50 = 160; w(2) = 30 + 20 + 40 = 90; w(3)
    ТОВ, nодмножества А 1 , А2, А3 состаЩJяют студенты, читающие соответствующие журналы.
                                                                                       10.
    Тогда N(O) = w(O)-w(l)+w(2)-w(3) = 20; N(2)           w(2)-Clw(З) = 90-3- 10 = 60. 111>
    Ответ. 20   человек не читают журналов, 60 человек читают по два журнала.



§ 1 2 . Числа Стирnи н rа 11 рода
Числом Стирлинга // рода S(n, k) называют число неупорядоченных разбиений 3)
n-элементноrо множества на k непустых множеств. Элементы разбиения будем
называть блоками.
    Прммер. Вычислим 9(6, 2). Число неуnорядоченных разбиений 6-злементного множества
    на два блока, один из которых содержит l элемент, равно CJ = 6 . Если в одном из двух
    блоков 2 элемента, то число соответствующих разбиений равно Ct = 15. Наконец, если
    оба блока, на которые разбивается исходнов множество, - 3-злементные, то число таких
    разбиени й - CU2 = 10. Таким образом, 8(6, 2)     6 + 15 + IO = 3 1 .

    Очевидно выnолнение следующих «гранИ<tных условий»: при любом нату­
ральном n S(n, = S(n, n) = при k > n S(n, k) = О .
                           1) 1 ,               1,
   Э) О понятия разбиения см.       § 2 rл. LXVII.
§ 12. Чмс:па·Стирлиига 11 рода
       ·                            ------                                                                                        59

           По определению полагают

            1 8(0, О) = 1,        при любом натуральном n                         8(n,    О) = О,            8(0, n) ·=   o. J   (1 )
     С помощью результатов § 10 мы сейчас выведем формулу для чисел Стир­
линга 11 рода. Каждую сюръекцию n-элементного множества А в k-элементное
( n > k) можно рассматривать как упорядоченное разбиение А на k непустых частей
(каждая часть состоит из элементов, имеющих один и тот же образ при заданном
сюръективном отображении). Пусть 8n ,k - число таких сюръекций:
                        k-1         1                                                                k
                8n, k = 2) - 1)jct(k - j )n = [i = k - j]                             = (- 1)k   2: Ck(- 1)i i\
                        j=O                                                                      i=l
Всякое упорядоченное разбиение на k блоков можно получ�'FЬ в результате выпол-                   ·

нения следующей процедуры:                                  ·




  1) сделать неупорядоченное разбиение;
  2)       упорядочить его (т. е. перенумеровать полученные k множеств числами
           1, 2, . , k).
                . .




     Первый шаг процедуры может быть выполнен 8(n, k) способами, второй ­
k! способами. С помощью правила произведения получаем соотношение
                                                8n,k        = 8(n, k)       ·   k!,
или
                                                        k
                                  8(n, k)   = ( -k�.)           t    cf:(- 1 )i i n      (k   Е N) .
                                                                i= l
Для вычисления чисел Стирлинrа удобно применять следующую рекуррентную
формулу:
                              1             =
                  8(n, k) 8(n - 1, k - 1) + k8(n - 1, k).           (2)                                  l
    Докажем ее. Пусть А - множество из n элементов; х - некоторый фикси­
рованный элемент А. Число разбиений А на k блоков, среди которых содержится
блок {х} , равно 8(n - 1, k - 1) (множество А \ {х} , мощность которого n - 1 ,
разбивается на k - 1 блоков). Всякое разбиение, не содержащее блока { х}, можно
получить,
  1) разбив множество А \ { х} на k блоков;
  2)добавив элемент х к одному из полученных блоков.
Первое действие выполняется 8(n - 1, k) способами, второе - k способами.
Таким образом, число разбиений второго вида равно k8(n - 1, k) , а общее число
разбиений рщшо 8(n:- 1, k - 1) + k8(n - 1, k) , что и требовалось доказать.
    Применяя соотношения (1) и (2), составим таблицу значений 8(n, k) для
О�  n, k       �8
            (табл. З).
    Анализируя таблицу, можно заметить еще одно любопытное соотношение:

                                                1 8(n, n - 1) = C�. J
                                                                                                            '


60   ------                                                                     Гllава LXVIII. Комбинаторика
                                                 Таблица 3
                                  Числа Стирлинrа II рода S(n, k)
                                                     '


     k    о        1             2          3               4             5        6             7    8
     n
     о    1        о             о           о              о           о          о          о       о
     1    о        1             о           о              о           о          о          о       о
     2    о        1             1           о              о           о          о          о       о
     3    о        1              3          1              о           о          о          о       о
     4    о        1              7          6              1           о          о          о       о
     5    о        1             15         25             10           1          о          о       о
     6    о        1             31         90             65          15          1          о       о
     7    о        1             63        301            350         140         21          l       о
     8    о        1           1 27        966           1701        1050        266         28       1


Действительно, если n элементов разбиваются на n - 1 блоков, то все блоки,
кроме одного, будут одноэлементными, и разбиение определяется тем, какие два
элемента составят этот блок.
    Для дальнейшего нам понадобится следующая рекуррентная зависимость для
чисел Стирлинга 11 рода:
                                           n-(k-1)
                             S(n, k)   =    L        S(n - Ь , k -   1)С�:\ .
                                            Ь=l
     Для доказательства рассмотрим блок В, содержащий некоторый фиксиро­
ванный элемент х . Мощность Ь блока В моЖет быть равна 1, 2, . , n - (k - 1), так      . .


как в остальных блоках не мен�е k - 1 Элементов. Подсчитаем число разбиений
с фиксированным значением Ь. В этом случае блок В можно сформировать С�:\
способами (к элементу х нужно добавить еще Ь - элементов). Не вошедшие1
в данный блок n - Ь элеме}{тов S(n- Ь, k- 1) способами могут быть разбиты на k- 1
блоков. Значит, число разбиений, в которых IBI = Ь, равно S(n - Ь, k - 1) С�:\ .
Суммируя это выражение по возможным значениям Ь, получаем искомую форму­
лу, которой удобно придать следующий вид:

         S(n, k)   =   n�l)
                        Ь=l
                            S(n - Ь, k - 1) С�:\ =              [н        �- :: �
                                                                               i
                                                                Cn-1 - Cn-1 - Cn-1
                                                                                             ]   =


                       n-1
                   =   L S(i, k - l)C�- 1 ·                                                               (3)
                       i=k-1
     Числом Белла Bn называют число всех неупорядоченных разбиений n-эле­
ментного множества. Его можно найти, просуммировав по k количества разбиений
на k блоков:
                                     n
                              Bn = L S(n, k).
                                                  1:=0
§ 12.   Чмсnа Crмpnюira ll poдa   -------                                                          61

Удобно считать, что Во = 1 (это согласуетсЯ с формулой (4); если n > О, то
S(n, О) = О и в (4) нижнюю границу индекса суммирования можно заменй'гь
на 1). Выведем с помощью формул       и (4) рекуррентную формулу для чисел
                                                     (3)
Белла; nри n > О имеем
                                                                                                     ·




           n                   n n- 1                               n- 1    i+ l            n- 1
Bn = L: s(n, k) = L L S(i, k - 1)C�-� = L: c�- � L: s(i, k - 1) = L: c�- �вj.
         k=l                  k=l i=k- 1                            i=O     k=l             i=O
     В заключение данного параграфа установим очень важное свойство чисел
Стирлинга 11 рода, которое иногда берут в качестве их определения. Оказывает­
ся, числа Стирлинга 11 рода являются коэффициентами разложения многочлена
xn (n = О, 1, 2, ) по следующему базису в пространстве многочленов степени
                      . . .


не выше n:
                           (х)о = 1, (х) 1 = х, . (x) z = х(х - 1),
               (х) з = х(х - l )(x - 2), . . . , (x)n = х(х - 1) . . (х - n + 1).
                                                                             1
                                                                                   .




Теорема 4 .    Для любого целого неотрицательного                    n справедливо тождесff!во
                                                    n
                                           xn = L S(n, k)(x) k .                                   (5)
                                                   k =O

� Для n = О утверждение теоремы nроверяется непосредственно; поэтому будем
считать, что n N .   Е
     Докажем сначала, что соотношение                         (5)
                                             сnраведливо, если х - натуральное
число.
     Пусть F - множество всех функций f : А -+ В, где IAI = n, IBI = х .
    ·С одной стороны, их число есть А� = xn .
     С другой стороны, будем классифицировать функцИи по мощности множе­
ства /(А) . Если 1 /(A) I = k, то, во-nервых, множество С = /(А) может быть
выбрано с: способам� , а, во-вторых, при фиксированном С число функций
f : А -+ С равно числу сюръекций Sn,k (если / (А) = С, то функция f : А -+ С ­
сюръекция). Таким образом,

         В, 1/(A)I = k}/ = с; · Sn,k = с; · S(n, k) · k! =
  / {! : А -+

                         = - �;х k + 1) · S(n, k) · k! = (x) k · S(n, k).
                           х(х 1)          -            · ·




Просуммировав nолученное выражение по k от 1 до х, вновь найдем мощность
множества F:
                                                    z

                                           IFI   = L S(n, k)(x) k .
                                                   k=l
Покажем, что верхнюю границу суммирования можно поменять с х на n, не из­
менив при этом суммы. Действительно, если х < n, то слагаемые в сумме,
отвечающие значениям k > х, равны нулю, так как (x)k = О (nроверьте!); если же
х > n, то при k > n S(n, k) = О и соответствующие слагаемые в сумме также равны
62   -------                                                                            Гnава LXVIII. Комбиматорика

нулю. Нижнюю границу суммирования можно заменить на О, так как возникаю­
щее при этом дополнительное слагаемое                         S(n,
                                          О) равно нулю (поскольку                                      n Е N) .
    Итак, вычислив IFI двумя способами, приходим к равенству
                                                      n
                                       xn     =   L: S(n, k)(x)k ,
                                 k=O
справедливому для всех натуральных х. Как известно из алгебры, если два мно­
гочлена n-й степени имеют одинаковые значения более, чем в                                   n точках, то они
тождественно равны 4>. Теорема доказана. ..,.


§ 1 3 . Ч исла Стйрлин га 1 рода
Как бьmо показано в конце предыдущего параrрафа, числа Стирлинга 11 рода
S(n, k) поЯвлЯются при переходе от базиса {l, x, х2 , . . . , xn } к базису {1, (х) 1 , (х)2 ,
. . . , (x)n } в пространстве многочленов степени не выше n. Числа Стирлинга
I  рода s(n, k) позволяют совершить обратный переход; они определяются как
коэффициенты при последовательных сте'пенях х многочлена (x)n (n � 0) :
                                                          n
                                       (x)n       =   L: s(n, k)xk .                                           (1)
                                                      k=O
Очевидно, что
                                      l s(n, n) 1 (n � O). j
                                                      =                                                        (2)
Полагают также, что
                                  l s(n, k) О, =              если k   >   n. j                                (3)
       Докажем, что имеет место следующее рекуррентное соотношение:

               l s(n, k) s(n - 1, k - 1) - (n - 1)s(n - 1, k)
                           =                                                      (О < k <      n). ,          (4)

ДеJtствительно, разложив по степеням х многочлены (x)n и (x)n-I в тождестве
                                    (x)n   =   (x)n - 1 (х - n + 1),
                                                              ·




имеем:
                            n                         n-1
                           L: s(n, k)xk   (х - n + 1) L: s(n - 1, k)xk =
                                          =

                           k=O                        k=O
                           n- 1                         n- 1
                       =   L: s(n - 1, k)xk+l - (n - 1) L: s(n - 1, k)xk =
                           k=O                          k=O
     4) Разность   указанных многочленов является многочленом степени не выше n,
      у которого более n корней. По        Известному         следствию из   основной   теоремы
       алгебры такой многочлен то:ждественно равен нулю.
§ 13. Чиспа Сtирлинrв l роАа   -------                                                                            63
                                           n-l
= s(n - 1, n ,- 1)x - (n - 1)s(n - 1, О) + L (s(n - 1, k - 1) - (n - 1)s(n - 1, k)) ;z: .
                   n                                                                   k
                                           k=l
Приравнивая коэффициенты в левой и правой частях тождества при одинаковых
степенях х , получаем требуемое.
    С помощью соотношений (2), (3) и (4) , составим таблицу значений s(n, k )
                   8
для О � n, k � (табл. 4) .
                                                     Таблица 4
                                   Числа Стирлинrа 1 рода                 s(n, k)
  k       о            1            2                    3            4             5         6          7    8
  n
  о       .1           о            о                о               о             о          о      о        о
  1       о            1            о                о               о             о          о      о        о
                     -1             1
                                                                                              О.
  2       о                                          о               о             о          о      о        о
  3       о            2           -3                1               о             о                 о        о
  4       о          -6            11               -6               1             о      о          о        о
  5        о          24         -50                35            - 10             1      о          о        о
  6       о       - 1 20          274            -225              85           - 15      1          о        Q
  7       о         720        - 1764             1624           -735            175    -21          1        о
  8        о     -5040         13 068         - 13 132           6769          -1960    322        -28        1

    Глядя на таблицу, нельзя не заметить «Шахматный» порядок расстанщщи
знаков коэффициентов. Эту закономерность нетрудно доказать. С одной стороны�
многочлен
        (-x)n = ( - х) ( -х - 1) .      .   . ( -х   -   n + 1) (- 1)n x(x + 1) .
                                                                 ;=                     . .   (х + n -   1)
при разложении по степеням х имеет коэффициенты одного знака                                             ( (- l)n).
С другой стороны, его можно представить в виде
                               n                n
             (-x)n = L s(n, k)( -x) = ( -l) L s(n, k)( - 1) k- n xk ,
                                      k      n
                      k=O
откуда следует, что (- 1)k-n s(n, k) > О при 1 � k � n, то есть если k - n
четное число, то s(n, k) > О, если k - n   нечетное число , то s(n, k) < О.
                                                             -



      В заключение данного параграфа отметим
Связь между числами Стирлинга 1 и 11 рода
Представив для произвольного неотрицательного    n многочлен xn в виде
                             n           n          k
                          =            =
                       x 2: S(n, k)(x)k L S(       L s(k, j)з!,
                        n                    n, k)
                            k=O                    j=O
изменим в полученной двойной сумме порядок суммирования:
                                         n   n
                                   xn = L а! L S(n, k)s(k, j).
                                        j=O k=j
64
                                                                                                              '

     ------                                                                               Гnава LXVIII. Комбинаторика

Поскольку при k < j имеем s(k, j) = О, можно поменять нижний предел
суммирования во внуrренней сумме, не изменив при этом ее значения:
                                      n   n
                                   =
                                 n      �
                                x L L S(n, k)s(k, j).
                                     j=O k=O
Из полученного тождества следует:
                          n
                        � S(n, k)s(k, j) _


                                                    =
                                                        { о:  1    если j = n;
                                                                   если j =/= n .

Данное соотношение имеет простую матричную интерпретацию: произведение
матриц (одинаковой размерности), составленных соответственно из чисел Стир­
линга 11 и 1 рода, есть единичная матрица 5) .


§ 1 4 . П роизводящие функции
Производящей функцией для последовательности а0 , а1 ,                         • • •   , an , . . . называется фор­
мальный степенной ряд
                                                        00

                                              А(х) L a�cxk .
                                                   =                                                              (1)
                                                   k=O
Термин «формальный» означает, что мы не находим область сходимости рЯда А(х),
нигде не будем вычислять значений А(х) для конкретных значений переменцой
х, будем лишь выполнять некоторые операции над такими рядами и оnределять
коэффициенты nри степенях х; такИм образом, А(х) интересует нас не как
числовая функция от nеременной х, а как <<носитель» nоследовательности (а�с).
     Суммой произвольных рядов
                                             00                          00

                              А(х)   =       L а�сх". В(х) Ь Ь�схk  =
                                             k=O                         k=O
называется ряд
                                                         00

                                А(х) + В (х) = L(a�c + Ьk )xk .                                                   (2)
                                               k=O
Произведением ряда      А(х) на число Л называется ряд
                                                        00

                                             ЛА(х) = L Ла�сх k .                                                  (3)
                                                     k=O
     s) Этот факт можно было предвидеть сразу, исходя из общих алгебраических
      соотношений: матрицы S(i,j) и s(i,j) (О � i , j
      перехода от одноrо базиса к друrому и обратно.
                                                                  � n)   являются матрицами
,,... �..,.,... ------
ПроизведеШJем рядов            А(х) и В(х) называется ряд
                                                                                       k
                        А (х) В(х)                                      где ck       L aiЬk-i ·     (4)
                                                                                     j={)
                                  ·
                                                                                 =




     Если в последовательности (аk )"лишь конечное число членов отлично от нуля,
то ряд А(х) можно рассматривать как многочлен. Если и J.l последовательности (Ьk )
все члены, начиная с некоторого, равны нулю, то ряд В(х) - также многочл�н,
и формула (4) переходит в обычную формулу умножения многочленов.
     Из курса математического анализа известно, что если степенной ряд сходится
в пекоторой окрестцости нуля, то в этой окрестности его сумма является функцией,
по отношению к которой сам ряд является рядом Маююрена:
                        A(k}(O)
                   ak =           для любого k = О, 1 , 2, . . . .
                                      �
Заметим, что если А(х) и В(х) - аналитические функции в окрестности нуля,
то соотношения (2), (З), (4) будуr справедливы для них и как для числовых
функций. Сохраняющее операции сложения и умноЖения взаимно однозначное
соответствие между функциями, аналитическими в окрестности нуля, и их рядами
Маклорена, позволяет отождествить формальный ряд ( 1) с определяемой им
                                                            5
аналитической функцией. В табл. представлены производящие функции для
некоторых nростых последовательностей.
    Покажем, например, как может быть получена nроизводящая функция для
последовательности неотрицательных целых чисел:




                                                                Твбтlца 5


                         тельность�(
                                                           а"')
                последова
                                                                       производящая функция А.(ж)

                             1, 1, . . . ' 1, . . .
                                                                                       1
                                                                                      -ж

                        1 , 1!1 ' 2!
                                  J             1
                                     ' . . . ' ki ' . . .                             ez


                         1, 2, i, .        . , 2", . . .                         --
                                                                                     1
                                                                                  1 - 2z
                                       .




                          о,
                                                                                      ж
                               1, 2, . . . , k, . . .
                                                                                 ( 1 '- z)2
             dn. с�. . . . , С:         • . . .   , с;, о, . . .                 ( 1 + ж)"
                         о:(о: - 1)
              1 , о:,
                             2!
                                    , . . .. , (о:).с:
                                                k! , . . .                       (1 + z)4
            S(n, О) , S(n, 1), . . . , S(n, k), . . .                                (ж) ,.

3-2331
86 ------ Гяаu LXYIJI.                                                       Ком6ииатdрика

Применим аппарат nроизводящих функций к решению следующей весьма общей
по постановке задачи.
     Найти ak - чиС/Iо всех неупорядоченных k-элементных выборок. с повторениями,
удовлетворяющих заданным ограничениям на число вхождений в них каждого элемен­
та генеральной совокупности {х1, х ,
в выборке Yi раз, где Yi            2 , x,J: элемент Xi может присут.ствовать
                                          • • •


                              элеМент некоторого чиС/Iового множества Xi С No
(i 1, : . . , n) .
      Проиллюстрируем постановку задачи на нескольких «игрушечных� примерах.
 1)   Сколько разных наборов из k шаров можно получить, имея 1 синий шар,          2 оди­
      наковых белых шара и 4 одинаковых красных шара ?
      Здесь генеральная совокупность состоит из синего, белого и красного шара.
      Возможное число вхождений каждого шара в набор определяется множества-
    ми Xr = {0, 1}, Х
                       2 {0, 1 , 2 } , Хз = {0, 1, 2, 3 , 4} .
 2) В уС/Iовии предыдущей задачи вводится дополнительное ограничение: число крас­
    ных шаров в наборе должно быть нечетно.
      Изменение коснется множества, определяющего допустимое число вхождений
      красного шара:     Х3 =   {1, 3}.
      Пусть   А(х)   -
                  производящая функция для послед_овательности               (ak ). Тогда
справедливо следующее соотношение:
                                             n
                                     А(х) = П 'Е х11' .                               (5)
                                            i=l �ч ЕХ;
Действительно, если «раскрыть скобки» в правой части           (5); то получим:
                           n
                         П ''Е xll• ::: 2:::: xllt хУ" = ·Е QkXk '
                                                          оо

                                                  . . •



                         i=l у;ЕХ;     Yt····Yn             k=O
где ak    =                               для   ak суммирование производится по всем
        1/t +...L:+lfп=k
                         1 . В выражении

                                                                 =
наборам (у!, . . . , Yn ) таким, что 'V i Yi Е Xi и у1 + . . . + Yn k, в результате чего
получится искомое число k-выборок.
      Возвращаясь к примеру        l), запишем для него производящую функцию:
               А(х) = (1 + х)(1 + х + х2)(1 + х + х2 + х3 + х4) =
                    = l + Зх + 5х2 + 6х3 + 6х4 + 5х5 + Зх6 + х1•

Коэффициент при xk есть число k -элементных наборов. Таким-образом, можно
составить 3 одноэлеменrных набора, 5 - двухэлементных, 6 - трехэлементных
и т. д.
      Во втором примере

      А(х) = (l + x)(l + x + х2)(х + х3) = х + 2х2 + Зх3 + 3х4 + 2х5 + х6.
Теперь одноэлементный набор может быть только один, существует 2 набора
из двух элементов и т. д.
    В заключение рассмотрим применение аппарата производящих функций
к выводу формул для числа сочетаний (без повторений и с повторениями) . В обоих
случаях будем считать, что генеральная совокупность состоит из n. элементов.
    § f5. 'ltlсmо<.счастливых билетов -------'-- 67

    Сочетания. Каждый элемент в выборке встречается не более одного раза, т. е. 'V                             i
    Xi = {0, 1}; k-выбоiжа при этом является сочетанием (без повторений) из n по k .
    Производящая функция имеет.вид:
                                                     n
                                 А(х) = ( 1 + x)n = L: C�xk .
                                                            k=O
    СоЧетания с nовторениями. Каждый. элеменt в выборке может появиться любое
                i
    число раз: 'V Xi = N0 , k-вь�борка при этом суть сочетание с повторениями из n
    по k. Производящая функция имеет вид:
                                         ( ) n = (1 - x) -n =
        А(х) = (l + x + x2 + . . . ) n = -
                                          1
                                         1-х
                                            -


              = [ биномиальный ряд ] =            f:,   -n ( -n -   1)   · · ·   ( -n - k + 1)
                                                                                                     (-x)k =
                                                  k=O                     k!                     ·




              - � n(n + 1) . . . (n + k - 1) ( - 1 )k ( -
              - L.t              k!
                                                               Х)k -- �    k        k
                                                                      L.t cn+k - J X .
                 k=O                                                     k=O
    Таким образом, вновь получена формула для числа сочетаний с повторениями:
    Cnk -   �>
        - сn+k-J •
         В следующих параграфах данной главы аппарат производящих функций будет
    применен к решению ряда комбинаторных задач.


    § 1 5 . Ч исло счастл и вых б илетов
    Трамвайные билеты имеют шестизначные номера. Билет называют счастливым,
    если сумма его первых трех цифр равна сумме трех последнйх. Мы докажем, что
    число счастливых билетов Н может быть выражено формулой


                                   Н = -1     /1f (si-n. -
                                                         10х ) 6
                                                                 dx.
                                              о
                                         1Г             sш х



         Отметим сначала, что число счастливых билетов совпадает с числом билетов,
·   у которых сумма цифр равна 27. Для доказательства этого факта покажем, что
    существует взаимно однозначное соответствие между множеством «счастливых»
    6-значных номеров и множеством 6-значных номеров с суммой цифр 27. Это
    соответствие задается так. В произвольнам «счастливом» номере заменим 3 по­
    следние цифры на цифры, дополняющие их до 9 (например, 147 624 -+ 147 375) .
    Если сумма трех первых ( и трех последних) цифр равна k , то после указанного
    преобразования сумма трех последних цифр станет равной 27 - k , а общая сумма
    шести цифр будет равна 27.
         Всякий 6-значный номер с суммой цифр k можно рассматривать как k-выбор­
    ку, составленную из элементов генеральной совокупности { 1 , Н), 102, IОЗ, 104, 105},
    причем каждый элемент может встречаться не более 9 раз. Пусть ak - число
68   ------                                                                                   rnaea IJ(VIII, ./(Oмбltl\aToptiКI

таких k-выборок. Пр�изводящая функций для последовательности (ak). такова:

                          А(х) = ( 1 + х + х2 + . .          .
                                                                 +
                                                                        х9 )6   =
                                                                                    ( xхto--11 ) 6
Задача, которую мы решаем, сводится к вычислению а27 • Дальнейшие выкладки
будут понятны лишь читателям, знакомым с теорией функций комплексного пере-
менного. Для функции               �
                          искомое число будет вычетом, и вычислить его можно
с помощью интеграла по . единичной окружности с центром в начале координат


                              f ( xхto-_11 ) 6 хd2x8 = [x = ei'�'] =
комплексной плоскости:

        а27 = �
              21rt
                          lжl =l
                /( e t Oi<p - 1 ) 6 iei'P 1 � ( eSi<p - e-Si<p 6
                            2�              2
                                            J ei'P/2 - e-i<p/2 ) dtp =
                      1
            =       ei'P - 1 e28i<p dtp.
                           о                                                    о
                  21ri                                            =      211"


            = � J ci:�;;2) ) dtp = [v = �] � j ei;:�y ) dy .
                                 6                             6
                                                                                =

                          о                                                           о
                  2

    Заметим, что точно так же можно получить число «счастливых» 2n-значных
номеров в k-ичной системе счисления:

                                               -1
                                               1r
                                                  � � (sisinn хx ) 2n dx.
                                                         --
                                                             k

                                                    о
Таким образом, общее решение классической дискретной задаЧи записывается
с помощью интеграла от тригонометрической функции!
     Чему все-таки равно число (традиционных) счастливых билетов? Ответ: 55252
(примерно каждый восемнадцатый билет - счастливый). Наиболее быстрый прак­
тический способ получения этого результата состоит в последовательном вычис­

Pi (x) = ( 1 + х + х2 + . . + x9)i для i = 1 , 2, . . . , 5 и последующем определении
лении коэффициентов при степенях х не выше 27-й в разложениях многочленов
                                   .




коэффициента при х 27 в многочлене Р (х) . Выкладки могут быть облегчены
                                                                 6 9i
следующим соотношением: пусть Pi (x) = Е ацхk , тогда ai ,k = ai,9i - k (докажите
                                                                 k=O
его!). Несложно получить рекуррентную формулу для вычисления коэффициентов
Pi (x) через коэффициенты предшествующего многочлена Pi- t (x)-. Попробуйте
это сделать и, применяя наЙденную формулу, не более чем через 5 минут Вы
сможете убедиться в правильиости приведеиного ответа!


§ 1 6. Ч исло бинарн ых де ревьев с                                             n    верш инами
              1
Бинарное дерево Т определяется рекурсивно следующим образом: Т = 10 (пустое
дерево) или Т = (L, с, R)     упорядоченная тройка, где с
                                           -                  корень дерева                          __,...


(элемент некоторого множества), L и R - 9инарные деревья; L и R .называют
О 16. ЧИСI!О бмнарммх деревье1   сn   uрwмиами     ----"'----'- 69
соответственно левым и правым поддеревом дерева Т. Вершинами дерева называют
eroкорень, корни его поддеревьев, корни поддеревьев ero поддеревьев и т. д. Если
в L и R содержится соответственно l. и r вершин, то количество вершИн в Т
равно l + r + l . В nустом дереве нет вершин.
    Так же рекурсивно определяется понятие изоморфизма бинарных деревьев.
Два дерева называются изоморфными, если либо они оба пустые, либо являются
изоморфными их левые поддеревья и правые поддеревья соответственно. Деревъя
удобно изображать так, как показано на рис. 2.


                   n=2                 /

                   •=3       / < л > �·
                           Рис. 2.    Деревья с двумя         н    тремя вершинами

    Число существенно различных (т. е. попарно неизоморфных) бИнарных дере­
вьев с n вершинами обозначим an . Непосредственный подсчет показывает, что
а0 = 1 , а, = 1 , а:  2 , а3      5 . Выведем рекуррентную формулу для an . Если
в дереве, его левом и правом поддеревьях соответственно n , l и r вершин, то
l принимает значения О, 1, . . . , n - 1 ; а r равно n - l 1 . При фиксированном
l существует а1 различных (с точностью до изоморфизма) левых поддеревьев,
an-z-t - nравых nоддеревьев , всего , в силу nравила произведения , - щап-1-1
деревьев. Суммируя по всем возможным значениям l, получим искомую формулу:

                                                     n-1

                                             an =    :2:: a,an-l- 1 ·                                  (1)
                                                       1=0

Пусть
                                                             00
                                                                 k
                                              А(х)
                                                       = :2:: akx
                                                             k=O
- nроизводЯщая функция для последовательности (ak) · Используя (1), найдем
А(х). Для этого заметим, что

А 2 (х)   = (ао + а , х + а2 х2 + . . .)(ао,+ а1х + а2х2 + . . .)            =
=   ag + (аоа, + а,ао)х :t (аоа2 + ai + а2ао)х2 + (аоаз + а1а2 + а2а1 + азао)х3 + . . . =
                                                                          = а, + а2х + азх2 + а4х3   +...,

откуда получаем уравнение для А (х) : хА2 (х)                       =   А(х) - 1 . При х # О

                                                   =    1 :±: v"f'=4Ж .
                                                                                                       (2)
                                        '

                                            А(х)
                                                               2х
70 --------,-- Гпава LXVJ\1. Комбинаторика

Применим биномиальное разложение:

   ( 1 - 4х) /2 = 1 - 2х +
            1                   Н- !) 42 х2 - Н- !) (-�) 43 х3 +
                                   2!                           3!
                                !2 (-!) (-1) (-�)              4                             00 2n (2n - 3)!! ...,".n
                                                                                            2:
                                                                                -
                                                             4 ..,".4       ...
                                                                                                        n.1
                            +        2    2    2                        _       _
                                                                                    1   _
                                                                                                                        •

                                          4!                                                n= l
Поскольку все члены последовательности (an ) положительны, в формуле (2) нужно
выбрать знак минус:

                    -1 �
                       L..." 2n (2n - 3)!! n - l        [             ) � 2k (2k - 1)!! k
                                                   =        n == k + 1 = L..J
         ,
                                                                              (k + 1)!
        . А ( х ) =                       х                                            х .
                     2 n=J        n!                                     k=O

Преобразуем коэффир.иент при xk , умножив числитель и знаменатель дроби на
(2k)!! = 2 . 4 . . . . . 2k = 2 k . k! :

                                                               =
               2k (2k - 1)!!      2 k (�k - l)!!(2k)!!                 (2k)!      1
                                                                               =     c2k ·
                 (k + 1)!             (k + 1)!k!2k                   (k + 1)!k! k + 1 k
Таким образом', число бинарных деревьев с k вершинами равно




Числа ak называют числами Каталана; они появляются при решении очень многих
комбинаторных задач. Перечислим некоторые из них:
  • Каким числом способов . можно разделить выпуклый многоугольник на тре­
    угольники с помощью непересекающихся диагоналей?
  • На окружности расставлено четное число точек. Сколькими способами их
    можно попарно соединить непересекающимися хордами?
  • Задана пекоторая бинарная операция * · Каким числом способов можно
    правильно расставить скобки в выражении а 1 * а2 * . . . * an ? Термин правиль­
    но означает: внутри каждой пары скобок (открывающей и закрывающей)
    находится ровно два операнда, где операнд - это буква или выражение,
    заключенное в скобки.


§ 1 7 . Решение линей ных рекуррентных уравнений
Пусть последовательность х0, х 1 , х 2 ,       • • •    удовлетворяет следующему соотношению
                                                                                                                            ( 1)
где а1 , . . . , ak - некоторые числа.
     При заданных значениях х0 , х1 ,  , Xk -1 формула (1) полностью определяет
                                                • • •


последовательность; каждый ее эЛемент, начиная с k-го, является линейной ком­
бинацией предыдущих k элементов с коэффици�нтами ai ; поэтому формулу (1)
§ 17 Решенме llмиейных.рекурреtm1111Х урuнений ------ 71
  • .




называют линейным рекуррентным соотношением k-го порядка. Если nоложить
а0   1 , то (1) можно nереписать в виде
                                            k
                                           L aj Xn+k-j = О,
                                           j=O
или
                                                      k
                                    'V т ;;::,   k   L aj Xm-J. = О.         (2)
                                                     j=O
Поставим задачу - перейти от рекуррентного задания последовательности к форму­
ле, выражающей зависимость общего члена поСАедовательности Xn от его номера n .
     д11я решения этой задачи введем в рассмотрение:
                                                                       00

 - производящую функцию последовательности       (xn): F(t) = 2: Xntn ;
                                                                n=O
                                                  k
 - характеристический многочлен f(Л) = Л� + a1 л - J + . . . +.aAJ;
 - многочлен g(t) l + a1t + . . . + ak tk .
Оrметим следующую связь между многочленами: nри t :/= О g(t) = tk f ( i) . Дока­
жем, что F(t) является дробио-рациональной функцией. Действительно,
                 00        k          k-1 т              00      k
      F(t)g(t) = L Xiti 2: ai L tm L aj Xm-j + L tm L aj Xm-j =
                 i=O     j=O          m=O j=Q           m=k j=O
                                 k- J              k- J
                                                     т

               = [в силу (2) ] = L tm L aj Xm-j = L emtm ,
                                 т�о    j=O       m=O
где коэффициенты Ст оnределяются по коэффициентам ai и nервым k членам
nоследовательности (xn)· Итак, F(t)g(t) = Q(t), где Q(t) - многочлен стеnени
не выше k - 1 ; nоэтому F(t) � - правильная рационалъная .дробь.
     Дальнейший ход наших выкладок будет следующим: мы представим F(t)
в виде суммы простейших дробей, запишем разложения простейших дробей по сте­
nеням nеременной t , nосле чего ·по ВИдУ nолученного рЯда для F(t) будет ясен
характер зависимости Xn от n .
     Пусть характеристический многочлен J(Л) имеет s различных (комnлексных)
корней: Л1 кратности r1     , Л, кратности r8 :
                             •   . . •




                                           8
                             /(Л)         П <л - л, )r' ,
                                          i=J
Тогда

                      g(t)
72 -------...,--"- Глава                                                                                 LXVIII. Комбинаторика
Как известно из алгебры, разложение правильной рациональной дроби со знаме­
нателем         g(t) на простейшие дроби имеет вид


где   Aij    - некоторые константы. Применив биномиальное разложение, получим


                                                                     1 ) . . . (-j - n + 1)
                                   1   +�
                                        L.",
                                                      (-j)(-j
                                                                                            (-Лt) n =
                                        n=l                              n!

                              = 1 + L C}+n-IЛntn = 1 + 2: cf��-l лntn .
                                              00                                  00




                                    n=l                n"'l
Таким образом,


 F(t) = t � Aij (l + E cJ��-1Лftn ) = :z:o + t,(t л� � AiicJ��-1) t11,

или, поскольку         cJ+�-I      - многочлен от                  n степени j - l (при фиксированном j),
                                 F(t) :z:o + f:(t Лf .f'i(n) ) t'',
                                             n=l i=l
                                             =                              ·




где   .f'i(n) - некот()ръrй многочлен степени н е выше ri - J                                (i    = l, . . . , s).
       Мы доказали, что общий член последовательности, удовлетворяющей линей­
ному рекуррентному соотношению k �го ПОj:)ядКа, имеет вид

                                                               8

                                                     Xn = L Лf.f'i(n) ,
                                                          i=l
где для     i   = 1, . . . , n число Лi         - корень кратности ri характеристического много­
члена рекуррентного соотношения,                          Pi (n)
                                                          - многочлен степени, не иревосходЯщей
ri   - 1.   Конкретный вид указаиных мноГочленов определяется nервыми k членами
последовательности:           :z:o, :z:1 ,   • • •   , :z:�;- 1 • В частности, если       все корни характеристи­
ческого многочлена - простые                              (т. е. кратности 1 ), то        последовательность             (:z:11 )
nредставима в виде суммы геометрических проrрессий:

                                                                        k
                                             'r/ n Е No Xn L"; ctЛf,
                                                           i=l
где ·Ci     -   некоторые константы.
       Рассмотрим несколько примеров.

       Мр��мер 1. nоследовательность чисел Фибоначчи задается соотношениями

                              Жо   = О,          Zt =     1,   Vn Е   No        :1:11+2 = Жn+t +   Жп·
у�� �----�--- 73
     <111 Составим характеристическое уравнение:

                                                   .Л2 -   Л- 1 = О.
     Его корни А1, 2 1 ±2"[5 ; формула общего члена:
                      =
                                      - ( 1 + ) + (1 - )
                                 Xn - С1
                                             vrs n
                                                     С2
                                                          vrs n
                                           2            2
     Коэффици�нты с1 и с2 определим из «начальных условий»:

                                                    1 +-
                               = с1 + с2 = О, = с . --  J5 1 - vГs
                          х0                       х1
                                                       2 + с2--2- = 1 .
     Решив систему .цвух:уравнений с двумя неизвестными, получим окончатель\iый результат:




     Пример 2. Найдем все последовательности, удовлетворяющие условию
                                      v    n Е No     = Xn+2 2Xn+l -:- Xn ·                                        (3)
     <111 Характеристическое уравнени!!     А2 -    +1= 2Л     О имеет двукратный          корень:     А1,2   =   1,
     поэтому общий член последоватеЛьности имеет вид:

                                       Xn = (an + Ь) · ln an + Ь,=


    где константы
    образом,   (xn)
                      а Ь
                     и оnределяются первыми двумя членами последовательности. Таким
                    - арифметическая прогрессия. Этот результат можно было предви­
    деть, заметив, что соотношение           (3)
                                         является характеристическим для арифметической
    nрогрессии: каждый член последовательности, начиная со второго, есть среднее ариф­
    метическое его соседних членqв. ..,.

    Пример 3. Найдем последовательность (хп ) , задаваемую соотношениями
             х0   = 1,    Х1   = 3,   Х2    = 6, V n Е No         Хn+З 4xn+2 - 5xn+l 2xn.
                                                                               =            +
     <111 Разложим характеристический многочлен на множители:

                               Л3 - 4Л2 + 5Л- 2 = (Л - 1)2 (А - 2).
    вИд  n-го члена последовательности:    Xn = (an + Ь) + с · 2n .    а, Ь, с
                                                                       ·
                                                                                    Константы           найдем
    из системы уравнений

               х0 = Ь + с = 1 ; = а + Ь + 2с = 3; 2 = 2а + Ь + 4с = 6.
                                      х1                                   х                    ..,.

    Ответ: Xn = n + 2n .


                                              Упражнения

Правило произведения
  1 . Из города А в город Б ведут 5 дорог, а из tорода Б в город В - 7 дорог. Сколько есть
     различных маршрутов из города А в В через Б?
  2. В меню столовой 3 первых, 5 вторых и 3 третьих блюда. Сколькими способами можно
     выбрать обед из трех блюд (первое, второе и третье)?
  3. Сколько есть двузначных чисел, не содержащих цифр О, 2, 5 ?
  4. Сколько есть двузначных чисел, не сод�ржащих цифр 3, 6?                   1,
                                                                                    '

74   ------                                                         Глава LXVIII. Комбинаторика

     5. Номер автомашины состоит из трех букв латинского алфавита (содержащего 26 .букв)
       и трех цифр. Сколько можно составить различных номеров автомашин?
     6. У рояля 88 клавиш. Сколькими способами можно извлечь последовательно 6 звуков?
     7. Сколько натуральных делителей имеет число 23 34 • 56 ?
                                                       •




     8. Сколько натуральных делителей имеет число 23 34 • 45 ?
                                                       •




     9. Сколько есть пятизначных чисел,
        1) оканчивающихся двумя семерками?
        2) начинающихся с двух одинаковых цифр?
        3) в каждом из которых нет одинаковых цифр?
        4) в каждом из которых соседние цифры различны?
        5) делящихся на 4 и не содержащих цифр О, 4, 6, 8?
        6) в записи которых есть одинаковые цифры?

                       \
        7) в записи кщ·орых есть хотя бы одна четная цифра?
 10. Сколько есть перестановок цифр О, 1, 2, . . . , 9, в которых
       1) цифра 3 занимает третье место, а цифра 5 - пятое?
       2) цифра 1 следует непосредственно за цифрой О?
       3) цифра О занимает одно из первых трех мест, а цифра 1 - одно из последних
                              ·

          четырех мест?
       4) цифра О занимает одно из первых пяти мест, а цифра 1 - одно из первых трех мест?
       5) между цифрами О и 1 стоят ровно три цифры?
       6) цифра О расположена левее цифры 1?
       7) цифра 1 расположена между цифрами О и 2?
       8) хотя бы одна из первых трех цифр делится на 3?
 1 1 . Сколькими способами можно рассадить за десятью партами 1 О мальчиков и 1 О девочек
     так, чтобы за каждой nартой сидели а) мальчик слева, а девочка справа? б) маЛьчик
     и девочка?
 12. Сколькими способами можно прочитать слово ПАРУС, двигаясь вправо или вниз
     по каждой из следующих таблиц?

                  @]       ш 0 0 @]                                          ·@]
                  ш        0 0 @]                            @]               ш
                  0        0 @]                           @] ш                0
                  0        @]                          @] ш [EJ               ш
                  @]                                @] ш ш ш                  @]
 1 3. Сколькими способами можно расставить на шахматной доске 8 одинаковых ладей
       так, чтобы никакие две из них не били друг друга?
 14. Сколькими способами можно расставить на шахматной доске 8 одинаковых ладей
       так, чтобы они били все поля?
Сочетания

 15. Вычислить: Ci , С�0 , CJo , Cj� , с: , C/l .
 16. Найти число подмножеств Х множества { 0, 1 , 2, 3, 4, 5, 6, 7, 8, 9} , обладающих следу­
       ющими свойствами:
Уnражнено      ---�----                                                                                                    75

       1) IXI = 3 ;
       2) IXI = 5, 1 Е Х ;
       3) IXI = 6 , 2 r;. Х ;
       4) 1Xl = 7 , { 0, 1 } C X, 2 rf_ X ;
       5) множество Х состоит из трех четных и двух нечетных чисел;
       6) IXI � 5 .

 17. На окружности nоследовательно отмечены точки                       А1 ,   • • •   , А1 2 • Сколько существует
       1)   хорд с концами в отмеченных точках;
       2)   треугольников с вершинами в отмеченных точках;
       3)   выпуклых четырехугольников с вершинами в отмеченных точках;
       4)   треугольников с вершинами в отмеченных точках, не имеющих общих точек
            с nрямой   А2 А8 ;
       5)   треугольников с вершинами в отмеченных точках, имеющих общие точки с прямой
            A I As ?

 18.   На окружностИ отмечено       n   точек. ТочкИ соединяются всевозможными хордами; из­
       вестно, что никакие три из них не пересs:: каются в одной точке внутри круга. Найти:

       1)   число точек nересечения хорд внутри круга;
       2)   количество частей, на которые хорды делят круг.

 19.   На nрямой l отмечено       8 точек,   а на параллельной ей прямой                    т   (l   f=   т)   -   11   точек.
       Сколько существует
       1)   треугольников с вершинами в отмеченных точках;
       2)   выпуклых четырехугольников с вершинами в отмеченных точках? ,

 20. Две     команды играют      в волейбол до 4 побед. Сколько                    существует разных вариантов
       изменения счета в игре по партиям?
 21.   Сколькими сnособами можно разложить                4   белых и          3 черных шара по 6 различным
       ящикам?
 22.   Решить nредыдущую задачу nри дощшннтельном условии: ни один ящик не , должен
       быть nустым.
 23.   Сколькими способами можно разложить                    20   одинаковых шаров по                     5   различным
       ящикам так, чтобы
       1)   в каждом ящике оказалось не менее двух шаров;
       2)   в каждом ящике оказалось не более         5   шаров;
       3)   оказалось не более двух пустых ящиков?

 24.   Найти коэффициент при        z   100 в разложении многочлена

 25.   Дан квадрат. Каждая его сторона разбита на                  n   равных частей. Через точки деления
       nроведены прямые, параллельные сторонам. Сколько существует

       1)   прямоуrольников;


 26. В
       2)   квадратов, ограниченных прове� ыми линиями?

            правлении банка 7 человек. Как во дол
       от сейфа и как следует распределить �ючи ме
                                                  4            ;э       у членами правления (каждый член
                                                                         быть минимальное число замков


       правления может получить ключи от не�к                           замков), чтобы любое большинство
       сейф могло открыть, а любое меньшинство - не могло?
 27.   Каким числом способов можно прочитать слово «абракадабра», двигаясь вnраво или
       вниз по таблице (с. 76)?
                                                                                       Глава LXVIII. Комбмнаторltlll
                                                                                                        1

76

                                    ш         ею        ею ш
                                                         ш      ш
                                    ею        ш          0
                                                        ш ШJ    ею
                                    ш         ш          ею
                                                        ШJ ш    ш
                                    ш         ею         ш
                                                        ш ш     [Ю
                                    ею        ш          cm
                                                        ею ш    ш
                                    ш         cm         ш
                                                        ш ш     ш
 28.   На клетчатой бумаге нарисован прямоугольник ABCD, стороны которого лежат
       на линиях сетки, причем длина отрезка AD в k раз больше длины отрезка АВ ( k                              -


       натуральное число). Рассматриваются всевозможные пути, проходящие по линиям
       сетки и кратчайшим образом ведущие из А в С. Доказать, что среди этих путей в k
       раз больше тех, у которых первое звено лежит на AD, чем тех, у которых первое звено
     лежит на АВ.
 29. Изучите поведение последовательносnf  (ak), где ak = С� (при фиксированном n),
     с точки зрения возрастания-убывания.
 30. Имеется карточная колода из 52 карт. Каким числом способов можно раздать по 13
     карт четырем игрокам?
Поnиномиаnьная формула

 31. Найти коэффициент при           жk в разложении многочленов:
                                                                            3)    (vx- ;y. k = -s;
       ·4) (3� - жv'х)9: k = 11;             5)   (ж2 - ж + 2)8, k = 7; 6) (v'Z+ *+ V'Z)6, k = 2.
Комбинаторные тождества
 32. С помощью формулы бинома Ньютона
                                                              n
                                                  (1 + ж)n = Е С� жk
                                                             k=O
       доказать следУ]()щие тождества:
           n                                             n                            n
       1) Е !fc� = 10n ;                          2)   Е< -1)n-k2kc: = 1;         3) Ekc� = n2n- I ;
          k=O                                          k=O                           k=O
           n                                           � с: 2n+ I - 1             6) � (-1) C� = _1_ .
                                                                                            k
       4) E(-1)k- lkC� = 0;                            L.J k + 1 = п
                                                  S)   k=O              + 1- ;       L.J k + 1
                                                                                     k=O          n+ 1'
           2n                                          2n - l k
       7) E(- l ) k(Cfn) 2 = (- l ) nCfn ;        8)   E(- l ) (Cfn- 1 ) 2 = О.
          k=O
 33. С помощью комбинаторных рассуЖДений доказать:
            n                n-r+m
       1) Е kC� = n2n-I ; 2) ""
                              L.J ckm cnr-m
                                         -
                                                r+l ·
                                           k = cn+I
          k=O                 k=m
У�*НОМR    ------�----                                                                                         77

Формуnа вкnючения-искnючения
 34. На кафедре лингвистики работают 13 человек, причем каждый из них знает хотя бы
     один иностранный язык. Десять Человек знают английский язык, семеро - немецкий,
     шестер� - французский. Пятеро знают английский и немецкий, четверо - англий­
     ский и французский, трое - немецкий и французский. Сколько человек знают 1) все
     три языка; 2) ровно два языка; 3) только английский язык?
 35. 1) Показать, что количество натуральных чисел, делящихся на n и не превосходящих
        положительного числа х , равно [x/n].
     2) Сколько есть чисел, не превосходящих 10 000 и не делящихся ни на 3, ни на 5,
        ни на 7?
     3) Сколько есть четырехзначных чисел, не делящихся ни на 3, ни на 5, ни .·на 7?
     �) Сколько есть чисел, не превосходящих 10 000 и не делящихся ни на одно из чисел
        6, 10 и 15?
     5) Показать, что если n = 30m, то количество натуральных чисел, не превосходящих
        n и не делящихся ни на одно из чисел 6, 10 и 15, равно 22m.
 36. Пусть n > 5. Показать, что простых чисел в множестве

                                        {n + 1 , n   +    2,   . . . , n + 30}

                                                                                                               +
    не больше восьми.
 37. На каждой стороне треугольника АВС отмечено по n точек, разбивающих ее на n    1
     равных частей. Рассмотрим всевозможные треугольники с вершинами в отмеченных
     точках (по одной на каждой стороне). Сколько среди этих треугольников таких, ,
     у которых ни одна из сторон не параллельна стороне треугольника АВС?
 38. Сколько существует б-значных номеров (первые цифры могут быть и нулями) с суммой
     цифр 27?
 39. В кошельке лежит по 20 монет достоинством в 1, 2 и 5 рублей. Сколькими
                                                                        .   способами
     можно из этих 60 монет выбрать k монет (k � 60)?
Задача о беспорядках и встречах
 40. С помощью рекуррентных соотношений найти число беспорядков Dn для n = 1 , . . . , 8.

 41 . Доказать, что Dn   =   [� + И .
 42. Сколькими способами можно расставить на шахматной доске 8 одинаковых ладей
     так, чтобы· никакие две из них не били друг друга и чтобы ни одна ладья не стояла
     на главной диагонали?
 43. Сколькими способами можно раскрасить клетки шахматной доски 8 х 8 в 8 цветов
     так, чтобы клетки, имеющие общую сторону, бьmи бы окрашеньt в разные цвета
     и чтобы в каждом горизонтальном ряду встречались все 8 цветов?
 44. Две колоды карт, содержащие по 52 карты, тщательно тасуются, после чего срав­
     ниваются карта за картой. Какова вероятность того, что не будет ни одной пары
     совпадающих карт?
 45. Для числа перестановок n элементов с k встречами Dn,k доказать тождества:
           n                             n                                                      n
     1)   L Dn,k = n!;       2) Dn,k = k Dn-l,k-l              (k ::::: 1 , . . . , n);   3)   L kDn,k = n!;
          k=O                                                                                  k=l
           n                       n    т
                                                     n!                   n
     4) L C�Dk = n!;         5)   L ck Dn,k = m! ;                6)    L (k - 1)2 Dn,k = n! (n � 2).
          k=O                     k=m                                   k=O
78                                                                            ' rnaвa LXVIII. Коt.бмматорика

 46. Случайным образом выбирается перестановка чисел   1, 2 . . . , n. Пусть � - количество
     элементов, остающихся на своих местах. Найти математическое ожидание и дисперсию
     случайной величины �.
 47. Секретарше нужно отправить n различных писем по n различным адресам. Она
     подписывает конверть1 и случайным образом вкладывает письма в конверты. Сколько
     в среднем писем дойдет до своего адресата?
Производя щие функции


            { 1, n = O, 1, . . . , N,
Найти производящие функции следующих последовательностей:

 48. an     =
              О, n > N.
       an = { + n > N.
              n 1, n = 0, 1, . . . , N,
 49.
              О,
          ={ +
              (n 1)(n + 2), n = О, 1, . . . , N - 1,
 50. an
              О,                   n � N.
 51.   an = an , n = 0, 1, 2, . . .
 52.   an· = n2 , n = О, 1, 2, . . . .
Пусть (an), (Ьn) - последовательности, А(х) и В(х) - соответствующие производящие
функции. Выразить А (х) через В(х) nри следующих соотношениях между последователь­
ностями:
 53.   ао = О, an = Ьn- 1 , n = 1, 2, . . . .
 54.   an = Ьn+! ·
 55.   an = Ьnн , k Е N.
 56.   an = anьn .
 57.   ао = О, an = Ьn - Ьn- 1 , n = 1,. 2, . . .
 58.   an = Ьn+! Ьn .-

                n
 59. an   = L Ь;.
            i=O
                00

 во.   an = :L: ьk .
            k=n+!
 61.   an = nЬn .
             n                         n
                                         оо

 62.   an = L Ь�;Сn-1< · С(:с) = L Cn X .
            k=O                  n=O
                         00                            00

       Пусть an = Е с:ьk . Доказать, ЧТО Ьn = L(-1) - c:a�; .
 63.
                                                   nk
                  k=n                         k=n
Рекуррентные соотношения
 64. Последовательность (an) удовлетворяет соотношению

 /                                            an+2 = aan+! + fЗan;
       уравнение :с2 - ах - f3 = О имеет два различных иенулевых корня                :с1   и   х2• Доказать,
       что имеет место тождество
                                               an = с,х� + с2 х�
       для некоторых с1 и        с2 , однозначно определяемых а1     и а2 •
Ответw   ------ 79
         (
 65. Найти формулу общего члена последовательности:
     1 ) an+2 = 4an+I - 3an ; а1 = 10 , а2 = 16;
     2) an +2 = 2 cos aan+l - an ; а1 = cos а, а2 = cos 2а .
 66. Найти количество n-значных чисел, состоящих из Цифр 1, 2, 3, в которых первая
     и последняя, а также любые две соседние цифры различны.
 67. Сколько существует раскрасок вершин n-угольника, если соседние вершины должны
     быть разного цвета, а всего имеется k цветов?
 68. Пусть n-й член последовательности задается формулой

                                     an = c1xf + с2х�,    где    Х 1 -:/= х2 .
       Доказать, что для последовательности имеет место рекуррентное соотношение
                      an+2 = aan+l + fJan , где а = Х1 + Х2, fJ = -х 1 х2 .
 69.
            {
       Найти ах4 + Ьу4 , если
              а + Ь = 1,             {
                                     а + Ь = 1,
       1 ) ах2 + Ьу2 = 1, 2) ах2 ,ЬУ2 = 25 ,,+
            ах Ьу = 2,
                +                  ах + Ьу =
            ахз + Ьуз = 3;         ахз Ьуз = 14;
                                             +
 70.   Найти число двоичных последовательностей длины 1 1 , не содержащих единиц ни в ка­
       ких трех соседних позициях.
 71 . Найти общие решения рекуррентных соотношений:
       1 ) an+2 2an+ I + an = О;
                +
       2)  аn+З + 10an+2 + 32an+l + 32an = О;
       3) аn+З 3an+2 + 3an+l + an = О .
                +
 72.   Найти an по рекуррентным соотношениям и начальным условиям:
       1 ) аn+З - 3an+2 + an+l - 3an = О, а1 = 3, а2 = 7, аз = 27;
       2) аn+З - 3an +l . 2an = О, а1 = а, а2 = Ь, а =
                      +                                     �-
                                                    з
                                                 Ответы

7. 140. 8. 70. 1 1 . а) 10! 2 ; б) 10! 2 210 • 13. 8!. 14. 2 88 - 8!. 16. 6) (210 + С�0)/2.
                                 ·                   ·



18. 1) С�. Каждая точка пересечения хорд однозначно задается (неупорядоченной) четверкой
точек - концов этих хорд.
     2) 1 + С� + С�. Будем последовательно проводить хорды. Пусть k; - число точек
пересечения i-й хорды с ранее проведенными. Эrими точками i -я' хорда делится на k; 1  +
отрезков, каждый из которых, в свою очередь, делит одну «старую» часть разбиения круга
                                                                                 N
на две «новые». Изначально имелась одна часть. После прове,nения всех хорд количество
частей равно
                                         N                       N

                                1 + L)k; + 1 ) = 1 +     .L: k;.
                                                          N+
                                    i=l                  i= l
Осталось заметить, что    N   = С�, а общее количество точек пересечения хорд


(согласно первому пункту данной задачи) .
80 -------.,.- Гя11а LXV\11 . , КОм6мматорика

       Интересен ответ к задаче при n =      . . . ' 6. Он таков: 1 , 4,
                                                  1, 2,                  16,   Физик  2, 8,           31.           ИЗ

· известного анемота на основании первых пяти результатов заявил бl!l; что общий ответ
2n-l
                                                                                                                    -


       а число31 возникло в результате погрешиости эксперимента.
20. 2С: = 70. 23. 1)           2) С� = 126; 3) Cl0 - ClC�8 - 5 = 10 431.
    ,



                       CJ0 ;
25. l ) (С�+ 1 ) 2 ; 2) n(n + 1)(2n + 1)/6. 27. Cf0 • 29. Составьте отношение ан 1 /аk . 30. 52!/(13!)4 .
33. Подсчитайте двумя способами суыму мощностей всех подмножеств n-элементного
множества. 37. (n - 1)3 при нечетмом n; (n - 1)3 + 1 при четном n.
38. CJ' - 6 · CJ7 + Cl · CJ . Реwенме. Пусть и - множество последовательностей (а 1 , а2 , • • • , а6) ,
составленных из шести неотриЦательных целых чисел с суммой 27; а для каждого i
множество А; С и состоит из таких последовательностей, в которых а; � Для решения               10.
задачи нужно вычислить         \ .n А;\. Заметим, что I UI     = Cl' ,   IA; I   = CJ' ,   IA; nA;I   = CJ   (i i= j) ,
                                •=•
а пересечение трех и большего числа множеств А; пусто.
41. Используйте оценку остаточного члена ряда из признака Лейбница. 42.                          14 833.
45. 6) (k - 1)2 =        l C� + 46. М{ = D{ = 63. А(ж) = В(ж + 1 ) .
                    2!С� - !            1.                1.                   +              66. 2 · (-1)n 2n .
        7
70. 92 . Указание. Обозначим через           an
                                     число двоичных последовательностей длины n, удо­
влетворяющих условию 3\lдЗЧИ. Найдите начальные условия и рекуррентное соотношение
для последовательности         (an) ·
ГлаваLХIХ�----

                              ТЕОРИЯ П О ЙА



                                                         1
     При решении ряда перечис;;rительных задач комбинаторные объекты мoryr
естественным образом отождествляться.
     Приведем конкретный nример. Некогда пассажиры общественного трансnор­
та, заходя в автобус, троллейбус или трамвай, не покуnали билет у кондуктора,
а nробивали заранее купленный абонемент компостером, установленным в салоне
трансnортного средства. Контролеры проверяли, соответствует ли расположение
дырочек на пробитом абонементе данному компостеру. Ясно, что с точки зрения
как контролера, так и пассажира, компостеры, дающие картинки, которые пе­
реходят одна в другую (например, в результате выполнения осевой симметрии),
различить нельзя.
     Впечатляющим примерам перечисления объектов с точностью до симметрий
была работа Артура Кэли, опубликовавшего в 1 875 г. в Докладах немецкого хими­
ческого общества статью, посвященную перечислению изомеров уГлеводородов.
     Обобщение идей Кэли привело к теории Пойа, названной так в честь аме­
риканского математика венгерского происхождения Джорджа Пойа l } . Эта теория
соЗдавалась в 30-х годах ХХ столетия, но развивается и применяется и лоныне,
особенно в части персчисления графов различных видов.
     В теории hойа nодсчет числа элементов некоторого множества осуществля­
ется с точностью до отношения эквивалентности, заданного на данном множестве
nри помощи указания некоторой группы подстановок, действующих на этом мно­
жестве. В результате применения теории Пойа для числа классов эквивалентности
различных видов строится производящая функция. Заметим, что производящие
функции к решению различных комбинаторных и вероятностных задач применя­
ли еще [ Лейбниц, Я. Бернулли, А. Муавр, Л. Эйлер и П. Лаплас.
     Теория Пойа является хорошим nримерам демонстрации возможностей ал­
гебраического аппарата при решении комбинаторных задач.




   J) На русс�ом !!ЗЫКе !l:щан ы таJ<Ие широко извес�ые в круrу любителей матема­
      ТИК!! КI!Иrи Д. Пойа, i<ак «Математика и nравдаподобные рассуждения�, «Как

      и теоремы из анализа�, rде, правда, фигурирует как Георг Полна (это немецК!IЙ
      решатЬ задачу•. Он таюке один 11з авторов знаменитоrо двухтомника «Задачи

      вариант звучан i!Я ero имени и фамi!Лии).
82 ------ Глава LXIX. Теори11 Пойа

§ 1 . Ци кловой индекс группы подстановак
Пусть S - n -элементщ>е множество. Подстановкой на множестве S называется
взаимно однозначное отображение S на себя.
     Образ элемента s Е S при действии на него подстановкой 1Г : S -+ S будем
                                                                               _




обозна';lать тrs. Тождественная подстановка е переводит каждый элемент S в себя:
                                         Vs   ЕS      es = s.
ПроизведенИем тr1 тr2 подстановек 1Г1 и 1Г2 на множестве S назовем их компо�
зицию - подстановку, определяемую последовательным выполнением данных
подстановок:
                            V s Е S (1Г 1 1Г2) s = 1ГJ (1Г2 s) .
Операция умножения подстановек обладает своjtством ассоциативности:
                             V тr1 , 1Г2 , 1Гз (1ГI 1Г2)1Гз = 1ГI (1Г2 1Гз).
Действительно,


и, значит,
                                                                                           \
Естественным образом теперь определяется (натуральная) степень подстановки.
После установления ассоциативности операции умножения подстановок, степень
(тrn ) определяется стандартно, как n -кратное произведение тr _ · 1Г · тr ::::::; тrn .
      Если некоторое множество подстановек на S
                                                                                   •
                                                                                       • • •




   • замкнуто относительно операции умножения;
   • содержит тождественную подстановку;
   • вместе с каждой подстановкой содержит ей обратную,
то оно образует группу, в которой умножение подстановек является (групповой)
бинарной операцией, а в роли нейтрального элемента выступает тождественная
подстановка е . Самой «бедной» (по числу ее Элементов) является группа, содержа­
щая лишь е . .Самая <<богатаЯ>> группа содержит все подстановки на множестве S,
их число совпадает с числом перестановок n элементов и равно n! . Такую группу
называют симметрической и обозначают Sn .
       Зафиксируем некоторый элемент s Е S и рассмотрим последовательность
                                 S, 1ГS, 1Г S, 1Г3 S,
                                           2
                                                            • • •




Данная последовательность не может содержать бесконечное число различных
элементов ввиду конечности множества S. Первый элемент, который .повторно
встретится в последовательности, есть s (если бы это бьmо не так, и подобным
свойством обладал элемент r = тrj s = тrm s , то элемент r при подстановке 1Г был бы
образом двух различных элементов: тrj - I s и тгm- I s, что противоречит взаимной
однозначности отображения тr ) . Наименьшее (натуральное) число k такое, что
тrk s = s , называют порядком элемента s. Последовательность
                                                    '            s, тrs, тr 2 s, . . . , тrk - I s
называют орбитой (или циклом) элемента s .
      Элементы орбиты циклически переставляются подстановкой 1Г (рис'. l ) . Возь­
мем ка�ой-нибудь элемент, не входящий в орбиту s (если, конечно, такой элемент
§ 1 . ЦиiUIОВОй индекс rруппы подстановак ------- 83

существует, что будет в случае, когда орбИТа s не исчер­
пывает всего множества S); он порождает свою орбиту,
не имеющую общих элементов с орбитой s . Если пpJ>J этом
остались элементы множества S, :f!e вошедшие в постро­
енные орбиты, то можно указать еще одну орб�>Jту J>J т. д.
                                                                    k
В результате множество S разбивается на непересекаю- 1r - I s
щиеся орбиты (каждая подстановка задает, вообще говоря,                     Рис. !
свое разбиение S).
      Длиной орбиты называют число ее элементов. Если подстановка разбивает
множество S на k1 орбит длины 1 , k2 орб�>Jт длины 2, . . . , kn орбит ДЛJ>JНЫ n, то
говорят, что подстановка имеет тип (k1 , k2, • • • , kп). Сумма длi>!:Н всех орбит равна
ч�>Jслу элементов множества S:
                                             n
                                            l: iki = n.
                                            i=l
       Цикловым индексом подстановки называют одночлен


где   (k1 , k2, . . . , kп)
                 - тип- подстановки.
    Цикловым индексом группы подстановак G называют среднее арифметическое
цикловых индексов ее элементов:




       Рассмотрим несколько примеров.
       Пример 1 . Тождественная nодстановка е nорождает n орбит длины 1 , nоэтому цикловой
       индекс груnnы, состоящей только из тождественной nодстановки, раве"':

                                         1 Ри(х1 ,    • • •   , х,.)   =    х�. �
       Пример 2. Дпя вычисления циклового и ндекса симметрической груnnы                     S,.
                                   (k1 , k2, • • • , kп).
                                                                                                      найдем число
       nодстановок,, имеющих тиn

       -. Рассмотрим заnись разбиения n-элементного множества на орбиты: сначала k1 пар
       скобок для заnиси одноэлементных орбит, затем                   k2
                                                          пар скобок для заnиси 2-элементных
       орбит и т. д. На имеющихся внутри всех скобок n nозициях n элементов можно расставить
       n! сnособами; nри этом nолучающимся заnисям будут соответствовать nодстановки
       указанного тиnа. Однако одной и той же nодстановке будет соответствовать, вообще
       говоря, несколько заnисей. Подсчитаем, сколько.
            Каждая орбита длинЬ! i в nределах данных скобок может быть заnисана i сnособами

       nосле этого оnределяется однозначно). Наnример, 3-элементную орбиту а --t Ь --t с --t а
       (на nервое место можно nоставить любой элемент орбиты, заnолнение остальных мест

       можно заnисать тремя сnособами:

                                       (а, Ь, с) , (Ь, с, а) , (с, а, Ь) .
             Скобки, соответствующие, орбитам        Длi!IНЫ i,         можно nереставить   k;!   сnособами.




                                                                                                  /
84   ________              _:._______________                                            Гnава LXIX; .теорм�� Пойа

         Значит, семейство орбит длины i ме»кет быть представлено ik; ki ! способами.         ·


     Поэтому общее число способов записи подстановки типа (k1, • • • , kn) равно
                                                 n
                                                п iki ki'·                                         !
                                                                                                  /
                                                i=l
     а количество подстановак указанного типа -
                                                          n!
                                                     n
                                                 П i"i ki !
                                                 i=t
     Учитывая, что /Sn /   =   n!, получим выражение, для циклового индекса симметрической
     группы



     где суммирование ведется
                          .   по всем решениям уравнения
                                   '




     в неотрицательных целых числах. ..,.
     Пример З. Каждое самосовмещение многоугольника или многогранника задает некоторую
     подстановку на множестве его вершин (а также ребер или граней). Нетрудно видеть,
     что если некоторые самосовмещения образуют группу, то тем же свойством обладают
     и соответствующие им пЬдсщновки на множестве вершин (ребер или граней).
          Найдем цикловой индекс группы подстановак вершин тетраэдра, порожденных его
     вращениями.
     � Вращение тетраэдра вокруг его высоты на 120° в любом направлении задает подста­
     новку на множестве вершин, имеющую тип (1, О, 1, О) (вершина, через которую проходит
     высота, при вращении остается на месте, образуя орбиту из одного элемента, три другие
     вершины циклически переставляются, образуя орбиту длины 3 ) . Всего имеем 8 таких
     вращений тетраэдра и соответственно 8 подстановок, имеющих цикловой индекс х]ж� .
          Вращение тетраэдра на 180° вокруг прямой, соединяющей середины противо­
     положных ребер, порождает подстановку типа (0, 2, О, О) (концы каждого из указанных
     ребер меняются при повороте местами, образуя 2-Элементную орбиту). Поэтому в группе
     подстановак имеется три подстановки с цикловым индексом х� .
          Учтя, наконец, тождественную подстановку, имеющую цикловой индекс ж1 . запишем
     цикловой индекс рассматриваемой группы:

                                                              (8ХtЖз + Зх2 + ж1 ).   •
                                                         1                2
                           Ра (Жt , х2, Хз , Х4) =
                                                                               4

                                                         12

                           1
§ 2. Л емма Бернсайда
Пусть S - конечное множество, (G , ·) - конечная rpynna, каждому элемен­
ту g которой поставлена в соответствие некоторая подстановка 1r9 , действующая
на множестве S . Пусть данное соответствие является гомоморфизмом:
§ 2. .·11емма &ерисаiiде   '----- 85

Отметим, что nри этом нейтральному элементу груnnы е Е G будет соответ­
ствовать тождественная .подстановка е , а элементу, обратному к произвольному
элементу g , - подс�ановка, обратная к тr9 .
    Действительно, с одной стороны, V g Е G тreg = тr9• С другой сторо:ны, в силу
гомоморфизма, тreg = тrе тr9• Значит,
                                 •




                                V g Е а тrе • тr9 = тr9 ,
что говорит о том, что .тrе - тождественная подстановка: тrе = е . Второе утвержде­
ние доказывается с nомощью следующей цепочки выкладок:
                                     е    тrе   тr9.9-t   =   тr9 тrg- 1 ,
                                                                  •




откуда получаем тr9- 1 = (тr9) 1 •   �



       Назовем элементы 8t и 82 множества S эквивалентными (в1 "" 82), если най­
дется такой элемент g Е G, что отвечающая ему подстановка тr9 переводит В 1 в в2 :
тr9s1 = 82 . Докажем, что введенное отношение на множестве S, оправдывая свое
название, действительно является отношением эквивалентности.
       Рефлексивность. V s Е S в ""' в. Действительно, так как тrе е , то лля любого
В Е S 1re8 = 8 .
       Симметричность. Если в 1 ,...., s2 , то в2 "' 8 1 • Для доказательства этого утвержде-
ния заметим, что если для некотороrо g Е G тr9s1 = 82, то s 1 (тr9) - s2 = тr9-1 s2 ,
                                                                                          1
и, значит, 82 "' St .
       Транзитивность. Если s 1 "' 82 и 82 ""' sз , то в1 ""' sз . В самом деле, если
тr91 В1 = 82 и тr92 s2 = Вз , то тr92g1 B 1 тr927rg1 8 t = тr02 в2 = sз, т. е. 81 "' sз . С nомощью
введенного отношения множество S разбивается на классы эквивалентности,
будем называть их транзитивными множествами.
      Пример   1 . Пусть   S ..,.. множество всех раскрасок вершин тетраэдра в k   цветов:
                                     =S {(at. а2, аз , а4) 1 а; Е С}, ICI k
      ( а; - цвет i-й , вершины, С - множество цветов); G - групnа вращений тетраэдра. При
      вращении тетраэдра его вершины меняются местами, в результате чего одна раскраска
      nереходит в другую, т. е. каждому вращению тетраэдра соответствует некоторая nодста­
      новка на множестве раскрасок. Транзитивное множество в данном случае составляют та·
      кие раскраски , которые могут быть nолучены одна из другой в результате некоторого вра­
      щения тетраэдра. Раскраски, входящие в разные транзитивные множества, - существен·
      но различны, nоскольку не nереходят друг в друга одним лишь вращением тетраэдра .
         ' Число транзитивных множеств, на которые разбивается множество S отношением,
      оnределяемым груnnой G, обозначим TG(S) .
           Элемент s Е S называется инвариантным относительно подстановки 1r9 , если nод­
      становка 1r9 «оставляет s на месте» (т. е. nереводит s в s): 1r9s s. Пусть I(g) - число
      элементов множества S, инвариантных относительно лодстановки 1r9 :



Теорема 1 (яемма Бернсайда; 1 91 1 r.).

                                         Ta(S) =   \ G \ I.: J(g).
                                                    1
                                                          gEG
86 ------- Глава LXIX. Teoptfl Пойа

..,. Стабилизатором элемента s назовем множество всех элементов 9 Е G таких,
что s является инвариантным относительно соответствующих им подстановок:
                                       Gs   =   {9   Е G l 1r9 s = s}.
Докажем, что для любого элемента s алгебраическая структура (G8 , · ) является
группой. Проверим выполнение всех аксиом группы.
  1) Замкнутость. Пусть 91 , 92 Е G8 • Тогда
                  1Гg 1 S = S,      1Гg2 S = S        И   1Гg 1 g2 S = 1Гg 1 1Гg2 S = 1Гg 1 S = S,

    т. е . 9 1 92 Е Gs .
 2) Ассоциативность имеет место «по наследству>> , поскольку это свойство вы­
    полняется для элементов G, чьим подмножеством является G8 •
 3) Существование нейтрального элемента. Как было отмечено, для нейтрального
    элемента е группы G подстановка 1Ге является тождественной: 1Ге = е , т. е.
    V s Е S 1ГеS = es = s ; значит, е Е G8 для любого s.
 4) Существование обратного элемента. Пусть 9 Е G8 • Докажем, что 9 - 1 Е G8 •
    Действительно, так как s = 1r9s , 1r9- 1 S = 1Гg- 1 1ГgS = 1Г9-19s = 1Ге s = es = s.
Подсчитаем дв.умя способами
                         р=      1 { (9, s) 1 9 Е G,       s   Е   S,   1r9 s =   s} i
- число пар (9, s) таких, что элемент s                   Е    S инвариантен относительно подста­
ловки 1Гg . С одной стороны,_

                                 L i {s Е S l 1r9 s = s} i = 2:: 1(9).
                                 gE G
                        Р=
                                                                         gEG

С другой стороны,


                                 sES                                      sES
Для доказательства теоремы тепер1) достаточно найти сумму мощностей
                                                            ,       стабили-
заторов всех элементов множества S.
    Пусть
                            O(s) = { s' Е S 1 s' "' s }
- транзитивное множество, содержащее элемент s. �ючевым моментом при
доказательстве леммы Бернсайда является следующее соотношение между мощ­
ностями стабилизатора элемента и транзитивного множества:
                                  Vs    ЕS       IGs i · IO( s) l   =    IGI.
Докажем его. Пусть s' - произвольный элемент из O(s) , тогда 81 эквивалентен 8 ,
т. е. для некоторого элемента h Е G 1Гh81 = 8 . Так как, в свою очередь, 8 "' 81 ,
существуют элементы 9 Е G, для которых 1Гg8 = 81 • Подсчитаем, сколько их.
      Поскольку 8 = 1Гh81 = 1Гh1Гg8 = 1Гhg s , hg Е G8 • Покажем, что сnраведливо
и обратное. Если h9 Е G8 , то 1Гh (1Гg8) = 8 . Огсюда, в силу того, что 1Гhs' = 8
и 1Гh - nодсталовка (взаимно однозначное отображение S на себя) , следует:
         1
1Гg8 = 8 , что и требовалось.
§ 2.   Лемма Бернсайда   ------- 87
     Итак, 1r9s = s' тогда и только тогда, когда hg Е G8 • Пусть стабилизатор G8
содержит т элементов: Gs = {gJ , 92, . . . , 9т} . Соотношение hg = 9i равносиль­
но g = h�19i и задает взаимно однозначное соответствие между множеством
       Е
{g G j 1r9s = s'} и стабилизатором G8 • Таким образом, искомое <tисло равно
т - мощности стаб11щизатора.
     Мы выяснили, что ровно т = I Gs l элементам группы G отвечают подста­
новки, переводящие s в s' - фиксированный элемент транзитивного множества
O(s). Так как каждому элементу G соответствует подстановка, переводящая s
в некоторый элемент O(s) , отсюда следует:
                                          JGJ   =   J O(s) J · I Gs l ·
           ТакИм образом,



Значит, мощности стабилизаторов элементов, составляющих транзитивное мно­
жество, равны между,собой. Легко найти их сумму:

                                                                          =
                                   "" I G l          ""          IG I
                                    LJ    s•    = LJ
                                                               JO( 8) J       JGJ .
                                  s'EO(s)           s'EO(s)
Общая сумма мощностей стабилизаторов всех элементов S равна произведению
JGJ на число транзитивных множеств Ta (S) .
     Заключительный аккорд:

                              Р=                =
                                   L I(g) L I Gs l               =   Ta (S) · JG J ,
                                    gEG             sES
откуда и вытекает утверждение теоремы.                     •



           цветов. Группа вращений тетраэдра G состоит из 12 элементов (см. § 6 гл. LXVII). I(g)
           Пример 2. Подсчитаем число существенно различных раскрасок вершин тетраэдра в k

           в данной задаче озна\ает число раскрасок, которые не меняются при вращении g .
               . Для нейтрального элемента группы имеем:
                                                I(e)   =   ISI = k4 •
           При повороте · тетраэдра на 120• вокруг его высоты раскраска не изменится в том
           и только в том случае, когда все вершины основания покрашены в один цвет (вершина,
           через которую проходит высота, может быть любого цвета). Каждая такая раскраска
           (при фиксированной высоте) задается «цветом основания» и цветом вершины; поэтому
           количество таких раскрасок равно k2 • При повороте тетраэдра на 180• вокруг прямой,
           проходящей через середины скрещивающихся ребер, раскраска не изменится тогда
           и только тогда, когда концы каждоГо из этих ребер покрашены в один цвет. И в этом случае


           Таким образом, применив лемму Бернсайда, получим
           Ответ:   число существенно различных раскрасок вершин тетраэдра в k цветов равно
           -h (k4 + l lk2) .

    Полезным упражнением на развитие комбинаторного мышления будет реше­
ние данной задачи «В лоб» (непосредственным подсчетом) .
88   -------                                                                Глава LXIX, Teopkt Пойа

§ 3. Функции и классы эквивале нтности
Пусть RD = {/ : !J ---* R} - множество всевозможных функций с областью опре­
деления D и примимающих значения из множества R, где R и D - некоторые
конечные множества. Каждую такую функцию можцо отождествить с размещени­
ем с повторениями из IR I элементов по IDI ; поэтому IRDI = IRI IDI (этим фактом
и объясняется введенное обозначение) .             ·


     Пусть G - группа подстановок, действующих на множестве D. Назовем
функции /1 и /2 из RD эквивалентными (/1 "' /2 ), если для некоторой подстановки
9 G /1 (9) = /2 , т. е.
     Е
                            'V d D /1 (9 (d)) = /2 (d).
                                          Е
Докажем, что введенное отношение на множестве RD , оправдывая свое название,
действительно является отношением эквивалентности.
                                 Е
      Рефлексивность. 'V f RD f "' f . Действительно, так как G - группа, то
тождественная подстановка t G; f = /(t).
                                      Е
      Симметричность. Если /1 "' /2 , то /2 "' /1 . Для доказательства этого утвер­
ждения заметим, что если подстановка 9 принадлежит G, то и обратная ей
подс�ановка 9 - 1 является Элементом G; дальней!rtее рассуждение очевидно.
      Транзитивность. Если /1 "' /2 и /2 "' /з , то /1 "' /з . В самом деле, если
/1 (91) = /2 и /2(92) = /з , то /1 (9192) = /з , т. е. /1 "' /з .
      Каждому элементу r множества R придадим некоторый вес w(r). Вес - это
элеменt некотороrо коммутативного кольца; например, число или переменная.
                        Е
Весом функции f RD назовем произведение весов образов всех элементов мно­
жества D при отображении f:

                                       W(/) = П w(/(d)).
                                              dED
         Прммер. Пусть D = { 1 , 2, 3, 4} - множество вершин тетраэдра; R = { синий, красный, зе­
         леный, белый } = { с, к, з, б} - множество цветов. Тогда RD - множество всевозможных

         вершин, возникающих в результате вращений тетраэдра; множество RD разбивается
         раскрасок вершин тетраэдра в указанные цвета. С nомощью G - груnnы nодстановак

         на классы эквивалентности. Класс эквивалентности составляют раскраски, nереходящие
         друг в друга в результате вращений тетраэдра, такие раскраски будем называть также
         геометрически нераэличимыми. Наnример, с точностью до геометt)И ческой неразличи­
         мости существует ровно одна раскраска, nри которой три вершины - белые, а одна -
         красная. Каждому элементу множества R nридадим вес: w (c) = х, w(к) = у, w (з) = z ,
         w(б) = t . Вес уnомянутой выше раскраски равен t3y .

Теорема 2.     Эквивалентные функции имеют одинаковый вес:
                         если /1 "' /2 . то W(/1 ) = W(/2) .

• Если /1 "' /2 , то для некоторой подстановки                9Е   G имеем     /1 (9)   =   f2 •   Вес
функции /1 равен .

                            W (/1) = П w(/1(d)) = П w (/J(g(d))) .
                                     dED          dED
    § 3. Функции и классы эквивалентности   -------                                  89

    Последнее равенство имеет место в силу того, что g - подстановка: если d
·   пробегает по всему множеству D, то и с = g(d) обладает тем же свойством.
    Продолжим выкладки:

                               dED              dED
    что и требовалось доказать. ..,..
         Теперь становится корректным следующее определение. Весом 1C.!Iacca Экви­
    валентности называется вес любой функции из этого класса: если F · - класс
    эквивалентности и f Е F, то W(F) = W( f) .
         Заметим, что и у неэквивалентных функций могут совпадать веса. В качестве
    примера укажем для выше рассматривавшейся задачи две неэквивалентные рас­
    краски одинакового веса (рис. 2): /(1) = с, /(2) = к, /(3) = з, /(4) = б; h(1) = с,
    h(2) =, к, h(З) = б, h(4) = з.




                               ф ф                        Рис. 2

         Инвентарем множества называется сумма весов его элементов:

                                              inv R = 2:::: w(r).
                                          rER
    Поскольку определены веса функций, а также классов эквивалентности ·функций,
    то можно говорить об инвентарях соответствующих множеств. Докажем, что

                                            \ inv RD = (inv R)IDI . \               (1)
    Пусть w1 , w2 , . . . , WIRI веса элементов множества R . Если раскрыть скобки
                                   -

                                   1
    в произведении
                (inv R) ID I (wJ + W2 . + WIRI ) . . . (wJ + W2 + · · · W iRI ),
                               =
                                              +   .   .                    +
    не приводя подобные и не 'меняя порядок множителей, то получим сумму вида:
                . R) ID I = w1w1 . . . w1 w1w1 . . . w2 . . + w W . . . w ·
               (шv                                +                +             (2)
                           .
                                                                iRI I RI
                                                                       .    iRI
    Выбор члена из каждой скобки при образовании одного члена разложения (2)
    можно рассматривать как функцию f : D -+ R, тогда сам член (2) будет ее весом;
    в сумме (2) каждое слагаемое есть вес пекоторой функции из RD ; прИ этом
    дnя каждой такой функции в сумме найдется ровно одно соответствующее ей
    слагаемое. Таким образом, полученная сумма есть инвентарь множества RD .
90   ------                                                                        Глава LXIX. Теория Пойа

    Для дальнейщего нам будет полезно следующее обобщение только что дока­
занного утверждения. Пусть D1 , D2 , , Dk - разбиение множества D на k под­
                                                • • •

множеств; S - множество функций, постоянных на каждом подмножестве. Тогда
                                                   k
                                      inv S = П L w(r)ID;J.                                           (3)
                                                 i=l rER
,Заметим, что если lд l = 1 для всех i, то (3) переходит в (1). Раскрыв скобки
 В праВОЙ части (3), ПОJ{учИМ сумму ВСеВОЗМОЖНЫХ ПрОИЗВедеНИЙ Вида
                                                                                                      (4)
где (it , i2 , . . . , ik) - размещение с повторениями из множества { 1, 2, . . . , IRI}.
Пусть функция f Е S на элементах множества Di принимает значение r�f) и
w (r�f) ) = tl!�f) (i = 1 , 2, . . . , k). Тогда
                       W(f ) = (w �Л) JD,j . (w�Л) ID2I . . . . . (w�f) ) IDkl ,                      (S)

где (w (/) 1 , w2(/) , . . . , wk(/)) - размещение с повторениями из множества {w1 , w2 ,
. . . , WjRj } . Таким образом, сумма всевозможных произведений (4) совпадает с сум­
мой весов всех функций из S , что и требовалось доказать.

§ 4 . Теорема П ой а
Пусть D и R - конечные множества, G - группа подстан.овок элементов D , с по­
мощью которой мноЖество функций RD = {f R -+ D} разбИвается на классы -
                                                             :

эквивалентности Ut !2 , если 3 g Е G f1 (g) = /2 ) . Пусть элементам r Е R при­
                         "'


писаны веса w(r) (элементы некоторого коммутативного кольца). В предьщущем
                            i
параграфе указано, как задается вес функции W (! ) и вес класса эквивалентно-
сти W(F).

Теорема 3 (Д. Пойа, 1 937 г.).   Сумма весов классов эквивалентности равна

                 L W(F)
                   F
                                 =
                               rER
                                     Ра
                                       rER
                                          (L w(r), L w2 (r), L w3 (r), . . .) ,
                                                                  rER
где Ра - цикловой индекс группы подстановак G.

     Прежде, чем доказывать саму теорему, укажем на ее простое

Следствие.   Число классов эквивалентности'равно Pa(IRI, I RI, IRI, . . . ).

    Действительно, если положить вес каждого элемента R равным 1, то и вес
каждой функции, и, значит, каждого класса эквивалентности будет равен 1; по­
этому сумма весов всех классов эквивалентности будет равна их числу.-
§ 4. Те�а Пойа     _______                                                                     91

• Доказательство теоремы Пойа. Пусть Sw                -   множество функций, имеющих
вес w:
                            Sw = {/ Е RD 1 W (/) = w }.
Обозначим через Iin (9) число функций веса w, инвариантных относительно
подсталовки 9 Е G, т. е . таких, что W ( /) = w и /9 = f . Тогда

                                   2: W( f) = 2: wlw(9)·                                      (1)
                                 /. /9=1       w
Докажем, что число классов эквивалентности для множества Sw равно
                                             1
                                    Nw = IGI 2: Iw(9).                                        (2)
                                             9EG
Доказательство основывается на лемме Бернсайда·. Если f Е Sw , то для произволь­
ной подсталовки 9 Е G функция /9- 1 также имеет вес w (ввиду эквивалентности
f9- 1 "' f; как бьmо доказано в предыдущем параrрафе, эквивалентные функции
имеют одинаковый вес) . Следовательно, подсталовка 9, действующая на множе­
стве D , задает подстановку функций из множества Sw ; обозначим ее 1r9 :


    Нетрудно убедиться в том, что соответствие 9 -+ 1r9 является гомоморфизмом.
Действительно, для любой функции f
          1fм2 f
               '
                 = 1 (91 92 ) - 1 = /92 1 91 1 = (/92 1 )91 1 = 7r9, (/92 1 ) = 1r9 ,1r92/ ,
то есть 1r9, 92 = 1r9,1r92 Осталось заметить, что отношения эквивалентности, по­
                          •

рожденные на множестве Sw подсJановками 9 (действующими на множестве D )
и поДстановками 1r9 (действующими на самом множестве Sw ) , совпадают; а инва­
риантность функции f относительно 9 означает ее инвариантность относительно
1r9 (/9 = f -<===:} f = /9- 1 -<===:} f = 1r9 f ) . Теперь непосредственное
                                                                        '               применение
леммы Бернсайда дает (2).
     Зная число классов эквивалентности Nw для любог.о (фиксированного)
веса w, запишем соотношение для суммы весов всех классов эквивалентности:
                                                   .1
         2: W (F) = 2: wNw = 2: WIGI 2: Iw(9) = IGI 2: 2: wlw(9).
                                   1 .
          F          w        w      9EG            9EG w     .
Примелив (1), получим:
                                              1
                              ,2: W (F) = IGI 2: 2: W ( f).                                   (3)
                                F             9EG f, /9=/
Как отмечалось в § 1, подсталовка 9 разбивает множество D на орбиты, элемен­
ты которых циклически переставляются данной подстановкой. Если f9 = f, то
на каждой такой орбите функция f постоянна:
               V d Е D f (d) � /9(d) = /(9d) = j(92 d) = /(93d) = . . . .
92   ------- Глава LXIX. Теормt1 Пойа-
 Верно и обратное. Пусть функция f постоянна на каждой орбите, порожденной
подстановкой g . Тогда /(d) = /(g(d)) для любого, элемента d Е D , что означает:
 1 = fg .
     Таким образом, множество функций, инвариантных относительно g, совпа­
дает с множеством функций, принимающих постоянные значения на орбитах,
·порожденных подстановкой g (обозначим их D t , . . . , Dk ) . Поэтому можно при­
 менять соотношение (3) из предыдушего параграфа:
                                                      /---
                                               k   (
                            L        W(! ) =   П L w(r) /D;/.
                           f, fg=f             i=l rER
Если у подстановки g тип (k1 , k2, ) (т. е. имеется k1 орбит длины 1, k2 орбит
                                       • • •


длины 2 и т. д.), то, перегруппировав множители в последнем произведении,
получим:


                    f, fg=f
                                 (
                      L W ( !) = L w(r) k, •
                                   rER
                                               ) (L )
                                                rER
                                                     2
                                                    w r( )
                                                           k2
                                                                   •
                                                                       • • •   •




Найденное произведение можно рассматривать как результат замены переменных
X t , х2, . . . в цикловом индексе подстановки g, равном хk1 , хk22 . . . , значениями
сумм соответствующих степеней весов элементов r Е R. Таким образом, согласно
(3) сумма весов клас.сов' эквивалентности есть среднее арифметическое (по мно­
жеству G) цикловых индексов подстановок g Е G при указанных значениях
переменных Xt , х2, . . . :

                                (2: w(r), L w2(r), L w3 (r), . . .)
                                                                   1




               L �(F) = Ро                                                         .
                F                    rER        rER          rER           1


Теорема доказана. ..,.


§ 5 . Примеры
В этом параграфе теорема Пойа будет применена к решению рЯда комбинаторных
задач.
1. Начнем с задачи о числе существенно различных раскрасок вершин тетраэдра
в k цветов (решенной ранее с помощью леммы Бернсайда). Здесь
 D   - множество вершин тетраэдра;
 R   - множество цветов, IRI = k ;
 G гр111Jiпа подстановок вершин тетраэдра, порожденных вращениями тетраэдра;
     -



 дv   - множество раскрасок.
Класс эквивалентности в множестве RD составляют раскраски, которые переходят
друг в друга в результате вращений тетраэдра. Таким образом, задача сводится
к nодсчету числа классов эквивалентности. Цикловой индекс группы G был най­
ден в § 1 :
§ Б. При•ры        �----------------�------------------------------
                  __                                                                                �3
Применив следствие из теоремы Пойа, получим тот же ответ, что и ранее (см. § 2):
                                                 1
                                                12
                                                   (k4 + 1 1k2 ).
    Заметим, что применение теоремы Пойа позволяет найти не только общее
число существенно различных раскрасок, но и определить число таких раскрасок
при фиксированном распределении цветов. Если известно, какое количество вер­
шин каким цветом должно быть покрашено, то тем самым задан вес раскраски.
Коэффициент в инвентаре (сумме весов) ( классов эквивалентности при соответ­
ствующем весе и есть искомое число.
2. Задача о перечислении изомеров органических молекул задаиной                             х
структуры (рис. 3), где С - атом углерода, а места, обозначенные                            1
крести�<:ами, могут занимать метил (СН3 ), этил (С2Н5),. водород                          х -с-х
(Н) и хлор (Cl). Математическая модель этих молекул - тетра­                                1
эдр, в центре которого расположен атом углерода. Расположение            х
в вершине тетраэдра определенной группы атомов будем считать           Рис. З
покраской вершины в определе.нный цвет (один из четырех) . Таким
                                                                                                ·




образом, задача сведена к предьщущей (при k = 4). Общее число молекул равно
12(44 + 1 1 42 ) = 36. Для того чтобы подсчитать число молекул с фиксированным
              ·



числом атомов водорода, положим:
                    w(H) = х, w(Cl) = w(СНз ) = w(C2H5) = 1 . .
Тогда вес молекулы с i атомами водорода будет равен xi . Применяя теорему Пойа,
найдем инвентарь множества изомеров молекул:
                       Ра(х + 3, х2 + 3, х3 + 3) = х4 + 3х3 + 6х2 + 1 1х + 15.
Значит, существует 1 молекула СН4 (метан) , 3 молекулы с 3 атомами Н , 6 молекул
с 2 атомами Н , 1 1 моЛекул с 1 атомом Н, 15 молекул без атома Н .
3. Задача о компостере. Компостером назовем двоичную матрицу 4 х 4. Здесь
D  -  множество позиций элементов в матрице, IDI = 16; R = {0, 1} . Группа G
подстановак множества D определяется группой самосовмещений квадрата (см. § 6
гл. LXVII) и состоит из 8 элементов:
  • тождественная подстановка е (порождающая 16 единичных орбит; ее цикло­
     вой индекс (ц. и. ) х \ 6 );
  • две подстановки, соответствующие поворотам на 90° по и против часовой
     стрелки (4 орбиты длины 4; цикловой индекс каждой из подстановак х4 );
   • подстановка, соответствующая центральной симметрии (8 орбит длины 2;
     ц. и. х� ) ;
                                                                              .




   • две подстановки, соответствующие осевым симметриям относительно верти­
     кальной и горизонтЩiьной осей (ц. и. х�) ;
   • две подстановки, соответствующие симметриям относительно диагоналей
     (4 элемента остаются на месте, остальные разбиваются на пары; ц. и. х1 х� ).
     Цикловой икдекс группы G равен
                           Ра (х 1 , х2 , . . ) = 8 ( х11 6 + 2х44 + 3х28 + 2х14 х26) •
                                                  1
                                        .
94 --------.\- Гnава LXIX. Теори1 Пойа

Если отождествить компостеры, которые получаются друг из друга указанными
иреобразованиями 2) , то число различных компостеров определится так:

              Ро ( 2, 2, 2, . . . ) = g (2 6 + 2 24 + 3 · 2 8 + 2 24 26) = 8548.
                                                                               '


                                      1 1
                                                    ·                    ·     ·




Если читателю задача о числе компостеров кажется не альной, то можно ука­    �
зать на сводящуюся к ней задачу о �отошаблонах рисунков соединений инте-
гральных схем (чипов) .
                                                                                       ·




4. Задача о числе ожерелий. Имеется неограниченный запас бусинок k цветов.
Сколько можно составить различных ожерелий из n бусинок (ожерелья, получа­
ющиеся друг из друга плоскими вращениями, не будем различать) ?
    Считая, что бусинки располагаются в вершинах правильного п-угольника,
сведем задачу к задаче о числе геометрически различных (т. е. не получающихся
друг из друга вращениями в плоскости) раскрасок вершин правильного п-уголь­
ника в k цветов. При этом D - множество вершин, R - множество цветов,
IDI = n, IRI = k; RD               множество раскрасок. Огношение эквивалентности
                                   -


на множестве RD задается с помощью G - группы подстановак вершин, пораж­
денной вращениями правильного п-уоольника; IGI = n (см. § 6 гл. LXVII).
     Пусть G = {gJ , 92· · ,gn }, где 9i - подстановка, возникающая в результате по-
ворота на угол 2: j (j = 1 , . . . , n) (в частности, тождественная подстановка е = Un ).
                             . •




Тогда, если щождествить вершину с ее номером, положив D = { 1 , 2, . . . , n} (но­
мера проставляются по порядку против часовой стрелки) , то подстановка 9i
описывается· соотношениями:

                         g1· (i) =
                                       {   i + j,
                                           t + J - n,
                                            . .
                                                          если i '+ j ::::;; n ;
                                                          если     i + j > n.
Подстановка 9i сводится к увеличению номера вершины на j по модулю n:

                                    V i, j 9J(i) = i + j(mod n).
Длину орбиты произвольнаго элемента можно найти как наименьшее натуральное
число k , для которого kj делится на n. Если (n, j)            наибольший общий    -


делитель j и n , то j = j1 (n, j), n = n 1 (n, j), где j1 и n1 - взаимно простые
числа. Поэтому kj = kj1 (n, j) делится на n = n1 (n, j) тогда и только тогда, когда
  .
                                                                                           �n � !
k делится на n1 , наименьшее натуральное k с таким свойством равно n1 = P       n· .
Итак, при повороте на угол             �
                               все орбиты имеют длину � , стало быть, число
орбит равно (n, j). Запишем цикловой индекс группы подстановок:

                                                             1 � (n,j)
                                   Р.G (XJ , Х2 , . . . ) = ;; L.J Xnf(n,j)'
                                                               j= l

     становка, очевидна: множеству D отвечают места возможных дырок, которые
   2) Практическая задача,которой соответствует описываемая математическая по­

                                                                               )
     пробивает реальный компостер; 1(0) отвечает наличию (отсутствию дырки в со­
     ответствующем месте; наконец, эквивалентные компостеры характерны тем,
     что по пробитому абонементу невозможно определить, на каком из них он был
     прокомпостирован.
УnрРнени•· -------�- 95
По следствию из теоремы Пойа общее число раскрасок N выражается формулой:

                                          = - L: k(n , ) .
                                                    n
                                     N
                                            1         j
                                            n j=t
В полученной сумме показатели степеней    k принимают значения делителей числа
n. Несложно видеть, что общее количество чисел из множества { 1 , 2, . . . , n} , для
которых их наибольший делитель с n равен d; где dln, совпадает с количеством
натуральных чисел, не превосходящих число j и взаимно простых с ним, т. е.
с rp ( j) (rp - функция Эйлера) . Таким образом,

                                  N = n-1 L...
                                          �.J k rp n
                                                   -d . а
                                                                ()
                                             d1 n

       Замечание. Задача не слишком усложнится, если не отличать друг от друга также
       ожерелья, переходящие друг в друга в результате выполнения осевых симметрий;
       вместо группы вращений правильного n-угольника нужно будет рассматривать группу
       его симметрий.


                                          Упражнения

  1. Пусть S = {а, Ь, с, d} и G = {1Г1 , '11"2 , '11"3 , 1Г4} - группа nодстановок, действующая
                                             �) ,
                                     .


     на множестве S:
                                  ь с
                                  ь с
                                         ь с d)     ,       '11"4 =   (   а Ь с d   )   ·

                                         ь d с              .             Ь а d с
       1) Убедиться в том, что G - групnа, составив для нее квадрат Кэли.
       2) Отношение эквивалентности на S порождается группой G. С помощью леммы
           Бернсайда найти число классов эквивалентности.
       3) Выписать классы эквивалентности в явном виде.
  2.   Составляются трехбуквенные слова из букв а и Ь. Два различных слова считаются
       эквивалентными, если они получаются друг из друга при перемене местами крайних
       букв; например, аЬЬ "' ЬЬа. Определить число классов эквивалентности, пользуясь
       леммой Бернсайда. Выписать классы эквивалентности в явном виде.
  3.   Вокруг стола рассаживаются n человек. Сколько существует различных располоЖений,
       если отождествлять такие, которые nолучаются одно из другого сдвигом всех людей
       по часовой стрелке на nроизвольное, но одинаковое для всех число мест?
       На листках бумаm nишуг числа от 00000 до 99 999 (числа, меньшие 10 000, доnолняют
       слева нулями) . Будем считать, что nри персворачивании цифры О, 1, 8 не меняются,
  4.

       а цифры 6 и 9 переходят друг в друга. Например, для чисел 06981 и 1 8 690 можно .
       nриготовить только один листок. Сколько всего листков nонадобится?
  5.   Составляются ожерелья из бусин трех цветов. Каждое ожерелье состоит из 1) 5;
       2) '6 бусин. Не будем различать ожерелья, nолучающиеся друг из друга nоворотом
       в nлоскости. Пользуясь леммой Бернсайда, найти число различных ожерелий.
  6.   Решить nредьщущую задачу в предnоложенщ1, что не различаются ожерелья, nолуча­
       ющиеся друг из друга поворотом в пространстве.
96   ------ Гпава UCIX. 1eopиt 11оАа
  7. Решит� задачи 5, 6 с помощью следствия из теоремы Пойа.
  8. Сколько ожерелий можно составить из двух красных, двух зеленых и двух синих бусин
     в предположениях задач 5 и 6?
  9. Завод выпускает nоrремушки в виде кольца с надетыми на него р красными и q синими
     шариками. Сколько различных поrремушек может быть выnушено? Две nоrремушки
     считаются одинаковыми, если МОI)'Т быть nолучены друг из друrа передвижением
     шариков по кольцу иди переворачиванием.
 10. Доказать, что цикловой иидекс rpynnы подстановак на множестве верUIИн правильного
     n-уrольника, nорожденных ero вращениями в nлоскоСти, есть
                                                           1        ..
                                                           - E zJ ip(d) .
                                                           n 4ln

 1 1 . Составляются ожерелья из n1 бусинок 1-ro вида, n2 бусинок 2-ro вида, . . . , nm бусинок
       m-ro вида. Не считаются различными ожерелья, которые моiуГ быть получены друг
       из друга вращением в nлоскости. Доказать, что число различных ожерелий равно
                                                       . {n/d)!
                               nl   Е f{J(d) (n1 /d)!(n2 /d)! . . . (nт/d)! �
       где суммирование ведется по всем чИслам ,d, одно1,1ременно являющямся делителями
       чисел n 1 , n 2 , • • • , nт .
 12.   Найти цикловой индекс rpynnы nодстановак на множестве вершин правильного
       n-угольнИка, nорожденных rруппой ero симметрий.
 13.   Сколькими способами м0жно раскрасить в k цветов
       1) ребра;
       2) грани тетраэдра, который может свободно вращаться в nространстве?
 14.   Сколькими способами можно раскрасить в k цветов
       1 ) вершины;
       2) ребра;
       3) грани куба, который может свободно вращаться в пространстве?
 15.   Сколькими геометрически различными споСобами можно раскрасить вершины куба
       в два цвета так, чтобы вершин каждого цвета было поровну?·
 16.   Сколькими способами можно раскрасить 5 ребер куба в синий цвет, а остальные ребра
       в красный цвет?
 17.   Найти число сушественно различных способов размещения восьми одинаковых поме­
       ток на шахматной доске размера 8 х 8. Два сnособа разметки считаются сушественно
       различными, если их нельзя преобразовать друг в друrа вращением доски или отра­
       жением относительно любой из четырех осей симметрии.
 18.   Конструктор интеrральных схем строит чипы с 16 элементами, расnоложенными
       в виде матрицы 4 х 4. Чтобы реализовать различные схемы, эти �емеиты нужно
       соединять; непосредственно соединяются только элементы, соседние по горизонтали
       или по вертикали (рис. 4) .




                          LЪ
                                                           о


                                                           о


                                                           о


                                                Рис. 4
OneN --------�- 97

       Чтобы напьmить_ межкомnонентные соединения, необходим фотошаблон рисунка со­
       единений. Для двух рисунков, показанных выше, используется один и тот же фотошаб­


       для того, чтобы на этих чиnах· реализовать все возможные рисунки соединений?
       лон (схемы симметричны относительно диагонали). Сколько требуется фотошаблонов


 19.    Следуюшие две Картинки (рис. 5) называются соответс�нно «Звезда Давида>> и «М�<rи
        Магомета».




                                                          Рис. 5



        Представим себе, '!ТО эти фигуры составлены из кусков nроволоки, спаянных в точ­
        ках   nересечений. Сколько сушествует различных звезд и мечей с то<rки зрения вида
        пересечений? Две фигуры отождествляем, если одну. из них можно nереместять в про­
        странстве    так,   что они становятся неразличимыми по виду пересечений (рис. 6).




                                                           Рис. 6




                                                          Ответы
З. (n - 1)!. 4. 98 475. 8.     16 и 1 1 соответственно.
10. Как известно,

                                             Х 1 , :1:2 , · • • ) = n �
                                                                    1
                                      RG (
                                                                              n
                                                                             ( ,j)
                                                                        J=I
                                                                    - L..,; Xnf(n,j) •


                                                                                                            от I
В полученной сумме нижний индекс при                          х   nринимает значения всех делителей числа    n.
                                                      d                                                 j
                                     n/d. Такие числа имеют вид j = kn/d, где число k взаимно
В качестве уnомянутого индекса число                      встретится столько раз, сколько есть ч исел
до    n,   для которых      (n, j)
              d
       Применив теорему Пойа, выражение для циклового индекса из nредЫдУшей задачи
просто с          и не превосходит   d. Значит, d будет в качестве нижнего индекса ровно tp(d) раз.
11.
и полиномиальную формулу, nолучим:




                                                w�1           w;::n .
       d, деляшем одновременно n1 , • • • , nт.
Нас интересует коэффициент nри                        • • •             Указанное произведение возникает лишь
при                                                           Дальнейшее просто.


4-2331
98   ------                                                                   Глава LXIX. Теори• Пойа

1 2. Если n четно, то




Если n нечетно, то

                          Ре =   2� (2:                            )
                                          x�14�(d) + nz 1 x�n- l )/2 .
                                                dln
17. ! (с� + 2Cf6 + 3 с:2 + 2 (С�8 + C� Cis + C:Cis + c:ci8 + с:))        = 553 332 533.
18. ! (2 24 + 2 . 26 + 3 . 2 12 + 2 . 24 • 210) = 2 102 800.
1 9. 13 звезд и 88 мечей.
Глава LХХ        --------�--�--




       ВВЕДЕН И Е В � ТЕОРИ Ю ГРАФО В


     История становления теории графов интересна и поучительна.
     Первая известная публикация была ответом на головоломку, подобную тем,
которыми в разное время любили скрашивать свой досуг. Отнесясь к вопросу,
поставленному в письме коллеги (о том, как именно можно пройти по семи мо­
стаМ славf{ого �рода Кёнцrсберга) вполне серьезно, Леонард Эйлер, как он сам
писал позже в одном из своих писем, «nосле долrих размышлений нашел простое
правило�, позволившее ему решить предложенf{уiО и значительно более сложны&
задачи, прцдуманные им самим. Однако несмотря на стремительно нарастающий
научный авторитет Эйлера, эта публикация (Eu/er L. Solutio proЫematis ad geome­
triam situs pertinentes, Commentarii Academiae Petropolitanae. 8. 1736. Р. 128-140)
не привлекла внимания ни современных ему ученых, ни нескольких последующих
поколений исследователей. Во всяком случае никаких следов проявления интереса
к заявленной проблематике до 1856 года не замечено.
     Прцдуманная тогда Уильямом Тhмильтоном игрушка в вцде утыканного гвоз­
диками деревянного додекаэдра также долгое время оставалась предметом досужих
размышлений, и никто не думал, что через несколько десятков лет две эти развле­
кательные задачи займут достойное место в востребованной ныне теории графов
(сам этот термин появился лишь в 1936 году).
     Конечно, этой востребованности в немалой стеnени способствовали серьез­
ные работы Густава Кирхгофа по исследованию электрических цепей и Артура
Кэли при оnисании строения углеводородов, а таКже заметно увеличивавшийся
nоток задач, возникавших в различных областях науки и техники.
     Оказалось, что при nомощи графов можно вполне усnешно моделировать
и решать самые разнообразные задачи.
     Все это потребовало обоснований, необходимость построения которых вьmи­
лась в новую теорию. Не бьти забыты ни Эйлер, ни Тhмильтон. Их имена носят
графы с весьма интересными свойствами.
     Так и возникли два естественных направления работы с графами:
   • nервое - изучение свойств собственно графов (терминология, утверждения,
     доказательства, формулы, т. е. все, как и положено в любой математической
     теории),
   • второе - применение графов в других науках и в прикладных задачах (вот
     только некоторые из них: деревья вероятностей и деревья решений, сетевые
     задачи: оценка временных затрат на выполнение больших проектов и пропуск­
     ной . способности различных коммуникаций, поиск кратчайших маршрутов
     и др.).
100   ------                                                              Гnава LXX. Введение в теорию графоА

    В этой небольшой главе мы постарались уделить внимание обоим из указан­
ных направлений.


§ 1 . О пределения и примеры
Простым графом называется уnорядоченная пара G = (V, Е) , где V - непустое
конечное множество (элементы V - вершины графа); Е - конечное множество
неуnорядоченных пар различных элементов V (элементы Е - ребра l ) графа).
       ь        d           Графы удобно предстамять рисунками, в которых
                        вершины изображаются точками, а ребра - линиями,
                        соединяющими соответствующие точки 2) . Например,
                  •     на рис. 1 изображен простой граф с множеством вершин
а           с       е V = {а, Ь, с, , е} и множеством ребер
                                     d
                Рис. l                                  Е = {{а, Ь}, J а, с}, {Ь, с}, {с, d} }.
    Граф упорядоченная пара G = ( V, Е) , где V непустое конечное множе­
                 -                                                       -


ство (элементы V - вершины графа); Е - конечное мультимножество неупоря­
доченных пар элементов V (необязательно различных) (элементы Е - ребра).
    Термин мультимножество говорит о том, что элементы в Е могут повторяться;
повторяющиеся· элементы называют кратными ребрами.
     Если в графе имеется ребро е = иv, то говорят:
    вершины и и v - смежные, или
    ребро е инцидентно вершинам и и v; вершины и и v инцидентны ребру е,
    или
    ребро е соединяет вершины и и v, или
     вершины и и v - концы ребра е.
Два различных ребра называются смежными, если они имеют п о крайней мере одну
общую вершину. На рис. 2 изображен граф с множеством вершин V = {а, Ь, с, d, е}
и мультимножеством ребер Е: аЬ, ас, ас, Ьс, ЬЬ, cd .




                   а
                       V.           с          е                   а   ы.          с         е
                    Рис. 2                           Рис. З
    Ребро вида uи (соединяющее некоторую вершину саму с собой) называют
петлей. Таким образом, простой граф - это граф без петель и кратных ребер.
    Ориентированный граф упорядоченная пара G = (V, А) , где V - непустое
                                        -


конечное множество - множество вершин; А ·- конечное мультимножество упо­
рядоченных пар элементов V (необязательно различных) - мультимножество дуг 3) .

      l) Поясним выбор обозначений для множеств вершин и ребер.               По-анrлийски
        вершина - vertex, ребро - edge.            ..
      2> Сам термин граф возник как сокрашение слова graphic (rрафик) и был введен
        в 1936 r. венгерским математиком Д. Кёниrом.
      з) А   - первая буква слова arc - дуга (анrл.) .
§ 1 . Оnредеденмt м npttмep�o�   _______                                               101

    На рис. 3 изображен граф с множеством вершин V = {а , Ь, с, d, е} и мУльти­
множ:еством дуг         А: (а,
                       Ь), (а, с), (с, а), (Ь, с), (Ь, Ь), (с, d) . К ориентированным гра­
фам мы вернемся лишь в конце данной rлавы.
    Степенью вершины графа называется число инцидентных ей ребер. При
подсчете степени вершины петлю будем }"'итывать дважды. Обозначение степени
вершины v: p(v) . Вершина v называется изолированной, если p(v) О и висячей,
                                                                         =
                                                                             ,


если p(v) = l . Имеет место следующее nростое утверждение.

Теорема 1 (яемма о рукоnожаТМIХ).   Сумма степеней всех вершин графа равна удвоенному
числу ребер:
                                     ·2: p(v)   =
                                                    2IEI.
                                      VEV

Действительно, каждое ребро дает вклад 2 при подсчете суммы стеnеней всех вер­
шин. В частности, если несколько человек обменялись рукопожатиями, то общее
число рукопожатий будет четным (графовая модель для данной задачи очевидна).

Следствие.   В любом. графе число вершин нечетной степени четно.

     .графы G , { V1 , Е1} и G2 = (Vi, Е2 ) называются изоморфными, если существу­
                    =



ет такое взаимно однозначное соответствие r.p : V1 -+ V2 при котором дЛя любых
                                                             ,



двух вершин nepвorci графа и, v Е V1 число соединяющих их ребер равно чис­
лу ребер, соединяющих соответствующие им вершины второrЬ графа r.p(u), r.p(v).
                                                          6
На рис. 4 изображены изоморфные гра- 4             5
                                                    �           1
                                                                         4  3


                                                                         �
фы (соответствующие друr другу верши-
ны в них обозначеf{ы одинаковыми но-                                             6
                                                                    1
мерами).
     Ясно, что в изоморфных графах                 2      3              5  2
одинаковое число вершин, ребер (а 'FRк­
                                                             Рис. 4
ж:е петель и кратных ребер). Однако дан­
ное условие не является достаточным для изоморфности. Два графа, изображенные
на рИс. 5, не являются изоморфными (хотя бы потому, что в одном графе имеется
«треугольник•, а во втором - нет).
     Отношение изоморфизма графов обладает свойствами рефлексивности, сим-
метричности и транзитивности, т. е. является отношением эквивалентности.
     Граф G' = (V1, Е') называют подграфом графа
G      (V, Е) (обозначение at с G), если V1 с .V,
Е' С Е . Заметим, что если G1 и G2 - изоморфные
графы , то для любого родrрафа G 1 найдется изо­
морфный ему граф, являющийся подграфом G2 .                        Рис. 5
     Порядок граф� ч»сло его вершин. Граф порядка n называется помеченным.,
если ero вершинам присвоены метки
                           -



                                               чисщ от 1 до n (причем у разных
                                                -



цершин - разные метки). Часто мы будем отождествлять аерUIИну с ее меткой.
Матрицей смежности цомеченцоrо графа называется матрица А == (aij) , где Щj            -


число ребер, соед»НЯющих вершины i и j . На рис. 6 изображен помеченный
102                                                                         Глава LXX. Видение в ТеориtО rpaфol '

                                       граф   5-ro порядка и nриведена его матрица смежности


    L/                                                                  2 1 о




                                                                  (I i)
                              •                                         о 1 1
1                 2               5                                         2   о
              Рис. б                                                    1 о о
                                                                        о   о   о

Свойства матрицы смежности
    1)   Кажцый элемент матрицъi - неотрицателъное целое число.

    2)   Матрица является симметричной: А                   т = А (символ т означает операцию транс­
         понирования).
    3) Сумма элементов i-й строки равна степени вершины i :


                                                    .2:     aij     p(i).
                                                        j
    4)   Пусть А и А1 - матрицы смежности изоморфных графов. Тогда найдется
         такая матрица перестановок4> Р, что




Первые три свойства очевидны; докажем последнее свойство. Пусть <р - функция,
устанавливающая изоморфное соответствие между графами а и                                    G    с матрицами
смежности соотве�твенно А' и                  А:
                                                                                                                ( l)
Сформируем матрицу Р следующим образом: в i - й строке поставим единицу
в <р(i)-й столбец. Тогда матрица               В = РА получается из матрицы А такой nереста­
новко,й ее строк, что i - й строкой становится строка с номером <p(i) матрицы А
(i = l , . . . , n; n -
                   порядок графа). Легко проверить, что матрица, обратная к мат­
рице перестановок, совпадает с транспонированной к ней:                               p- I   = рт .   Матрица
врт = РАР-1             получае�я из матрицы                В     такой nерестановкой ее столбцов, что
j -м столбцом становится столбец с номерам <p(j) матрицы                                 В   (j   =   l , . . . , n).
Таким образом, число, стоящее в i -й строке и j - м столбце матрицы РАР-1 , сов­
падает с числом, которое находится в <р(i)-й строке и <р(j)-м столбце матрицы А
(i, j = 1 , . . . В силу ( 1 ) отсюда и вытекает требуемое: А1 РАР -1 •
                  , n).
         Реберным графом L(G)            графа      G   называется граф, множество вершин кото­
рого находится во взаимно однозначном соответствии с множеством ребер                                            G,
причем две вершины в                  L(G)    смежны тогда и только тогда, когда смежны со­
ответствующие им ребра графа                   G.   Примеры реберных графов см. на рис.                    7,   где
ребра графов           G, G t , G2    помечены теми же номерами, которые имеют соответ­
ствующие им вершины реберных графов. Очевидно, что из изоморфности графов



         находится ровно по одной единице, а остальные элементы нуди.
      4) Матрица nерестановок    матрица, в каждой строке и каждом столбце которой
§1.   0np9ДIIJ!ell1!11 и nримеры                                                            103




                 �       1
                                   •        �         1
                                                                      А
               2 <1>4
                         G
                         3                        2
                                                  G1
                                                                         2
                                                                         G2




                         1
                                           �                3
                                                                   �.             · з

                       L(G)                      L(Gt)                 L(G2)
                                                Рис. 7


вытекает изоморфноетЪ их реберных графов. Обратное, вообще говоря, неверно
(см. примеры) 5).
     Граф, в котором нет ребер, называют пустЬ/М. Пустой граф nорядка n будем
обозначать Nn. Все вершины пустого графа являются изолированными.
     Простой граф, в котором любые две вершины смежны, называют полным.
Обозначение полного графа порядка n: Kn . Число ребер в Kn равно
                                         с2 -
                                         n{n - J)
                                           n-     .
                                            2




                                                                               *
                                                                               · '
     Граф называется регуля.рнЬIМ степени r, если степени все� ero вершин рав­
ны r. Графы Kn и Nn являются регулярными, �tx степени соответственно n 1                    -



и О. Реrудярный граф степени 3 называют кубическим. В частности, кубичесКllм
будет граф, вершины и ребра которого соответствуют вершинам и ребрам куба.
Кубическим является и граф Петерсена, изображенный на рис. 8.                           ,



   . Платоновыми графами называют графы, образованные вер-
шинами и ребрами илатоновых                 -
                                                    .
                             . тел правильных многогранни­
ков. Все они яВляются регулярными.                                           .
     Граф называется .двудольным,
                         ..       · если множество его вершин V
nредставимо в виде объединения двух непересекающихся непу-
стых множеств Vi и V2 , и при этом каждое ребро графа соединяет       Рис. 8
какую-либо вершину из V1 с какой-либо вершиной из V2 . Мно-
жества вершин V1 и V2 будем называть долями графа. Заметим, что · вершины
двудольного графа можно «раскраситЬ» 6) в два цвета так, что каждое ребро будет
иметь концы разного цвета (вершины одного цвета будут при этом составлять одну
долю). ПоllнЬIМ двудольным графом Kn,m называется двудольный граф, в которым
доли имеют соответственно n и т вершин, и любые две вершины, входящие
в разные доли, смежны. Kn,m содержит nm ребер. ЗвезднЬIМ называют граф Kt,n .
В нем n висячих вершин и одна вершина степени n. ·На рис. 9 изображены дву­
дольные графы.

      s) Оказывается, чrо прйведенный контрпример является единственным исклю­
         чением: из. связных графов только G1 и G2, будучи неиэоморфными, имеют
       · изоморфные реберные графы.


      б) То есть каждой вершине приписать некоrорый цвет.
104                                                     Dlua LXX. Введение в теори10 f'J)fфoв




              w � *                        Кз ,з                 Kt,6

                                         Рис. 9

Опера ции н ад rpaфat,tи
Объединением графов G 1          ( V1 , EI) и G2 = (V2 , Е2} называется граф Gt U G2
( V1 U V2, Е1 U E2} . Объединение графов - дизъюнктное, если объединяемые графы
не имеют общих вершин: V1 n V2 = е; . Очевидно, что операция объединения
графов ассоциативна; поэтому употребление записей вида G1 U G2 U G3 или UiGi
не будет приводить к недоразумениям.
      Соединение графов G1 (VJ , Е1 ) и G2 = (V2, Е2} граф Gt + G2 , который по-
лучается из дизъюнктноrо объединения графов G 1 U G2 добавлением всевозмож­
ных ребер вида V J v2 , где V J Е Vt , V2 Е V2 : Например, Nn + Nm = Kn,m . Дополнением
к простому графу G = (V, Е} называют граф G = (V, Е) , в котором множество вер­
шин совпадает с множеством верniин исходного графа G , и вершины смежны тогда
и только тогда, когда они не смежны в графе G . Например, Nn = Kn, Kn = Nn .
Несложно видеть, что дополнение к дополнению G совпадает с G : G = G . Если
граф G с n вершинами рассматривать как подграф полного графа Kn , то можно
сказать, что граф G получается из Kn выбрасыnанием ребер графа G. Отметим
также, что дополнение к регулярному графу есть регулярный граф.
      Граф называется связным, если его нельзя представить в виде дизъюнктного
объединения двух графов и несвязным в противном случае. Любой граф можно
                             Л � i представить             в виде ди:n>юшсrного объеди­
                          / )1 '11 называют компонентой .связности исходно­
                                              нения связных графов, каждый из которых

                                              го графа. На рис. lО граф G2 - связный,
                 Рис. I О                     граф G1 - несвязный (содержит 3 компо­
                                              ненты связности) .
                                                   Циклический граф - это связный регу­

 о                                            лярный граф степени 2. Циклический граф
                                              порядка n обозначают Сп. Граф
                                                 Wn Nt + Cn - 1 (n � 3)
                Pиc. l l                 называют колесом. Примеры циклического
                                         графа и колеса - на pиc. l l .


§ 2 . Связные гра фы
Маршрутом в графе называется последовательность ребер вида
                            VoVt , VtV2 , . Vm-t Vm .
Каждому марщруту соответствует последовательность его вершин v0 , v1 ,
                                            · .   ,




                                                                        , Vm ;     • • •



Vo называют начальной вершиной маршрута, а Vm - конечн()й вершиной; При этом
    § 2. СвiiЭI!ые rрафы   -------                                                          105

    говорят о маршруте из vo в       Vm . Маршруг удобно обозначать в -следующем виде:
                                     Vo -t V t -t v2 -t . . -t Vm .
                                                             ..




    Длиной маршрута называется число входяших в него ребер. Тривиальный маршрут
    имеет длину О (он не содержит ребер и оnределяется начальной вершиной v0 ) .
        Маршруг называется цепью, если все его ребра различны, и простой цепью,
    если все _его вершины различны, за исключением, может быть, начальной и ко­
    нечной. Если в цеnи v0 = Vm , то цеnь называют замкнутой.
        ЦиiС!l в графе - замкнутая цепь, содержатая по крайней мере одно ребро.
        Две вершины графа и и v назовем связанными, если в графе существует
    маршруг из и в v . Заметим, что если две вершины связаны, то существует
    соедиliЯющая их nростая цеПь. Действительно, nусть имеется некоторый маршрут
    из и в v , не являющийся nростой цеnью, тогда наЙдется вершина маршрута w ,
    встречаюшалея в нем не менее двух раз, и маршруг имеет вид:
                           и -t . . -t W
                                 .         -t   W t -t . . -t W -t . . . -t V .
                                                         .




    Удалив из маршруга участок w1 -t . . -t w, вновь получим маршруг из и в v . Если
                                                .


    при эtом он не будет простой цеnью, то указанную nроцедуру мо:жно nовторить.
    Бесконечное число раз она выnолняться не будет, так как число ребер графа
    конечно. В результате получим простую цепь из и в v .
          Отношение связанности на множестве вершин графа является отношением
    эквивалентности. Рефлексивность nроистекает из того факта, что каждая вершина
    связана сама с собой тривиальным маршрутом. Симметричность j::Ледует из того,
    что взяв вершины маршруга из и в v в обратном порядке, nолучим маршрут из v
    в и . Транзитивность также очевидна: объединив маршруты из и в v и из v . в w,
.   nолучим маршруг из и в w.
          Отношение связанности разбивает множество верШин графа н а классы экви­
    валентности. Очевидно, что вершины из одного класса эквивалентности вместе
    с соединяющими их ребрами образуют компоненту связности графа (оnределение
    которой дано в конце nредыдущего параграфа). Поскольку связный граф харак­
    теризуется тем, что имеет одну комnоненту связности, nриходим к выводу: граф
    является связным тогда и только тогда, когда любые две его вершины - связанные.
          Разделяющим множеством графа называется такое множество его ребер, удаЛе­
    ние которых приводит к увеличению числа компонент связности графа. РtJЗрез
    минимальное разделяющее множество (т. е. такое, что никакое его собственное
    подмножество не является разделяющим множеством). Ребро называется мостом,
    если оно образует разрез.
          Пример. Для графа, изображенного на рис. 12,
          {е1, е2 , е3} - разделяющее множество (но не
          разрез); {е 1 , е2 }
                           -    разрез ; ребра е6 и е10
          являются мостами .                                                      Рис; 12

    Лемма 1. Ребро в графе является мостом тогда и только тогда, когда оно не входит
    HU 8 один ЦUIC/l.


    <1111 Пусть ребро е = uv - мост. Ясно, что при этом и f v. Предположим суще­
    ствование цикла, содержащего ребро е. Возьмем две nроизвольные вершины �
106   ------                                                                        Гnава LXX. Введение в тeoptlll) rрафо8

и   у из той компоненты связности графа, которой принадлежит ребро е . Покажем,
что они останутся связанными и после удаления ребра е. Действительно, если
                              ребро     е       входит в некоторый маршрут, соединяющий х и                                  у,
                              то   е   можно заменить последовательностью ребер, составля­
                              ющих вместе с                    е   цикл (рис. 1 3 ) . Таким образом, отношение
                              связанности не меняется после удаления е , что противоречит
                              определению моста.
                                       Обратно. Пусть ребро                  е = иv не входит ни в один цикл.
       Рис. l З               Если nри удалении                      е   вершины  и и v останутся связанными,
                              это будет говорИть о существовании соединяющей их nростой
цепи. Объединив ее с ребром                      е,   получим цикл в исходном графе - противоречие!
Таким образом, число компонент связности при удалении                                        е   увеличивается;         е
мост. ..

      Следующее утвержденце уточняет понятие моста.


Лемма 2. Удаление моста увеличивает число компонент связности графа на единицу.

• Пусть        е = иv              мост. Рассмотрим компоненту связности, содержащую                                         е.
Через Hu обозначим множество е е вершин х , для которых существует маршрут.
из х в    и,   не содержащий ребра                        е.   Остальные вершины составят множество Hv .
Эти множества не nусты, так как                                    и Е   Hu (вершина     и   связана сама е собой
тривиальным маршрутом) и                         v    Е    Hv (если бы существовал маршрут из                      v    в и,
н е содержащий ребра е , то добавив к нему это ребро, получили бы цикл, что
nротиворечит лемме 1 ) . Удалим из графа ребро е . Любые две вершины х ,                                          у из Hu
останутся связанными между собой маршрутом вИда х � . . . �                                            и   -+ .   . .   -+
                                                                                                                        у.
Для произвольных вершин                         z, t      из       Н11 любые nростые цепи, связывающие их
с вершиной        и   в исходном графе, заканчивались ребром                               е = vи; значит, после
удаления этоrо ребра               z    и   t    свЯзаны маршрутом вИда                  z -+ . . . -+ v -+ . . . -+ t .
Таким образом, удаление                     е   привело к образованию двух компонент связности
(с множествами вершин Hu и Hv ) . Лемма доказана. ._


Теорема 2. Пусть в простом графе n вершин;                                  т   ребер и k компонент связности.
Тогда справедливы неравенства
                                                                    (n - k)(n - k + 1 )
                                       n-k           � т �                              .
                                                                            2
• Неравенство n  - k � т будем доказывать индукцией по числу ребер.
    База индукции. При т О имеем n = k неравенство выполняется.            -


    Индукционный шаг. Предположим, что доказываемое неравенство справедливо
дЛЯ всех графов с 8 ребрами, где 8 < т. Будем в графе с n вершинами,
т ребрами и k компонентами связности последовательно удалять ребра так,
чтобы не изменялось число компонент связности, до тех пор, nока это возможно.
В результате получим граф с прежним количеством вершин и компонент сnязности
и т1 � т ребрами, причем каждое ребро будет мостом. Удалим еще одно ребро.
В   силу леммы        2   число компонент. связности станет равным                               k+   1 . Так как граф
будет иметь т1            -   1 �      т    -    1    <    т ребер, к нему применимо предположение
§ 3. Метрические характеристккк графа   -------                                              107

индукции: n - (k + 1) � т' - 1 . Стало быть, n - k, � т' , и так как т' � т , - то
n - k � т, что и требовалось доказать.
    Для того чтобы оценить сверху число ребер графа через число его вершин
и комnонент связности, доnолним каждую комnоненту связности графа до nол­
ного графа. Граф nосле этого будет nредстамять собой дизъюнктное объединение
nолных графов G 1 U . . . U Gk . Пусть в i-й комnоненте ni вершин (i = 1 , . . . , k).
Можно ли еще увеличить число ребер, не меняя nри этом числа вершин и ком­
nонент связности? Можно, если найдутся две комnоненты, в каждой из которых
не менее двух вершин. Пусть 2 � ni � щ . <<Отберем» одну вершину у Gi (nотеряв
nри этом щ - 1 ребер) и <<nередадим» ее графу Gj (nриобретя зато nj ребер).
Количество ребер увеличится на величину щ - (ni - 1) = щ - ni + 1 :;;:: 1 . Повторяя
оnисанную nроцедуру, nока это возможно, nридем в конце концов к графу с k - 1
изолированными вершинами и комnонентой связности, nредставляющей собой
nолный граф с n - k + 1 вершинами. Полученный граф имеет (n-k+�)(n - k) ребер.
Поскщrьку nри каждом nроведеином nреобразовании число ребер возрастало,
nолучим требуемое соотношение: т � (n-k+J)    2 (n-k) ; nричем равенство достигается
только для дизъюнКтного объединения nолного графа и nустых графов. •

Следствие.                                                         >    (n-J�(n-2)
             Если в простом графе n вершин и т ребер и т                             ,   то граф
связен.

• Действительно, если бы граф не бьm связен и число его комnонент k :;;:: 2 , то
число ребер удовлетворяло бы неравенству
                               (n - k)(n - k + 1)   (n - 1)(n - 2)
                         т�                       �
                                       2                  2        '
что nротиворечит условию.           •
                 )




§ 3. М етри ч еские характери стики гра фа
Пусть G = ( V, Е)   связный граф. Через d(и, v) обозначим длину кратчайшей
                       -



цеnи, связывающей вершины и и v. Покажем, что d(и, v) обладает свойствами
метрики.
    Симметричность.
                        V и, v Е V d(и, v ) = d(v, и).
Свойство очевидно.
                   '
    Неравенство тр еугольника.
                        V и, v, w   ЕV   d(и, v) � d(и; w) + d(w, v).
Действительно, объединив кратчайшие цеnи из и в w и из w в v, nолучим
маршрут из и в v длиной d( и, w) + d( w, v) , длина кратчайшей цеnи из и в v будет
не более этой величины.
1 08                                                      Гnава LXX. ВН�еиме а теорию rpacjtoв

     Невыро:Жденность.
                'V и, v Е V d(и, v) � О; d(и, v) = О {::::::} и = v.
Непосредственно вытекает из определения d(и, v) .
     Таким образом, на множестве вершин связного графа введен:а структура мет­
рического пространства. d(и, v) будем называть расстоянием между вершинами
и и v.
     Эксцентриситетом вершины и называется наибольшее и з расстояний от и
ДО других ВерШИН графа:
                               е(и) = max d(u, v).
                                          vEV
Минимальный эксцентриситет вершин графа называют радиусом графа:
                                    r(G) = min
                                           uEV
                                               е(и),
а максимальный эксцентриситет - диаметром:
                                    d(G) = max
                                           uev
                                               е(и).
Другими словами, диаметр графа - это наибольшее из расстояний между двумя
вершинами графа. Если эксцентриситет вершины совпадает с радиусом графа,
то вершину называют центральной. Центральные вершины графа составляют его
центр. Вершина называется периферийной, если ее эксцентриситет равен диаметру
графа.
     Несколько примеров. В полном графе Kn (n > 1) расстояние между любыми
двумя (разными) вершинами равно 1 , поэтому r(Kn) = �d(Kn) = 1 . В полном
графе каждая вершина является и периферийной, и центральной.
     Последнее свойство имеет место и для циклического графа Cn , для которого
радиус также совпадает с диаметром:

                                  r(Cn) = d(Cn) =   [�]
([ · ] - обозначение целой части).
       Для колеса Wn радиус равен единице, а диаметр - двум, одна вершина
является центральной, а остальные - периферийные.
       Установим соотношения между радиусом и диаметром графа.

Теорема 3. Для произвольного графа    G справедливы неравенства:
                                  r(G) � d(G)' � 2r(G).
<11111   Первое неравенство следует непосредственно из определений:
                           r(G) = min
                                   u
                                      e(u) � max e(u) = d(G).
                                                u
Чтобы доказать второе неравенство, положим:
                          d(u, v) = d(G); e(w) = r(G).
Применяя неравенство треугольника, получим:
           d(G) = d(u , v) � d(и, w) + d(w, v) � e(w) + e(w)        = 2r(G).
Теорема доказана. .,..
§ 4,   ГaMИIIIoTOIIOIЫ rрафы   -------                                                   109

§ 4 . Га МИJ1ЬТОНОВЫ Графы
        .




У. Гамильтон - ирландский математик и астроном - в 1859 году придумал голо­
воломку «Кругосветное пугешествие», состоявшую в следующем: каждой вершине
                           ·
додекаэдра приписано имя известного города; необходимо по ребрам проложить
замкнутый путь, который проходил бы через все города, причем каждый город
должен встретиться ровно один раз. В честь Гамильтона графы, в которых суще­
ствуют маршруты с подобным свойством: бьши на�аны гамильтоновыми.
     Перейдем к точным определениям. Граф G - гамильтонов, если в нем суще­
ствует простая замкнутая цепь, проходящая через все вершины графа; указанную
цепь называют ПР�. этом гамильтоновым циклом. Если в приведеиных определениях
отказаться от требования замкнутости, то . придем к понятиям полугамильтонова        ·

графа и гамильтоновой цепи.
     На рис. 14 граф G1 не является гамильтоновым. (и даже полугамильтоновым),
G2 - полугамильтонов граф, G3       гамильтонов.
                                           -




                                                  G2               Gз

                                                Рис. 14

      Приведем примеры задач, сводящихся к нахождению гамильтоновых циклов
в графе.
  1) На обед за круглым столом приглашены гости. Требуется рассадить их так,
      чтобы сидящие рядом были в дружеских отношениях.
      Рассмотрим граф, в котором вершины - гости, а наличие ребра, соединяюще­
      го вершины и и v , говорит о <<дружбе» между и и v . Гостей следует рассадить
      за круглым столом в таком порядке; чтобы соответствующие им вершины
      бьши последовательными вершинами некоторого гамильтонона цикла.
  2 ) Задача Эйлера о коне. Обойти ходом коня шахматную доску, посетив при этом
      каждую клетку ровно один раз и последним (64-м) ходом вернуться в начальную
      клетку.
      Здесь граф содержит 64 вершины (клетки доски) . Две вершины соединяются
                              :
      ребром, если возможен ход коня с одной клетки в другую. Степени вершин ва­
      рьируются от 2 до 8. Эта задача достаточно широко описана в занимательной
      математической литературе. · Есть что-то притягательное в задаче Эйлера о ко­
      не, если даже на студенческих партах можно встретить наряду с традиционны­
      ми жанрами <<наскального изобразительного искусства» изображения шахмат­
      ной доски, клетки которой пронумерованы в соответствие с маршрутом коня!
  3) Задача коммивояжера. Бродячий торговец 7) (коммивояжер) должен посетить
      n пунктов. Известна стоимость проезда между любыми двумя пунктами. Тре­
      буется выбраmь наиболее «дешевый» замкнутый путь, проходЯщий через все
      пункты.
       7) В    англоязычной литературе для задачи коммивояжера используется термин
            Traveling sa\esman proЬ\em (TSP).
1 10 ------ Глава LXX. Введение в теори.Оrрафов

    Вместо стоимости проезда можно говорить, конечно, о времени или расстоя­
    нии. В любом случае, каждому ребру графа приписан некоторый «Вес»; задача
    состоит в нахождении гамильтонона цикла минимального веса (вес цикла -
    сумма весов составляющих его ребер) . Задача коммивояжера является класси­
    ческой задачей дискретной оптимизации, относится к классу так называемых
    NР-полных задач.
    Обозначим через P (n) множество всех простых помеченных графов с n вер­
шинами, а через Ph (n) - множество всех простых помеченных гамильтоновы� гра­
фов с n вершинами. В 1 969 г. советский математик В. А. Перепелица доказал, что

                                         . I Ph(n) l
                                       11m -  1    )l = 1 .
                                       n -+oo р (n


Таким образом, вероятность того, что «случайный» граф с n вершинами явля­
ется гамильтоновым, стремится к единице с ростом n. Не установлено простых
критериев гамильтоновости графа. Приведем одно из достаточных условий га­
мильтоновости.

Теорема 4 (О. Оре, 1960 r;). Если в простом графе с n вершинами ( n ? 3) для любой .
пары несмежных вершин и , и v выполняется неравенство
                                           р(и) + p(v) ;;,: n,
то граф является гамильтоновым.

Предварительно докажем следующее утверждение.

Лемма. Пусть G - простой негамильтонов граф, содержащий n ? 3 вершин, в ко­
тором Нf!СМежные вершины и и v соединяет гамильтонова цепь. Тогда
                                    р( и) + р( v) � n - 1 .

� Доказательство леммы. В гамильтоновой цепи и ---+               ---+ v, где вершины и
                                                                 • • •


и v не смежны, произвольпая вершина, смежная с и (обозначим ее и'), не может
следовать за вершиной (например, v'), смежной с v . Действительно, гамильтонона
цепь и ---+     ---+ v1 ---+ и' ---+    ---+ v легко преобразуется в гамильтопов цикл
и ---+ . ---+ v' ---+ v ---+      ---+ и' ---+ и. Поэтому число вершин, не смежных
             • • •                 . • •



       • •                 • . •



с и, не меньше числа вершин, смежных с v, то есть n - 1 - р(и) ? p(v), или
р(и) + р(v) � n - 1 . �
� Доказательство теоремы 4. Предположив, что граф не является гамильто­
новым, будем последовательно добавлять к нему ребра до тех пор, пока он
не станет гамильтоновым. Удалив последнее добавленное ребро иv, получим
Полугамильтонов граф G' , не являющийся гамильтоновым. В нем существует
гамильтонона цепь и ---+ ; ---+ v, причем вершины и и v не смежны. Приме­
                           •   •



неине леммы дает: р'(и) + p'(v) � n - 1 , где р'(и), p'(v) - степени вершин
и и v в графе G' . Осталось заметить, что р1 (и) ? р(и) , р' (v) ? р(v) , откуда
р(и) + p(v) � р'(и) + p'(v) � n - 1 < n. Получено противоречие с условием. �
                                                                                                        . .




§ 5. Эйперовы rрафы   ---..,...---                                                                     111


Следствие (Г. Дирак, 1 952 г.). Если в простом графе порядка n � 3 степень каждой
вершины не меньше n/2, то граф является гамильтоновым.



§ 5 . Эйлеровы графы
Связный граф называется                     эйлеровым,           если в нем существует замкнутая цепь,
содержащая все ребра rрафа; указанную цепь называют при этом эйлеровым циклом.
Если в приведеиных определениях снять требо�ание                               замкнутости,   то придем
к понятиям      полуэйлерова графа и эйлеравой цепи.
       На   рис. 1 5 rраф G 1 не является эйлеровым                      (и даже полуэйлеровым),     G2 -
полуэйлеров rраф,          Gз         эйлеров.




                                                            G2
                                                            Рис. 1 5

       Узнать, является л и граф эйлеровым, очень пр то ввиду следующей теоремы.
                                                    �


Теорема 5 (Л. Эйлер, 1 736 г.). Связный граф является эйлеровым тогда и толысо тогда,
когда каждая его вершина имеет четную степень.

.._   Необходимость.       Начнем движение по эйлерову циклу с «середины» Щюиз­
вольноrо ребра и будем подсчитывать (по ходу движения) степени вершин. При
прохождении через вершину ее (текущая) степень увеличивается на                               2.   Поэтому
степени всех вершин эйлерова графа четны.

       Достаточность.          Сначала докажем утверждение, которое пригодится нам и
в дальнейшем.


Лемма. Пусть все вершины графа имеют четную степень. Тогда через каждую
неизолированную вершину графа проходит некоторый цикл.

<1111 Доказательство леммы. Будем строить цикл, исходя из произвольной неизо­
лированной вершины        v . Если в графе имеется петля vv, то требуемый цикл уже
есть. Пусть теперь    .vv 1 - произвольное ребро (не являющееся петлей), инци­
дентмое вершине v. Поскольку степень v1 не меньше двух, существует ребро
v, v2 , отличн'ое от vv1 Если 112 :/= v , то маршрут v -r v 1 -r v2 можно нарастить
                                •


некоторым ребром v2v3 • Из-за четности степени каЖдой вершины маршрут можно
удлинять всякий раз, если попадаем в вершину, отличную от v . В силу конечности


                          -r        -r .   . . -r v . ..,
множества ребер через конечное число шагов описанной процедуры возникнет
замкнутая цепь        v        v1
1 12     -------                                       Гnааа LXX. Введеt�Ме в теори10 tрафОа

Продолжение доказательства теоремы. Поскольку в данном графе циклы есть,
и количество их конечно, существует самый длинный из них. Пусть С : v -+
v1 -+ . . -+ v - цикл наибольшей длины. Нужно доказать, что он содержит все
           .


ребра графа. Пусть это не так. Тогда после удаления ребер, составляющих цикл С,
возникнет непустой граф G' , в котором степени всех вершин по-прежнему четны.
Если при этом вершины, через которые проходил цикл С, стануТ изолированными,
то исходный граф не связен, что противоречит условию. Значит, в G' найдется
неизолированная вершина w . Согласно лемме, через нее проходит некоторый
цикл С', составленный из ребер графа G' . Объединив циклы С и С' (а это
возможно, поскольку у них есть общая вершина и нет общих ребер), получим
цИкл длиннее С противореЧие. �
                     -




Следствие. Связный граф является полуэйлеровым тогда и только тогда, когда в нем
не более двух вершин имеют нечетную степень.

�      Необходимость доказывается так же, как в теореме.
        Достаточность. Если вершин .нечетной степени нет, то граф является эйлеро­
вым, а, значит, и полуэйлеровым. По следствию из леммы о рукопожатиях ровно
одной вершины нечетной степени не может быть. Пусть теперь в графе ровно
две вершины имеют нечетную степень. Соединив эти две вершины новым реб­
ром, поцучим, согласно теореме, эйлеров граф. Построим в новом графе эйлеров
цикл; удаление ранее добавленного ребра приводит к эйлеравой цепи в исходном
графе. �
Задача о кенигсбергских мостах
Во времена Леонарда Эйлера семь мостов города Кёнигсберга (ныне Калининград)
бьmи располоЖены на реке Прегель так, как показано на рис. 16. Мог ли житель
этого города, выйдя из дома, вернуться обратно, пройдя по каждому мосту ровно
один раз? Рассмотрим граф, вершины которого отвечают связным участкам суши
(двум берегам реки и двум островам), а ребра - мостам. Все четыре вершины
графа имеют нечетную степень, стало быть,·ответ к задаче .отрицательный.




                                        Рис. 16

    Приведеиное выше доказательство теоремы об эйлеровых графах имеет некон­
структивный характер - оно не дает эффективного метода нахождения эйлерова
цикла (генерирование всевозможных. циклов - явно не лучший способ действий).
Приведем один из алгоритмов нахождения эйлерова цикла.
Алгоритм Флери построения эйлерова цикла
    1.   Начать цикл с произвольной вершины и . Присвоить произвольному ребру иv,
         инцидентному и, номер 1. Удалить из графа ребро иv , перейти в вершину v.
§ 5• ЗiiJ!epoJы rрафы ,
                      . ...------------                  -    ----    -    -- 113

  2. Пусть после. k шагов мы находимся в вершине w. Выбрать Произвольное
     ребро wt, причем мост выбирается только в том случае, если нет другой
     возможности. Ребру wt присвоить номер k + 1 . Удалить из графа ребро wt,
     перейти в вершину t .
Число шагов в описанном алгоритме совпадает с числом ребер в графе. П о окон­
чании работы алгоритма ребра исходного графа будут пронумерованы в порядке их
следования в эйлероном цикле. Докажем корректность предложенного алгоритма.

Теорема 6.Применение алгорит;.rа Флери к произвольному эйлерову графу всегда при­
водит к построению эйлерова цикла.

• Пусть G      эйлеров граф. Тогда степень каждой его вершины четна. В силу
                 -



этого алгоритм может закончить свою работу лишь в . начальной вершине и ,
построив при этом некоторый цикл С. Нужно доказать, что цикл С включает
в себя все ребра графа G . Если это не так, то после удаления ребер С граф
распадается на компоненты связности, хотя бы одна из которых (назовем ее В)
содержит ребра. Обозначим через А семейство всех ребер цикла С, инцидентных
вершинам В. Пусть а - наибольший номер ребра (полученный в результате
работы алгоритма Флери) из А, тогда к моменту удаления данного ребра из графа
оно бьто мостом; однако это противоречит правилу выбора очер'едного ребра:
поскольку в компоненте В степень каждой верш�ны четна (это легко видеть),
то в ней сушествует цикл, идЯ по которому (напомним, любое ребро цикла -
не мост) можно бьmо избежать преждевременного удалении моста. Корректность
алгоритма Флери доказана. .,.
    В заключение параграфа отметим, что для. случайным образом построенного
графа вероятность его эйлеровости (при большом числе вершин) мала.

                    r.). Пусть P(n) - множество всех простых помеченных графов
Теорема 7 (Р. Рейд, 1 962
с n вершинами, Pe(n) - множество всех простых помеченных эйлеровых графов с n
вершинами. Тогда
                                 . IPe (n)l
                                l1m 1      )l = 0 .
                                n-+oo Р (n
                                       -




• Пусть P0(n) - множество всех простых помеченных графов с n вершинами,
степень каждой из которых четна. Связные графы из P0(n) составлюот, как
известно, Pe(n) ; поэтому Pe(n) ,с Po(n) и IPe (n)l � IPo(n) [ . Каждый граф из P(n)
определяется некоторым подмножеством ребер полного графа Kn , содержащего
с� ребер; в силу э.того IP(n) l =:= 2с� . Нетрудно подсчитать и МОЩНОСТЬ Po(n) .
Установим взаимно однозначное соответствие между P(n - 1) и P0(n): если
все вершины нечетной степени произвольною графа из P(n -              1)   (число их
по следствию из леммы о рукопожатиях четно) соединить с n-й вершиной, то
получим граф из P0(n) . Таким образом,

                            IPo(n)l = IP(n - 1) 1 = 2с�-� .
                                                                                  Гпава
                                                                                                                   '


1 14   ______              _;_____________                                                  LXX. Введение в теориJО. rрафов

Дальнейшее просто:




                                                                       о
"1;
.t ак как   2 1-n ---? о   при                      I'
                                 n ---? оо , то и n:.� 1(P(n)\
                                                          ·<n)l            .   lll-




§ 6. ДеревьSJ и леса
Граф, не содержащий циклов, называют ациклическим графом, или лесом. Заметим,
что в ациклическом графе отсутствуют петли и кратные ребра, в силу чего он
является простым графом.                   Дерево   -    это связный ациклический граф. Таким
образом, компоненты связносrи леса являются деревьями, т. е. лес - дизъюнктное
объединение деревьев.
       В    следующей серии теорем вскрываются важные свойства ациклических
графов; при их доказательстве часто будут использоваться леммы из                                           § 2.

Теорема 8.    Граф является лесом тогда и только тогда, когда каждое ребро графа
мост.

• Граф G - лес � в G нет циклов � ни одно ребро не входит ни в какой
цикл {:::=} ( по лемме 1) все ребра G - мосты. lll-



Теорема 9.    Дерево с      n вершинами содержит n            -       1 ребро.

• Пусть G - дерево с              n
                         вершинами. В силу предыдущей теоремы каждое ребро G
(и всех его подrрафов) является мостом. Будем последовательно удалять ребра G,
при этом каждый раз число компонент связности увеличивается н а 1 (по лемме 2).
П ервоначально имелась одна компонента связности (так как дерево - связный
       ·
                                              n
граф) . После удале.ния всех ребер граф будет иметь изолированных вершин, т. е.
n компонент связности. Таким образом, в указанной процедуре бьm выполнен
n - 1 шаг; значит G содержит n 1 ребро. ..,.
C.neдc'tJмe 1 . Пусть в лесе           n   вершин,       т ребер и k                  компонент связности. Тогда
т n - k.
• Пусть в i -й компоненте связности леса 1Ji вершин и                                       тi ребер ( i 1, . . . , k);
по теореме       9   для каждого i справедливо              тi = ni            -      1.   Подсчитаем общее число
ребер леса:
                                             k                    k
                                            E<ni - 1 ) = 2:: ni                    k=       n - k.   ..,.
                                            i=l               i=l
§ 6. Деревь1 и леса �---�---- 1 1 5


Следствие 2.   Если в лесе число ребер на 1 меньше числа вершин, то этот лес является
деревом.

-<111 Действительно, в силу следствия 1 число компонент связности леса равно
разности числа вершин и числа ребер (в нашем случае - единице). .,.
     Объединив формулировки теоремы 9 и следствия 2, получим следующее
утверждение: лес является деревом тогда и только тогда, когда число его ребер на 1
меньше числа вершин.

Следствие 3. В дереве,   которое содержит па меньшей мере две вершины, не менее двух
висячих вершин.

-<111 Пусть в дереве n � 2 вершин:    v1 ,   • • •   Vn , тогда оно содержит т = n - 1   ребро.
По лемме о рукопожатиях
                           p(vt) + . . . + p(vn) = 2m = 2(n - 1).
Можно считать, что вершины упорядочены по их степеням:
                                p(v t ) � p(v2) � . . . � p(vn) ·
Докажем, что p(v1) = p(v2 ) = 1 . Предполагая· противное, легко получить проти­
воречие: если р(v2 ) > 1 , т. е. р(v2) � 2, то
    2(n - 1) 1= p(v t ) + p(v2 ) + . . . + p(vn) � 1 + (n - 1)p(v2 ) � 1 + 2(n - 1 ) . .,.
     Из следствия 3 вытекает
                           ,.




Следствие 4. В лесе,   содержащем хотя бы одно ребро, не менее двух висячих вершин.

     Теорема 9 мЬжет быть обращена следующим образом.

Теорема 1 0. Пусть в связном графе числа ребер на 1 меньше числа вершин. Тогда этот
граф - дерево.

-<111 Пусть в графе G n вершин, т = n   1 ребер. По теореме 2 в простом графе
                                                     -


т � n - k, где k - число компонент связности. Для рассматриваемого графа k = 1
и имеет место равенство т = n - k. Отсюда ясно, что граф является простым,
так как в противном случае удалив все петли и (лишние) кратные ребра (сделав
граф простым), мы уменьшили бы m , не меняя при этом n и k , что привело бы
к нарушению упомянутого неравенства. Итак, граф G          простой и для него
                                                                      -


т = n - k . Удаление любого ребра графа приведет к нарушению неравенства
т � n - k, если при этом не изменится число компонент ·связности k ; поэтому
удаление произвольного ребра изменяет k , то есть каждое ребро графа есть мост,
в силу чего (по теореме 8) G ациклический граф. Так как при этом G по условию
                                -


связный граф, G - дерево. Теорема доказана. .,.
1 16   ______                                         Глава LXX. Введение IТеоРмю rрафов


           Граф является деревом тогда и только тогда, когда любые две его вершины
Теорема 1 1 .
соединены ровно одной простой цепью.

.,... Необходимость. Пусть G    дерево. Тогда G
                                    -             -связный граф, и любые две
его вершины соединены простоit цепью (§ 2), при этом двух различных цепей
с таким свойством не может быть, так как их объединение дает цикл, в то время
как в дереве циклов нет.
       Достаточность. Если в графе любые две вершины соединены цепью, то, как
известно, граф является связным. Ацикличность графа также очевидна: если бы
в графе был циКЛ , то любые две вершины этого цикла соединены по меньшей
мере двумя простыми цепями. �

Теорема 1 2. Лес является деревом в том и только в том случае, когда добавление
любого ребра приводит к образованию ровно одного цикла.

.,... Пусть ациклический граф связен. В силу теоремы 1 1 любые две вершины и и v
соединены ровно одной простой цепью. Поэтому добавление ребра иv приводит
к образованию цикла, причем ровно одного, так как если бы их образовалось
хотя бы два, то объединяя соответствующие «участки>> этих циклов, можно бьmо бы
построить цикл, не содержащий ребра uv , что противоречило бы ацикличности
исходного графа.
       Обратно. Если при добавлении ребра иv образуется цикл, то удаляя из этого
цикла ребро uv , мы получим цепь, связывающую вершины и и v , значит, любые
две вершины графа связаны, т. е. граф связен и является деревом (так как по уело-          ·



вию он ациклический) . ..,..


§ 7 . Теорема Кэли о ч и сле помеченных деревьев
Обозначим через Pn число помеченных деревьев с n вершинами. Ясно, что
Pt ::::= Р2 = 1 . Помеченное дерево с тремя вершинами полностью определяется
своей центральной вершиной, поэтому Рз = 3 . Если в дереве 4 вершины, то
щю представляет собой либо полный двудольный граф К1 ,3 , либо простую ( неза­
мкнутую) цепь длины 4. Первого типа имеется 4 различных помеченных дерева,
а второго - 12 (С� · 2); крайние вершины цепи выбираются С� способами, после
чего для нумерации двух оставшихся вершин остается две возможности; таким
образом, Р4 = 4 + 1 2 = 16 . Дерево с 5 вершинами имеет один из трех видов,
представленных на рИс. 17.



                •   •   •   •   •




                                        Рис. 17
01• TeopeNa КЭJiи о числе nомеченных дерев�аев ------ 1 17

       Количество деревьев типа «Цеnь» равно 'С� · З!  60, типа К1,4 - 5. ПроизволЪ­
ное дерево третьего типа оnределяется пометками вершин        а , Ь, с (см . обозначенИя
на рисунке); поэтому их число равно А� = 60. Итак, Р5        60+ 5 + 60 = 125. После­
                                                                               n 2
довательность 1 , 1 , 3, 16, 1 25 может быть задана соотношением Pn = п - • Коли­
чество помеченных деревьев с 6 вершинами также нетрудно подсчитать «вручную»
(читателю рекомендуется выполнить это полезное упражнени е), после чего вы­
сказанная гипотеза получит новое подтверждение. И в общем случае имеет место


Теорема 13 (А. Кэ.nи, 1 897 r.).   Число помеченных деревьев с n1 вершинами равно           пn-z.


       Существует много способов доказательства этой знаменитой теоремы. Мы
приведем не самое богатое в идейном плане, но, возможно, самое простое
доказательство.
       Покажем, что существует взаимно однозначное соответствие между множе­
ством помеченных п-вершинных деревьев и множеством размещений с повторе-
ниями из n элементов по n - 2; поскольку ·А� -2 п11- 2 , это будет доказывать
теорему. Сопоставление дереву упорядоченного набора (называемого              кодом Прю­
фера) (а 1 , а2, . . . , ап-2) (где для каждого i ai { 1 , 2, . . . , n}) будем называть
                                                                Е
кодированием дерева (или кодировкой), а обратный процесс (получения по указан­
ному набору дерева) - декодированием (или декодировкой).
      Кодирование дерева выполняется с помощью следующего алгоритма.
  1 . Положить i = 1 .
  2 . Пуст!: Vi - висячая вершина дерева с наименьшей меткой; тогда· ai - метка
       смежной с ней вершины.
  3.   Удалить из дерева. вершину щ и инцидентное ей ребро. Если в дереве осталось
       более двух вершин, увеличить        i   на    1   и перейти к n.   2,   иначе - закончить.
Очевидно, что разные деревья имеют разные коды.
      Декодироаание дерева. Пусть В0 = { 1 , 2, . . . , n}, а Ь1          наименьшее число
из  В0 , не встречающееся в наборе (а1 , , а11_ 2) . Тогда Ь1 - номер висячей вер­
                                                    • • •


шины , смежной с. а 1 , и дерево содержит ребро ( Ь 1 , а1 ) .
       Набор (а2, . . . , ап - 2 } коди:рует .дерево Т1 с множеством пометок В 1 = BQ \ {Ь t }
(Т1 получаетел из Т удалением вершины Ь1 и инцидентнога ей ребра (а1 , Ьt)) .
       В качестве Ь2 возьмем наименьшее число из В1 , не встречающееся в после­
довательностtt: (а2,    • • •
                              , ап -2) . Дерево Т1 (значит, и Т) должно содержать ребро
(�, а2 ) . Теперь набор (а3 ,           , an - 2) описывает дерево Т2 с множеством пометок
в2 = в, \ { �}. и так далее.
                                   • • •




       На k -м шаге процедуры рассматривается дерево Т�:-1 с множеством пометок
Bk - t · В множестве Bk -l выбирается наименьшее число ( Ьk ) , не входящее в набор
(ak , . . . , an- 2) , после чего констатируется наличие в дереве Т ребра ( Ьk , а�;) . После
n - 2 шагов будут выявлены n - 2 ребра дерева Т ; при этом множество Bn-2 будет
содержать два числа - пометки вершин nоследнего, (n- 1)-ro, ребра, включаемого
в дерево. (дерево Tn_-2 , содержащее две вершины, строител однозначно , и поэтому
не нуждается в кодировке.)
       Осталось еще убедиться в том, что полученный после декодирования граф
действительно является деревом.           В самом деле, граф Tk-1 получается из графа Tk
добавлением ребра       ( Ьk , ak) , nричем вершина Ьk не nринадлежит графу Tk . Поэтому
1 18   -------                                                                     Глава LXX. Введение в �10 rр'афов
                                                           Таблица 1

        k

        о             { 1 , 2, 3, 4, 5, 6, 7, 8}                       (2, 4, 1, 2, 4, 4)
        1               ,{ 1 . 2, 4, 5, 6, 7, 8}                        (4, 1, 2, 4, 4)                   (3, 2)
        2                { 1; 2, 4, 6, 7, 8 }                              ( 1 , 2, 4, 4)                 (5, 4)
        3                  { 1 , 2, 4, 7, 8}                                (2, 4, 4)                     (6, 1)
        4                    {2, 4, 7, 8}                                     (4, 4)                      ( 1 , 2)
        5                     {4, 7, 8}                                         (4)                       (2, 4)
        6                       {�, 8}                                                                    (7, 4)
        7                                                                                                 (4, 8)


из ацИкличности Tk следует ацикличность Tk-I · Поскольку Т�-2 - дерево, то де-
ревьями являются и графы Тn-з     , Т2, Т1 , Т.•
                                                6  . . .
                                                                            7
       Пример. Дерево; изображенное на рис. 1 8 , име­                                          2           4
       ет код (2, 4, 1 , 2, 4, 4) .
            По коду (2, 4, 1 , 2, 4, 4) восстановим де­
       рево. Процесс декодировки отражен в табл. 1 .
                                                                                       3                             8
            Как и следовало ожидать, получено де­
       рево, закодированное выше.                                                               Рис. 18


§ 8. Стягива ющие деревья
Стягивающим (или остовным) деревом связного графа G называется произвольный
его подграф, содержащий все вершины G и являющийся деревом.
     Остовным лесом графа G называется произвольный его подграф, содержащий
все вершины G и являющийся лесом. Таким образом, компоненты связности
остовнога леса графа G являются стягивающими деревьями компонент G.
     Построить остовный лес нетрудно : достаточно последовательно удалять
из графа ребра, входящие в циклы, до тех пор, пока не будет построен ацикличе­
ский граф (лес), который, очевидно, будет остовным для исходного графа.
     Граф называется взвешенным, если каждому его ребру l поставлено в соответ­
ствие неотрицательное число p.(l) (вес ребра). Весом графа G = (V, Е) называют
сумму весов всех его ребер:
                                               p.(G) = L: p. (l) .
                                                               IEE
       Рассмотрим следующую задачу. Имеется  пунктов. Для любой пары пунктов
                                                                       n
i и j известна стоимость сооружения дороги между ними   Cij . Требуется выбрать             -


сеть дорог такую , чтобы любые два пун,кта соединялись каким-либо маршрутом
и при,этом стоимость ее сооружения была наименьшей.
    §В;   CrнriiiiiiiOЩИe деревья   --------'-- 1 19

        Если рассмотреть полный граф nорядка n , вершины которого будуг соответ­
    ствовать указанным (географическим) пунктам, а ребра будут иметь вес, равный
    стоимости сооружения дороги между соответствующими пунктами, то на язь1ке
    теории графов данная задача будет формулироваться так: в данном графе найти
    стягивающее дерево наименьшего веса. Отметим, что согласнр теореме Кэли в пол­
    ном графе Kn имеется n11- 2 различных стягивающих деревьев, и, в принципе,
    рассматриваемая задача может быть решена перебором по всем таким деревьям.
    Ясно, однако, что с прак:тической точки зрения подобный алгоритм решения
                                t
    не выдерживает никакой критики. Сутествуют эффективные алгоритмы нахо-
    ждения стягивающего дерева минимального веса в связном взвешенном графе.
    При описанци следующих алгоритмов G = (V, Е} будет обозначать исходный
    граф, а Т = (V, Р) искомое дерево.
    Алгоритм Д. Краекала ( 1 956 г. )
      1 . Положить Р = 0 , n !E i . Следующий шаг выполнять n 1 раз.     -



      2. Включить в Т ребро графа G наименьшего веса, обладающее тем свойством,
          что при добавлении его в графе Т не образуется циклов. Исключить из G
          данное ребро.

                                                5   4



                              ;1S(lJ2       7
                                                        Рис. 19

       На рис. 19 изобJХUКены взвешенный граф (числа nоказывают веса соответству­
    ющих ребер) и стягивающее дерево, полученное ,в результате работы алгоритма.
    Обоснование корректности алгоритма Краекала
    Заметим сначала, что в результате работы алгоритма строится стягивающее дерево
•   исходного графа (граф Т ациклический по построению и в нем число ребер на 1
    меньше числа вершин, поэтому в силу следствия 2 из теоремы 9 он является
    деревом). Пусть Р {е 1 , е2 , • • • , е 11- 1 } (будем считать, что ребра заnисаны <<В по­
    рядке поступления»), а S (V, М) - произвольное стягивающее дерево исходного
    графа. Нужно доказать, что p,(S) � JJ(T). Если S =f. Т, то Р =f. М и сутествует
    такое k , что е 1 , еъ . . . , е�: - 1 Е М, е,. � М. Добавим к дереву S ребро ek , при этом
    образуется цикл, обозначим его С. В цикле С найдется ребро е , nринадлежащее
    множеству М и не входЯщее в Р . Удалив это ребро, получим граф 81 = (V, М1 ) ,
    где М1 = М U {е,.}\{е}. Этот граф связен и в нем ребер на единицу меньше,
    чем вершин. По теореме 1Q граф 81          дерево. Сравним веса деревьев S' и S:
                                                        -



    JJ(S') = JJ(S) + JJ(e�:) р,(е) . Так как в силу алгоритма Краекала JJ(e�:) � р(е ) ,
                                        -


    имеем p,(S1) � p,(S) . Итак, в дереве S' по сравнению с деревом S число ребер,
    общих с деревом Т, на 1 больше, nричем вес S' не больше веса S. Указанную
    процедуру будем повторять до тех nop, пока не получим дерево Т. В результате
    будет построена nоследовательность деревьев S, 81 , S", . . , Т, в которой каждое
                                                                    .
1 20 ------- Гпава LXX. Введение в теорию rрафов

nоследующее дерево имеет вес, не больший, чем nредыдущее:
                                         '



                          p(S) ;;:::. p(S') ;;::: p(S")      ;;:::   . . . ;;::: р (Т),
откуда и следует требуемое: p(S) � р(Т) .
Алгоритм Р. Прима ( 1 957 r.)
Данный алгоритм nохож на алгоритм Краскала; основное различие состоит в том,
что в этом алгоритме строится «разрастаюшееся;} дерево, более точно: nоследова-
тельность деревьев
                                   81 С 82 С   С Sn, • · ·




где дерево Si (Vi, Ei } содержит i вершин (i 1 , . . . , n).
  1. Пусть Vj = {х1 } , где х1 E 'V - nроизвольная вершина G, Е1 = 0. Следующий
      шаг выnолнять для i 2, . . . , n .
  2 . Получить дерево Si и з дерева Bi-l добавлением ребра графа G наименыиего
      веса (среди тех ребер , nри добавлении которых к Bi-J вновь образуется
      дерево). Исключить из G данное ребро.
Обоснование корректности алгоритма Прима такое же, как и алгоритма Краскала.
      Сравним трудоемкость оnисанных алгоритмов для графа с n вершинами и т
ребрами. В nервом из них основные затраты времени nадают на сортировку ребер
no их весу; известно. что для выnолнения сортировки т объектов требуется


1* n ;;::: 2 .- число вершин графа ; *1
1 * V = {x J , . . . , xn} - множество вершин ; *1
1 * v;. - миожество вершин , еще н е вхJIЮчеи:е:ых в дерево ; * 1
1 * Е8 - множество ребер с:rроя:щегося: дерева ; * 1
v;. = V \ {xJ }; E8 = 0 ;
f* Р..;,сста:е:овха началь:а:ых пометох * 1
                                     '
for ( Xi Е Vr )
    i f ( х1 и :z:1 смеж:в:ы) { ai х 1 ; Ьi = p(asxi) ; } ;
    else {at = О; Ьi       оо} i
1 * k - nоря:д.ковыi: номер ребра , вх.пючаемоrо в дерево * 1
for ( k = 1 ; k < n; )
{
    1*  оnреnеле:е:ие но�оrо . ребра * 1
    Ьi' = min Ьп
          Z;EV,.
    Es = Es U { ai• , Xi• } ;
    v;. = v;. \ { Xj• } ;
    1*   nересчет поме:rох   *1
    if ( + + k < n)
      for (Xi Е v;. )
           if ( :z:i смепо с Xi•   и   p (:z:iXi• ) < Ьi) { Ьi = p (:z:i, Xi• ) ; ai
}

      Рис. 20. Алrоритм Прима нахождения стягивающего дерева нанменьшего веса
§9. Фундаментальная система циклов      -------                                                             121
                                                   Табnица 2

     щаr                1                      2                     3             4                 5
      Vr        {х2 , . . . , хб}       {хз, . . . , хб}       {х4, Xs , хб}   {х4, xs }          {х4}
   [а2 , Ь2J        [х1 , 4)                  -                     -             -                 -



   [аз, ЬзJ         [x, , 4J                [х2, 3 ]                -             -                 -



   [а4, Ь4 ]        [0, оо]                 [0, ooJ               [хз , 7)      [хб, 3 )          [xs, 2]
   [as, Ьsl         [0, оо]                 [0, оо]               [О, оо)       [х6 , 1 ]           -



   [а6 , Ьб ]       [х, , 5 )               [х1 , 5]            . [х1 , 5]        -                 -




   min b;              ь2                     Ьз                    ь6            Ьs                ь4
   новое
   ребро           , х1х2                   Х2Хз                  х,хб           X6Xs             XsX4

порядка т log2 т операций сравнения. Во втором алгоритме на i-м шаге среди
n - i вершин, еще не вклю.ченных в дерево, нужно выбрать·ту, чье «ПОДКЛЮЧ@_НИе>>
к дереву обойдется наиболее «дешево» (ребро, соединяющее новую вершину
с одной из «старых», должно быть наименьшего веса); для этого требуется порядка
n-i- 1 операций. Суммируя по i , получим оценку трудоемкости алгоритма Прима:
O(n2 /2) операций сравнения. Понятно, что для полных графов (где число ребер
      n(n -1)
т=-      2 - ) алгоритм Прима менее трудоемок, чем алгоритм Краскала;
     Опишем эффективную реализацию алгоритма Прима. На каждом шаге ал­
горитма каждой вершине Xi , еще не включенной в дерево, соnоставляется по­
метка - пара чисел [а;, Ьi] , где Ьi - наименьший вес ребра, соединяющего Xi
с какой-либо вершиной, уже включенной в дерево, ai - номер соответствующей
вершины. Таким образом, Ьi = J.д(xia;). Шаг алгоритма
состоит в выборе Ьi' = min(Ьi) и добавлении к дере­
ву ребра ai•Xi• . На рис. 20 дан набросок программной
реализации алгоритма (с использованием конструкций
языка программирования Си) .
      Пример.  Работа алгоритма дпя графа, изображенного на
      рис. 21, показана в табл. 2.                                                      Рис. 21


§ 9 . Фундаментальная с истема циклов
Термин фундаментальная система (решений) используется для обозначения базиса
в пространстве решений системы линейных однородных (алгебраических) уравне­
ний, либо в пространстве решениИ однородного дифференцИального уравнения.
В каждом из этих случаев через элементы фундаментальной системы оказывается
возможным выразить, и при том единственным образом, элементы некоторого
бесконечного множества. В (конечном) графе число циклов конечно, но может
быть достаточно велико (по сравнению с порядком графа) . Например, в полном
графе Kn можно указать              #
                           = 2(n��)!k различных циклов 8) длины k ( k = 3, , n),                   . . .




   8) В :лом nараграфе мы будем отождествлят1> цикл с множеством ero ребер.
122   __   ...;__________________                            Гпава LXX · Введение в теорию графов
                                                                      •
                                                                      .




представляющих собой простые замкнутые цепи, а общее количество таких Ц.!fК­
лов имеет порядок (n - 1)!. Поэтому задача выражения всех циклов графа через
некоторые фиксИрованные циклы достаточно интересна; о практическом прило­
жении решения такой задачи будет упомянуто в конце параграфа.
    Поговорим сначала об операции, позволяющей по одним циклам получать
другие.
9. 1 . Симметрическая разность множеств
Симметрической разностью множеств А и         В называют множество
                               А 6. В = (А U В) \ (А n В).
Операция нахождения симметрической разности коммутативна: А 6. В = В 6. А
(это очевидно) и ассоциативна: (А 6. В) 6. С = А 6. (В 6. С). (попробуйте доказать
это с помощью рис. 22). В силу ассоциативности при записи симметрической
разности нескольких множеств скобки (указывающие порядок выполнения данной
операции над множествами) можно не расставлять. .

                                                   А                      в

                 А                    в




                          А�В                    (А � В) � С = А � (В � С)
                  Рис. 22. Симметрическая разность двух и трех множеств

    Пусть А - Произвольное множество. Множе�тво всех подмножеств А с опера­
цией симметрической разности (,В(А), 6.) образует коммутативную группу; в роли
нейтрального элемента группы выступает пустое множество, каждый элемент
группы является обратным самому себе.

Лемма 3.   При произвольнам натуральном n симметрическая разность                 n   множеств
                                           . :
                                11

                               6. Ai = А1 6. А2 6. . . . 6. An
                               i=l
состоит в точности из тех элементов данных множеств, которые принадлежат
нечетному их числу.

<1111 Доказательство nроводится индукцией по числу множеств. База индукция оче­
видна.
       Индукционный шаг. Пусть доказываемое утверждение справедливо для всех
n � k. Симметрическая разность k + 1 множеств имеет вид В = В 1 6. В2 , где
В1 = А1 6. . . . 6. Ар . В2 = Ар+1 6. . . . 6. Ap+q • причем р, q � k, p + q = k + 1 . Множе­
ство В состоит из элементов, принадлежащих В1 (значит,по индуктивному пред­
положению, принадлежащих нечетному числу множеств из А1 ,                     , Ар) и не при­
                                                                          • • •



надлежащих В2 (то есть входящих в четное число множеств из Ар+ 1 ,                      , Ap+q)
                                                                                       • • •
§9. Фундаментаnь111t система циКJ\01   -------�-                                                   123

или, наоборот, не принад:rtежащих В1 и принадлежащИХ В2 (т. е.                            принадле­
жащих четному числу множеств из А 1 ,            Ар и нечетному числу
                                                     • • •   ,                            множеств
из Ар+ 1 , • • •   , Ap+q). В любом случае множество В составляют те и                    только те
элементы, которые входят в нечетмое число множеств из данных k + 1                        множеств:
А 1 , . . . , Ak+ I · Лемма доказана. ..,.
9.2. Псевдоцмкпы
Симметрическая разность двух ·циклов в графе в общем случае не является циклом.
Множество ребер С С Е графа G = (V, Е) назовем псевдоциклом, если в графе
{V, С) каждая вершина имеет четную степень. (Обычный) цикл графа и nустое
множество - примеры псевдоциклов. Оказывается, множество всех псевдоциклов
графа за�кнуто относительно симметрической разности.

Лемма 4.Для любого натурального n симметрическая разность                    n   псевдоциклов есть
псевдоцик:л.

<11111
   Доказательство ведется: индукцией по n . База индукции (утверждение для
  = 1 ) очевидна. Обоснование индукционного шага сводится к рассмотрению
случая двух псевдоциклов. Пусть С1 и С2 - псевдоциклы. Для nроизвольной
n


вершины v графа обозначим через si (11) множество ребер цикла ci ' инцидент­
НЪIХ v (i = 1 , 2). Степени вершины v в графах {V, С1 ), {V, С2) , {V, С1 !::. С2 } равны
мощностям множеств S1 (v), S2(v), 81 (v) !::. 82(v) соответственно. Из определения
симметрической разности и с помощью формулы мощности объединения двух
множеств получаем:
 IS1 (v) l::. S2(v)l = ISI (v) U S2(v)I - ISt (v) n S2 (v)l = ]SI (v)l + IS2(v)j - 2]SJ (v) Г1 S2(v)] .
Из четности I S1(v)l и IS2(v)] вытекает четность ISI (v) l::. S2(v)1. Лемма доказана. ..,.
    Обсудив некоrорые «технические» моменты, мы можем теnерь заняться ос­
новным вопросом данного параrрафа.
9.3. Фундаментальнаg система циклов
Пусть G = (V, Е) - связный граф, (V, Т}     ero стягивающее дерево. Если
граф G содержит n вершин, то в Т    n 1 ребер. Если к стягивающему дереву
                                              -      -




                                Граф G      (V, E}               Дерево (V, Т}




                           Рис. 23. ФундаменТ8ЛЪная снетема циклов
1 24 --------�- Гпава LXX. Введение. в теорм� rрафов

добавить произвольное ребро е Е Е \ Т, то (по теореме 1 2) образуется ровно один
цИкл, обозначим его Се . Множество всех циклов такого вида {Се 1 е Е Е \ Т}
будем называть фундаментальной системой циклов графа G = ( V, Е) относительно
стягивающего дерева (V, Т) . Пример см. на рис. 23.

          Произвольный цикл С связного графа G = (V, Е) представим в виде
Теорема 14.
симметрической разности некоторых циклов из фундаментальной системы циклов G
относительно любого стягивающего дерева ( V, Т) . Такое представление единственно
и имеет вид:
                                С = 6. Се.                                    (1 )
                                     е ЕС\Т

     Мы докажем даже более сильное утверждение, считая С псевдоциклом.
� Пусть G = (V, Е) - связный граф, ( V, Т) - некоторое фиксированное стяги­
вающее дерево G . Ребра этого дерева будем называть ветвями, а остальные ребра
графа G - хордами. Заметим, что каждый цикл Се содержит ровно одну хорду,
а именно - е . Поэтому в симметрической разности (различных) фундаментальных
циклов, равной С, должны присутствовать все циклы, отвечающие хордам из С\Т,
и только они. Таким образом, .если представление псевдоцикла С в виде симметри­
ческой разности фундаментальных циклов существует, то оно единственно' и име­
ет вид (1). Докажем теперь, что равенство (1) действительно имеет место. Пусть

                                  В=    6_
                                       е ЕС\Т
                                                Се .

По лемме 4 В . - псевдоцикл; к�к уже показано, из хорд В содержит только хорды,
принадлежащие С. Применяя леммы 3 и 4, получаем, что симметрическая разность
В 6 С - псевдоцикл, не содержащий хорд (так как каждая хорда одновременно
либо принадлежит, либо не принадлежит В и С, т. е. число ее вхождений в данные
два множества четно) ; стало быть, В 6 С С Т. Осталось доказать, что в В 6 С нет
и ветвей. Действительно, если подграф дерева не пуст, то согласно следствию 4 тео­
ремы 9 он имеет не менее двух висячих вершин, в то же время - по определению
псевдоцикла - он не содержит висячих вершин. Итак, мы выяснили: В 6 С = el ,
что равносильно совпадению множеств 13 = 6_ Се и С . Теорема доказана. �
                                              е ЕС\Т
     На множестве всех псевдоциклов связного графа можно ввести структуру
линейного пространства над полем GF(2) , где в роли «сложения>> выступает
симметрическая разность, а умножение на скаляр определяется естественным
образом - для произвольнога псевдоцикла С имеем: С 1 = С, С · О = е1
                                                             ·



(здесь через О и 1 обозначены элементы поля GF(2) ; напомним, что в этом поле
О + О = 1 + 1 = О, 1 + О = 1 , О · 1 = О · О = О, 1 1 = 1). Как показано выше,
                                                       ·


базисом в данном линейном пространстве будет фундаментальная система циклов
относительно любого стягивающего дерева.
     Вьщеленtt:е фундаментальной системы циклов находит применение при ана­
лизе электрических цепей. Если электрической цепи сопоставить граф, ребра ко­
торого соответствуют источник.щ ЭДС, сопротивленцям, цндуктивностям и т. д.,
а вершины - узлам соединений элементов цепи, то при использованци закона
§ 10. Укnwи rрафов   ------ 1 25
Кирхгофа для напряжений, гласящего: сумма падения напряжений вдоль цикла
равна нулю, необходимо найти фундаментальную систему циклов. Уравнения,
отвечающие этим циклам, не будуг зависеть друг от друга, в то же время их вы­
полнение будет гарантировать выполнение уравнений для всех циклов графа.


§ 1 0. Укладки графов
Один и тот же граф можно изобразить по-разному. На рис. 24 nредставлены два ва­
рианта изображения полного rрафа К4 • В первом случае отрезi<И., сооТветствующие
ребрам графа, пересекаются, а во втором случае     нет. При решении ряда задач
эта разница является принципиальной. на.:.
пример, при изготовлении микросхем печат­
ным способом электрические цепи наносят­
ся на плоскую поверхность изоляционного
материала;. при этом проводники не должны
пересекаться. Менее глобальный пример -                     Рис. 24
задача о трех домиках и трех колодцах. Хозяе­
ва трех соседних домиков хотят проложить дорожки к трем колодцам (от каждого
домика к каждому lСОЛодцу) таlС, чтобы дорожки не пересекмись. Удастся ли им
осуществить свое намерение?
     Перейдем к определениям. Жордановой кривой называют непрерывную кри­
вую без самопересечений. Плоским графом назовем граф, вершины которого -
точки плоскости, а ребра      жордановые кривые (лежащие в той же плоскости),
соединяющие соответствующие вершины так, что никакие два ребра не имеют
общих точек, за исключением инцидентной им обоим вершины. Граф будем
называть планарным, если он изоморфен пекоторому плоскому графу. Примеры
планарных графов: К4 , Cn, Wn (для любого n ) . Задачу о домиках и колодцах
теперь можно сформулировать так: планарен ли граф Кз,з ? Отметим очевидные
свойства маиарных графов:
  1. Любой подграф планарного графа является планарным.
  2. Граф является планарным тогда и только тогда, когда тем же свойством
     обладает каждая его компонента связности.
Про планарный граф говорят также, что он имеет плоскую уклад1еу, или уклады­
вается в nлос�Сость. Более общее определение: граф укладыtтется в множество L,
если его вершины можно и;зобразить точками из множества L, а ребра - жордано­
выми кривыми, лежащими в L и ,имеющими общими только точки, изображающие
соответствующие вершины гр �фа. В последующих рассуЖДениях мы часто будем
отождествлять граф и его укладку - «изображение» графа в каком-либо множестве.

Теорема 1 5.   Любой г�аф укладывается в R.З .

<111 Вершины графа будем изображать точками некоторой прямой l. Рассмот­
рим пучок плоскостей, проходящих через данную прямую. Каждому ребру графа
сопоставим некоторую плоскость данного пучка так, чтобы разным ребрам со­
ответствовали разные плоскости. Ребра будем изображать кривыми с концами
1 26   ------                                             Гпuа LXX. Введение в теорию rрафов

в соответствующих вершинах и лежащими в соответствующих плоскостях, при
этом для изображения петель будем брать окружности, касающиеся l , а для
остальных ребер - полуокружности. Ясно, что данная · конструкция дает требуе­
мую укладку графа. ..,.

Теорема 1 6.    Граф является планарным тогда и только тогда, когда он укладывается
на сфере.                                                          '




� Необходимость. Имея укладку графа на сфере, выберем на сфере точку N так,
чтобы она не совпадала ни с одной из вершин и не лежала ни на одном из ребер.
Через противоположную точку сферы проведем к ней касательную плоскость а
и осуществим стереографическую проекцию сферы на данную плоскость с центром
в точке N: каждая точка Т сферы проецируется в точку пересечения луча
NT с плоскостью а . При данном отображении жордановал кривая на сфере
переходит в жордановую кривую на плоскости. Стереографическая проекция
устанавливает взаимно .однозначное соответствие между сферой с выколотой
точкой N и плоскостью; nоэтому граф, nолученный при проектировании, -
плоский (его ребра имеют общие точки только в соответствующих вершинах)
и изоморфен исходному графу, который, таким образом, ямяется планарным.
    Достаточность доказывается обратным ходом рассуждений. ..,.


§ 1 1 . Формула Эйлера
Связным множеством (на плоскости) называется такое множество, любые две точ­
ки которого !>fОЖНо соединить жордановой кривой, целиком лежащей в данном
множестве. Примеры связных множеств: многоугольник, круг, кольцо. Пример
несвязного (т. е. не являющегос.э: связным) множества: объединение двух непересе­
кающихся кругов. Грань плоского графа - связная часть плоскости, ограниченная
ребрами графа и не содержащая внутри себя других ребер. Среди всех граней графа
ровно одна является неограниченной, ее называют внешней. Граф, изображенный
на рис. 25 а, имеет три грани, внешняя грань помечена цифрой 3. У плоского
ациклического графа только одна грань - внешняя. Заметим, чть планарный граф
можно так изобразить на плоскости, что внешней будет любая его наперед заданная
грань. Вот как это можно сделать. От nроизвольной плоской укладки данного
графа следует перейти к сферической (проектируя плоскость вместе с плоским
графом на какую-либо сферу, касающуюся плоскости); далее осуществить стерео­
графическую проекцию с центром во внутренней точке выбранной грани, при
этом данная грань перейдет во внешнюю грань полученного плоского графа.
На рис. 25 приведено три варианта плоской укладки одного и того Же графа.

Теорема 17 (Л. Эйлер, 1 758   г.). Для любого связного плоского графа справедливо соот­
ношение
                                       n-m+      f = 2,                                 ( 1)
где n , т , f   -
                    число вершин, ребер, граней соответственно.'
§ 1 1 . Фopмyna 3inepa �.------ 127




                             а)                 б)                     в)
                                  Рис. 25. !Рани плоского графа

"111 Пусть G = (V, Е) - nроизвольный связный моекий граф с n вершинами,
т ребрами н f гранями. Рассмотри м его стягивающее дерево Т {V, М) . Оно
имеет n вершин, n - 1 ребер и одну грань - равенство ( 1) для Т выполняется.
Будем nоследовательно добавлять к графу Т «недостающие» ребра графа G
(то есть ребра из множества Е \ М). При добавлении одного ребра число граней
также 'увеличивается на единицу, так как новое ребро делит грань, на границе
которой лежат его вершины, на две грани; таким образом, после каждого шага
предложенной процедуры соотношение              ( 1)   для графа   Т   остается верным. После
добавления      т-n + 1 ребер граф Т nерейдет в граф G , для которого равенство ( 1),
таким образом, также сnраведливо. 111>
                                                                                              ·




С.nедствие 1 (форму.nа Эй.nера дт1 eыnyiUIЫX многоrранникое).   Пусть в вьтуклом многогран­
нике n вершин,     т ребер и f граней. Тогда n - т + f 2.
"111 Поместим выnуклый многогранник внутрь некоторой сферы                   S   и спроектиру­
ем многогранник на       S   из какой-либо его внутренней точки. Проекции вершин
и ребер многогранника будут вершинами и ребрами некоторого графа, уложен­
ного на сфере. Как показывает теорема           16,    такой граф является : манарным; для
его плоской укладки выnолняется требуемое соотношение меЖдУ числом вершин,
ребер и граней. Осталось заметить, что композиция двух преобразований
рование многогранника на сферу IUIIOC переход от сферической укладки к моской )
                                                                                       (nроекти­

задает взаимно однозначное соответствие меЖдУ вершинами, ребрами, гранями
многогранника и вершинами, ребрами, гранями связного плоского графа. 111>


С.nедстеие 2. Число граней f плоского графа определяется формулой f = т + k-n+ 1 ,
где   т, n обозначают то же, что и выше, а k - число компонент связности графа.
"111 Число граней i -й компоненты связности плоского графа выражается формулой
/i тi - щ + 2 (тi, ni число граней и ребер i - й комnоненты; i l , . . . , k).     =

При суммировании /i · по i о т 1 д о k внешняя грань графа будет учитываться
k раз, поэтому
                     k                   k
                / = l: fi - k + I I: (тi - ni + 2) - k + 1 =
                    i=l            i=l
                                 = т - n + 2k - k + 1 = т - n + k + 1 ,
что и требовалось доказать. 111>
1 28   ------                                             1'!18118 LXX. �ме 1 теорм10 rрафов


Следствие 3. Для любого простого связного планарного графа с      n � 3 вершинами и т
ребрами выполняется неравенство т � 3n - 6.

<111 Рассмотрим какую-нибудь плоскую укладку рассматриваемого графа. Если
в графе всего два ребра, то выполнение неравенства проверяется непосредственно;
поэтому будем считать, что     т � 3.Пусть у (плоского) графа f граней, а i-я грань
ограничена      ребрами (i = 1 , . . , f). Поскольку в рассматриваемом графе нет
               тi                  .



петель и кратных ребер, . а ребер не меньше то V i3,       тi � 3
                                                              и
                                         f
                                        L: тi � 3 /.
                                        i=l
Если ребро графа является мостом, то оно входит в границу только внешней
грани, в противном случае ребро входит в границу ровно дВух граней. Значит, при
вычислении суммы 2:
                        i тi
                         каждое ребро графа учитывается не более двух раз и
                                        f
                               L: mi � 2m.
                               i =l
Следствием полученных оценок для 2: mi является неравенство 3 f � 2m, или,
с учетом формулы Эйлера; 3 ( m n + 2) � 2m, откуда т � 3n - 6. _.
                                   ·




Следствие 4.   В любом простом планарном графе есть вершина степени не больше 5.

<111 Достаточно доказать утверждение для простого плоского связного ·графа
G (V, Е) , в котором число вершин больше               6.
                                               Испольgуя предыдушее след-­
ствие (вместе с его обозначенияМи), имеем:         т � 3n 6.
                                                     Предположим противное
тому, что требуется доказать: V Е V р(щ)
                                  Vi                � 6;
                                              тогда, применяя лемму о руко­
пожатиях, получим:
                                             n

                            2m = L: р(щ) � 6n,
                                  i=l
или т � 3n, что противоречит следствию 3. _.

Следствие 5.   Граф К5 не является планарным.

<111 Действительно, в полном графе Ks    5 вершин й
                                                 n=        С�     т=
                                                                  10 ребер;  =
неравенство следствия не выполняется - стало быть, граф К5 не планарен. _.
                          3
Следствие 6.   Граф К3,3 не является планарным.

<111 В полном двудольном графе Кз,з          n = 6 вершин и т = 9 ребер; если бы этот
граф был Планарным, то его плоская             укладка содержала бы f  т- n+2 = 5
§ tЗ. Ориентированные rрафы   ------- 1 29
граней. Используя обозначения, введенные при доказательстве следствия 3, полу­
чим: 2: mi = 2m = 1 8 . С другой стороны, легко видеть, что в двудольном графе
                                                                          .
          j

                                              5
нет циклов длины 3, поэтому каждая грань должна быть ограничена не менее чем
4 ребрами, т. е. 'V i mi :;?; 4, откуда 2: mi :;?; 20. Предположение о планарности
                                             i=l
Кз,з привело к противоречию. ..,...


§ 1 2. Критерий nланарности графа
Подразбиением ребра uv называют его замену на два ребра uw и wv, tде w -
некоторая новая вершина графа. Два графа гомеоморфны, если они могут быть
получены из одного и того же графа с помошью подразбиения ребер. Например,
любые два циклических графа ck и с/ (k, l :;?; 2) гомеоморфны, так как могут быть
получены подразбиением ребер из графа с2 . Другой пример приведен на рис. 26.
Ясно, что гамеаморфные плоские графы имеют одинаковое число граней. Понятие
rомеоморфизма позволяет сформулировать критерий планарности графа.




                                 Рис. 26. Гомеоморфные Графы



                                                       Граф является пл�нарным
Теорема 1 8 (Л. С. Понтрs�гмн, 1 927 г.; К. Куратовский, 1 930 г.).
тогда и толысо тогда, когда он не содержит подграфа, гамеаморфного Ks lfди К3,з .

..с Необходимость. Очевидно, что подразби­
ение ребра никак не влияет на планарность
или непланарность графа; поэтому два rо­
меоморфных графа либо оба планарны, либо
оба непланарны. Непланарность графов К5
и Кз,з доказана в предыдушем параграфе.
     Доказательство достаточности сформу�                     Рис. 27. Ji>aф Петерсена и его
лираванного условия планарности очень гро­                    подrраф, rомеоморфный Кз,з
моздкое; его мы оnустим. ..,...
     Пример. Граф Петерсена не является nланарным - см. рис.          27.


§ 1 3 . О риентированн ые графы
Напомним, что ориентированный граф (сокращенно: орграф) это упорядоченная
пара G = (V, А) , где V - непустое конечное множество   множество вершин;
А     конечное мультимножество упорядоченных пар необязательно различных
элементов V - мультимножество дуг. Основанием орграфа G (V, А) называют
5-233 1
130 ------- Глава LXX .. Введение в теорию графов




                          Рис. 28. Орrраф � его основание

(неориентированный) граф (V, Е) , который получаетСя из G заменой дуг ребрами
(каждая дуга (и, v) заменяется ребром {и, v} ). Пример - на рис. 28. Орграфы
называются изоморфными, если существует изо�орфизм между их основаниями,
сохраняющий порядок вершин на каждой дуте.
      Через Г(v) обозначим множество вершин, к которым ведут дуги с началом
в вершине v : Г(v) = {и Е V 1 (v, и) Е А}. Число таких дут называют полустепенью
исхода вершины v : p(v) = IГ(v) l . Вершину с нулевой полустепенью исхода
называют
    .       стоком.                                                           .
      Через г- 1 (v) обозначим множество вершин, из которых ведут дуги к вершине
v : г- 1(v) = {и Е V 1 ( и, v) Е А} . Число таких дуг называют полустепенью захода
вершины v: {t(v) = IГ - 1 (v)l . Вершину с нулевой полустепенью захода называют
источником.
                                       .
р(v) = +- р (v) + --:+
      Степенью вершины орграфа называют        сумму полустепеней исхода и захода:
                   р (v). Подсчитав двумя способами число дут орграфа (V, А) ,
получим следующее утверждение.

Л емма о рукопожатиих для орграфов


                           I AI = 2: p(v) =       L {l(v).
                                 vEV              vEV
    Вполне очевидным образом переносятся на случай ориентированных графов
такие понятия (извесцrые по предыдущим параграфам этой главы), как смежность
вершин, матрица смежности, простой граф и многие другие. Термин маршрут
заменим термином путь. Итак, путь в орrрафе - Последовательность дуг вида


которую будем записывать также в виде v0          -+   v1   -+   ...   -+   Vm и называть путем
из Vo в Vm .


§ 1 4 . Н ахождение кратча йших путей                            в   ор гра фе
Пусть G = (V, А) - взвешенный орграф, т. е. каждой его дуге е = (и, v) Е А
поставлено в соответствие неотрицательное число J.t(е) = J.t(и, v) , называемое ее
весом. Вес пути Р - сумма весов его дуг:
                                J.t(P) =   L J.t(e).
                                           е ЕР

Кратчайшим путем из вершины s в вершину t назовем путь минимального веса,
ведущий из s в t, а под расстоянием между вершинами s и t будем понимать вес
    § 14. HaxoJfД811118 кратчаАwмх nутей 1 орrрафе   -------,-- 1 31
    этого пути:
                                          d(8, t) = р : 8-+
                                                        min. . .-+t р.(Р).
    Вес тривиального (т. е. не содержащего дуг) пути считаем равным нудю, поэтому
    d(8, 8) О . Если не существует пути из 8 в t , то полагаем: d(8, t) = оо . Очевидна
    практическая значимость
                   -           задачи нахождения кратчайших nутей в ориентирован-
    ном rрафе.

    Алгоритм Е. Дейкстры ( 1 959 г. )
    Данный алгоритм находит кратчайшие пути от произвольной фиксированной вер­
    шины орrрафа. Алгоритм представляет собой ,итерационную процедуру, на каждом
    шаге которой каждой вершине v сопоставляется пометка l(v) , которая является
    либо постоянной и равной при этом расстоянию d(8, v) от начальной вершины 8
    до данной вершины, либо временной - числом, являющимся оценкой: сверху для
    d(8, v) . В результате каждой итерации оценки уточняются, и при этом ровно одна
    временная пометка (а именно - наименьшая) переходит из разряда временных
    в разряд постоянных (после чего уже не меняется).
         Перед первой итерацией начальная верШина имеет постоянную пометку
    1(8) = О, у остальных вершин nометки временные и nолагаются равными оо .
    Итерация алгоритма состоит в просмотре вершин v с временными пометками,
    к которым ведут дуги из вершины р - вершины, последней получившей по­
    стоянную пометку (для первой итерации р = 8). Пусть а l(p) + р.(р, v). Если
    окажется, что l(v) > а , то а . будет новым значением l(v) (временная пометка
    данной вершины уменьшаетсЯ).
         Алгоритм заканчивает рабоТу, когда заданная конечная вершина t получает
    постоянную пометку.
         Более детальное описание алгоритма (с использованием конструкций Си,
    а также математической символики) -:- на рис. 29 (c. l32).

·   Обоснование коррекТности алгоритма Дейкстры
    Алгоритм работает таким образом , что после каждой итерации пометка каждой
    вершины v есть вес кратчайшего из тех путей из 8 в v, в которых предпоследняя
    вершина имеет постоянную пометку. Пусть после очередной итерации вершина v*
    получает постоянную пометку. Достаточно доказать, что кратчайший путь из 8 в v*
    проходит через вершины с постоянными пометками. Предположим противное:
    кратчайший путь Р из s в v* проходит через некоторую вершину с временной
    nометкой:
                        Р : s -+ s1 -+ . . . -+·8k -+ w -+ . . . -+ v*,
    пусть   w   - nервая такая вершина. Тогда

                             р.(Р) =    2::: р.(е) > р.(8, 81) + . . . + p.(8k ,   w) .
                                        е ЕР

    Таким образом, существует путь из 8 в w , проходящий только через вершины
    с nостоянными nометками и имеющий меньший вес, чем nуть из 8 в v* , что
    противоречит выбору v• .
132   ------- Гnава LXX. Вмдение 1 теорwо rрафов

1* Нахождение кратчайшеrо пу-rи        между двумя: вершииами ( s и t ) * 1
1* V - множество вершии rрафа          *1
1* s - начальная: вершииа              *1
1 * t - ковечвая: вершива              *1
1* l - пометки вершин                  *1

1 * Расставовка начальных пометок * 1
l (s ) =O ;
for (v E V) if (v ! =s ) l (v)=oo ;
1* М       множество временных помет ок * 1
M=V\ { s } ;
1 * р - вершииа , последвей получившая: постоя:нвую пометку * 1
p=s ;

while (р ! =t)
{
     for (vE М n Г(р) )
      {
           a=l (p) +p. (p , v) ;
           if ( a<l (v) )
           {
               1* fJ(v) - :вершииа , из которой идет дуrа в V*/
               1 * ( в кра-rчайшем пути)                     *1
               l (v) =a; O(v)=p ;
           }
       }
       l (v* ) =minl (v) ;
                vEM
               1 * пометка v* стая:овится: постоя:нвой *1
         М=М\ { v* } ; p=v* ;
}
d ( s , t ) =l (t) ; 1 * расстояние между s и t ; *1
1* кратчайший путь : s -+ . . . -+ iJ(O(t)) -+ O(t) -+ t * 1

           Рис. 29. Алгоритм Дейкстры нахождения кратчайшего пути в орrрафе


Трудоемкость алгоритма Дейкстры
Пусть граф содержит n вершин. На каждой итерации число сложений не превы­
Шает количества временных пометок, которое в начале работы алгоритма равно
n 1, а с каждой итерацией уменьшается на единицу. Таким образом, общее число
сложений не более
                                                   n(n --1)
                     (n -1) + (n - 2) + . . . +1 =          .
                                                      2
Операции сравнения выполняются как при пересчете пометок, так и при нахо­
ждении минимальной временной пометки; нетрудно подсчитать, что их число
не превосходит n( n -1) . Таким образом, трудоемкость алгоритма оценивается как
§ 14. Нахождение кратчаilwих nyтeil в орграфе   ------ 1 33
                                                 Табnица 3

   итерация \вершина                  1         2            3   4         5          6    р
              о                   ' @]          00       00      00        00         00   1
              1                    -            6        ш       00        00         00   3
              2                    -            5        -       7         ш          00   5
              3                    -            ш        -       6         -          7    2
              4                    -            -        --      [§]       -          7    4
              5                    -            -        -       -         -          ш    6


O(n2 ) операциЙ. Известна модификация алгоритма Дейкстры, имеющая трудоем­
кость О(т log2 n) ( т - число дуг).
    Для того, чтобы найти расстояния от заданной вершины s до всех остальных
вершин орrрафа, алгоритм с рис. 29 модифицируется следующим образом:
  • условие продолжения итераций р ! =t заменяется на М# J2i .

     Пример. Работа алгоритма для графа, и зобра­
     женного на рис. 30 ( рядом с каждой дугой про­
     ставлен ее вес), показана в rабл. 3 (элементы
     таблицы - за исключением первого и послед­
     него столбца - пометки вершин графа; в рамку
     з аключены постоянные пометки вершин).
           Анализ та�лицы показ ывает, что кратчай­
     ший путь от 1 вершины к 6 вершине таков:
      1 -+ 3 -+ 5 -+ 6 .                                                    Рис. 30


Нахождение расстояний между всеми парами вершин орграфа
В принципе, данную задачу можно решить n-кратным выполнением алгоритма
Дейкстры, где n - количество вершин графа. Однако существуетпримерно вдвое
менее трудоемкий алгоритм, разработанный Р. Флойдом.

Алгоритм Р. Флойда (1 962 г.)
Строится последовател_ьность матриц C(k) = (с��)) , где с<о) - матрица весов дуг
графа, т. е. для всех i и j = JL ( щ, Vj) (если в графе нет дуги (щ , Vj ) , то полагаем:
                               с:�)
JL(Vi, v1) = оо) , а при k = 1, . . . , n с�� ) - длина кратчайшего пути из Vi в Vj такого,
что в качестве промежуточных вершин могут бытьлишь v 1 , v2, . . . , vk . Очевидно,
что c�j) - искомое расстояние между вершинами Vi и Vj . Несложно по индукции
ДОКаЗаТЬ СЛедующую рекуррентную формулу, ПОЗВОЛЯЮЩую ПО матрице C(k - 1 )
построить матрицу C(k) :
                                (k          {
                                           (k 1 (k-1 + (k-1
                               cij ) - mш cij - ) , cik ) ckj ) .
                                        .                              }
Действительно, кратчайший путь из Vi в Vj (где в качестве промежуточных вер­
шин могут использоваться лишь v 1 , v2 , . . . , vk ) либо содержит вершину vk , либо
134 --------�---:- r.nua LXX. ВвеАенме • тtOJIМIO rрафоа
                                             k
не содержит. В nервом случае он имеет вес c(ij -1) (так как при этом промежу-
точными вершинами могут быть только v1 ,    , VA:-1 ) , во втором - складывается
                                   щ
                                                                          • • •




из кратчайших путей из                 в vk и из           vk    в Vj , и его вес равен                     ci(k- 1) (k- 1)
                                                                                                               k + ckj

§ 1 5 . Зада ч а сетевого планирования
        и уп равления (PERT)
Процесс выполнения сложного проекта удобно представить в вИде орrрафа, дуги
которого соответствуют этапам (или операциям, элементарным работам) проекта,
а вершины графа изображают абстрактные события, обозначающие начаЛо или
конец этапов; nримем этапы, соответствующие дугам, исходящим из произвольной
вершины графа, не могут начаться преЖде, чем закончатся этаnы (так называемые
опорные работы), отвечающие дугам, заходящим в данную вершину. В проектно­
консТрукторских организациях подобный rраф называют сетевым графиком.
     Очевидно; что рассматриваемый rраф является ациклическим.
     Например, при строительстве Здания в качестве этапов могут рассматриваться
закладка фундамента; возведение стен, возведение крыши, вставка окон и т. д.,
а в качестве событий начало строительства, окончание возведения фундамента,
начало отделочных работ, окончание строительства и т. п:
                                                           Табnица 4 .


 Этап проекта (элементарНая работа)                                                                                       Время
                                                            Обозначеяие                     Опорные
                                                                                             работы                     выполнения
 ' Разработка технического задания                                    er                                                     5
  Конструирование оснастки                                            е2                          -                          8
  Разработка электросхемы                                             ез                          et                         3
   Разработка сборочных чертежей                                      е4                          е1                         8
   Разработка технологии сборки                                       es                          ез                         2
   Изготовление оснастки                                              е6                          е2                         4
  Монтаж электросхемы                                                 е1                          ез                         7
  Сборка изделия                                                      ев                        е4, es                       5
   Окраска изделия                                                    е9                        е6 ,   е1                    2


    Пример 1.       Рассмотрим построение сетевого графика дnя планирования проиэводства
    некоторого издели я . Перечень злементарных работ, их длительность и логические связи
    представлены в табл.          4.
        Дуги сетевого графика мы будем обозначать так же, как и соответствующие работы.
                  ·                                        '
    Источник графа будет соответствовать началу выполнения проекта, а сток - окончанию.
              Из таблицы видно, что работы                 е1    и   е2    являются начальными (у них нет nредше­
    ствующих работ), а работы            е8 . и е9 -            завершающими (они не предшествуют никаким


                  заканчиваться в стоке.
    други м). Таким обращ>м, дуги             е1       и   е2   будут начинаться в источнике графа, а дуГи е8
    и    е9   -




                                                                                                                                      и е7.
              По окончании работы       е1   начинаются работы                    е3   и   е4   - значит. в графе конец дуги
    е1   будет служить началом дуг           е3    и   е4 .     АналогИЧt!О, конец дуги                 е3 -     начало дуг      е5

    Поскольку работе         е8   непосредственно предшествуют работы                                  е4    и   е5 •   в графе должна
    бьiТь вершина, служащая концом дуг                     е4    и   е5   и началом дуги           е8•
§ 15. Зада11а сетевоrо манироваиИII и ynpaa.nettИII (РЕRТ)                  ------                                           135

                П родолжая подобные рассуж-.
      дения, е конце концое получаем сRе­
      дующий сетевой график (рис. 3 1 ) .


      Будем считать, что задано кон­
кретное время выполнения каждого
этапа 91 - вес дуrи t(vi, Vj) ·
      В задаче сетевого планирова­
ншt и управления 1 0) требуется най­
ти минимальное время выполнения
проекта - время, за которое можно
пройти по всем дугам графа, двига­                     Рис. З J
ясь от начальной вершины ( 8) к ко-
нечной вершине (t), причем движение п о каждой дуге может начаться лишь после
того, как пройдены все дуги, заходяшме в ее начало. Другими словами, нужно
найти самый длинный путь (т. е. путь наибольшего веса) от 8 к t .
     Для решения данной задачи можно модифицировать алгоритм Дейкстръr
нахождения кратчайшего nути от s к t : заменить оо на О, < на > , min на max .
Мы опишем более эффективный алгоритм, учитывающий ацикличность графа.
      Пронумеруем вершины орграфа G       (V, А} так, чтобы каждая дуга (щ, Vj)
(i, j = 1 ,
                                                                        =



               , n) вела из вершины с меньшим номером в вершину с большим
номером: (vi, Vj) Е А => i < j (в силу ацикличности это всегда возможно).
                     . . .




Через l(vi) обозначим наиболее раннее время начала операций, соответствующих
дугам, исходящим из вершины щ (считая l(v1)        0), иными словами, l(щ)                                                   -



длина самого длинного путИ из v1 в щ . Минимальное время выnолнения проекта
тогда будет равно l(vn)· Алгоритм состоит в последовательном вычислении l(Vj)
(j 2,       , n) по очевидной формуле:
             . . .




с нулевыми начальными условиями: V i l(v;) = О.
      Пример 2.              Для сетевого графика, построенного выше, в результате работы алгоритма
      находим:

                     l(v1) = О,        l(v2)    5,    l(v3)    =   8,
                     l(v4)    =   max {l(v2) + t(112 , 114), l (vз) + t(113 , 114) } = max{5 + 8, 8 + 2} = 13,
                     l (v5)   =   8,
                     l (116) = max {l(113) + t(113 , 116), l (vs) + t (115, v6) }          max{8      8 + 4}   =   15,
                     l(v7)    =   max { l(114) + t(v4, 117),   l (116) + t(v6, v1)}    =   max{13 + 5, 15 + 2}     =   18.
      Таким образом, если считать, что время выnолнения работ nроекта было задано в днях,
      то минимальное время выnолнения всего проекта равно 18 дням.


    9) В                                                                        случайная величина.
            более общем случае время выполнения этаnа
                                                                            -


   I O) В   англоязычной литературе принят термин
                                                                        PERT (Project Evaluation Research
      Task).
136   --------�--                                                                    Гпава LXX . IJведеиие в теори10 rрафов

         Путь наибольшей длины от начальной вершины графа к конечной назы­
вают       критическим путем. В рассмотренном примере критическим является путь
v1    -+   v2 -+ v4 -+ v7• В общем случае, в графе может быть несколько критических
путей. Для того чтобы проект был выполнен за минимальное время, операция,
отвечаютая каждой дуге критического nути, должна начинаться сразу после того,
как закончится предшествующая ей операция                                      (на   указанном пути) . Если дуга
не принадлежит никакому критическому пути, то соответствующая ей операция
может начать выполняться с некоторым запаздыванием, которое не отразится
на общем времени выполнения проекта. Обозначим через       самое nозднее                          L(vi)
время начала операuий, отвечающих дугам, исходящим из вершины Vj , при ко­
тором весь проект все еще может быть выполнен за минимальное время. Для
нахождения             L('Vi) nоменяем ориентацию каждой дуги (при этом поменяются ме­
стами начальная и конечная вер Ш ины) и, повторив                                nредьщущий алгоритм, найдем
l' (vi) - самый длинный путь от Vn до vi ; петрудно видеть, что L(vi) = l(vп) -l'(vi).
Теперь дл я ка!щой оnерации (vi, Vj ) можно определить резерв времени r(щ, Vj) -
на сколько единиц времени можно отложить начало ее выполнения, чтобы проект
моr быть выполнен за минимальное время ( при отсутствии друrих задержек) :


                                     / r(vi, Vj)   =:=   L(Vj ) - l(щ) - t(щ, щ). j
Для последнего примера имеем:

                                                              Таблица 5

            i
                      11                  2                   3           4               5               б          7
        l (v;)                   о        5                   8           13              8              15          18
       l'(t!;)                18         13                   9           5               6               2          о
       L(v;)                     о        5                   9           13              12             16          18

        Дл я расчета резервов вj)емени работ, не входящих в критический путь, соста­
вим табл. б.

                                                              Таблица 6

      V;flj                L(vi)       l (щ)              t (fl;flj)           r(щ, v1)        L(v1) - l(щ) - t (щ, Vj )
      '112 '113             9            5                        3                                  1
                            13           8                        2                                  3
                                                                  7
      VзV4
      VзV6                  16           8                                                         . l
      V1V5                  12           о                        8                                  4
      VsV6                  16           8                        4                                  4
                            18                                                                       l
                                                          .

      V6't17      ·                      15                       2


         В заключение параграфа заметим,                          что более детальное и подробное излdжение
теории сетевого п ланирования (включающее в себя, в частности, предположение
о том, что время выполнения каждой работы является случайной величиной
со своим законом распределения) содержится в специальных руководствах.
§ 16. Поrоки в се�Х   ------��---- 137

§ 1 6 . П отоки в ·сетях
Пусть G = (V, А) -- орграф без петель 1 1 ) , имеющий единственный источник
(будем обозначать его v 1 ) и единственный сток (vn). Все остальные вершины
графа будем называть промежуточными. Если каждой дуге графа а Е А поставлено
в соответствие неотрицательное целое число с(а)· (пропус�ная способность дуги),
то говорят, что задана транспортная сеть (или просто: сеть) (G, с) .
     Функция ({): А --+ N0 (определенная на семействе дуг · орграфа и примимаю­
щая неотрицательные целые значения) называется потоком в сети (G, с) , если
выполняются следующие условия:
  1) для любой дуги а Е А ({)(а) � с(а) ;
  2) для любой промежуrочной вершины графа v

                                         L         ({) (и, v) = L ({) (v, и).
                                                                 uEГ(v )
Величину ({)(а) будем называть потоком ho дуге а. Таким образом, 1) поток
по каждой дуге не должен превышать ее пропускной способности; 2) сумма пото­
ков по дугам, заходящим в произвольную промежуточную вершину, равен сумме
потоков по дугам, исходящим из этой вершины. Другими словами, поток не воз­
никает и не накапливается в промежуrочных вершинах. Данная математическая
модель описывает поведение газа или жидкости в трубопроводе, транспортные
потоки в сети дорог, пересьmку товаров на рынок по различным каналам и т��д.
    Величиной потока W ( ({)) назовем сумму потоков по дугам, исходящим из ис-
точника:
                                         W(({)) = L ({) (v 1 , v ).
                                                      vEГ(v1 )
Покажем, что она равна сумме потоков по дугам, заходящим в сток. Действитель­
но, суммируя �авенства из условиЯ 2) потока по всем· промежуrочным вершинам,
получаем:
                                L ({) (и, v) = L L ({) (v, u) .
                vEV\{v 1 ,vn} uEГ- 1 (v )     vEV\{v, ,vn} uEГ(v )
Если вычесть из обеих частей равенства потоки через дуги, оба конца каждой
из которых являются промежуrочными вершинами (каждый такой поток слева
и справа от знака равенства встречается ровно один раз), то получим:



Поток в ТJ?анспортной сети, имеющий наибольшую возможную величину, на­
зывают максимальным потоком. В одной и той же сети может быть несколько
максимальных потоков (их величины, разумеется, должны совпадать).
    Пусть ({) -- поток в сети ( G, с) . Дуга а Е А называется насыщенной, если
поток по ней равен ее пропускной способности: ({) (а) = с(а) . Поток ({) называется
полным, если любой путь в орграфе G из v1 в Vn содержит по меньшей мере
   l l) Петля   в орrрафе - дуга вида   (и, и) .
138   ____________                     __.;________      Гпава LJ(X.   Введение в теорм10 rрафов
одну насыщенную дугу. Очевидно, что всякий максимальный поток является
полным (иначе увеличив потоки по неиасыщенным дугам,\ составляющим путь
v 1 -+ . . . -+ Vn , на 1 , мы не нарушим условий 1) и 2) потока и получим поток
с большей на 1 величиной, чем у данного потока).
       В дальнейшем будем считать, что орграф G (V, А} - антисимметрический,
                                                    =



т. е. он не содержит кратных дуг и если (u, v) Е А, то ( v, u) f/. А . Это предположение
не является сильно ограничи:rельным, поскольку подразбиением дуг (введением
дополнительных <<фиктивных» вершин) всегда можно по данной сети построиТь
сеть с антисимметрическим орrрафом и той же величиной потока.
       Максимальный поток можно найти с помощью следующего алгоритма.
Алгоритм Л . Форда-Д. Фалкереона (1 956 г.)
  1. Построить про�звольный поток 'Р в сети (G, с} (можно и нулевой).
  2. Построить полный поток. Если поток 'Р не полный, то в сети существует путь
     из v0 в Vn , все дуrи которого не насыщены. Увеличивая потоки через все дуги
     такого пути Р на величину min(c(a) - 'Р(а)), получаем путь, некоторая дуга
                                ·        аЕР
     которого является насыщенной. Такую операцию следует повтоl'ять до тех
     пор, пока не получится полный поток.
  3. Построить максимальный поток.
      а) Начальные пометки. Присвоить источнику пометку 0:
         l(v,) = О , а остальным вершинам пометку сх;>. СЛедующий шаг повторять
         до тех пор, пока в результате его выполнения не будет помечен сток Vn
         либо пока не перестанут появляться новые пометк:11 .
      б) Пересчет пометок. Для каждой помеченной вершины vi , пометить сим·
          волом +i все непомеченные вершины v (l(v) = оо ) , для которых дуги
          ( щ, v) иенасыщенные (т. е. '{J(Vi, v) < с(щ, v) ), и символом -i все непо·
         меченные вершины, для которых 'P(v, vi) > О.
      в) Увеличение потока. Если сток Vn не пол}"fает новую пометку, то за­
         кончить работу алгоритма (максимальный поток найден), в противном
         случае существует цепь 1 2) , v0 -+ . . . -+ Vn , все вершины которой по­
         мечены. Если ориентация дуги а = (щ, Vj ) совпадает с направлением
         прохождения цепи, будем обозначать ее 71; в противном. случае - t" .
          Если l(щ) = + i (71 ( щ , щ)); то положить Л(а) = с(а) - 'Р(а) . Если
         l(Vj) = -i ( t" = (vj , щ)), то положить Л(а) = 'Р(а) . Пусть е = min(Л(a))
                                     =




          (минимум вычисляется по всем дугам, составляющим указанную цепь).
          По каждой дуге 71 поток увеличить на е, а по каждой дуге t" поток
         уменьшить на е . (При этом величина потока в сети W('P) увеличится
         на е . ) Перейти к шагу а).
Перед тем, как обосновать алгоритм Форда-Фалкерсона, проиллюстрируем его
работу на примере (рис. 32, на котором насыщенные дуги помечены значком " х ") .
Начальный поток не является полным. В пути v 1 -+ v3 -+ v4 -+ v6 все дуги
I:Ie I:Iасыщены; увеличение потока, проходящего через этот путь, на 2 приводит
к насыщению дуги v3 -+ щ. Находим, еще один путь (v1 -+ v3 -+ v5 -+ v6),
  1 2) Заметьте: в общем случае - не путь!
§ 16. Потоrи 1 Ctl'ltX ------                                                                           139




                а) Трансnортная сеть                                   б) Начальный nоток




                                            в)     Полный nоток



                                             8

                                                ®
                                              '2 [Б]


                г)    Увеличение nотока                           д)   Максимальн ый nоток

      ' Рис, 32. Алгоритм Форда-Фалкереона нахождения максимального потока


состоящий из неиасыщенных дуг; увеличение потока через .каждую из этих дут
на 1 делает дугу v3 .,-+ v5 насыщенной. Теперь получен полный поток.
     Переходим к 3-му этапа алгоритма Форда-Фалкерсона. Расставляем пометки
вершин, как показано на рис. 32 г. Получаем цепь


Имеем:
       Л(v 1 , vз )     5;   Л(t;:ti;) ::::: 1 ;     Л(v2 , V4)    3;     Л(v4, V6)   =   5;   е   l.
Уменьшаем поток на 1 через дуrу (v2 , v3 ) и увеличиваем e ro на 1 через остальные
дуги этой цепи. При повторении процедуры (рис. 32 д) удается пометить только
две вершины (v1 и vз ) . Максимальный поток наЙден: W(tp) = 11.

Доказательс тво корректности алго ри тма Форда-Фалке реона
Так как количество различных (целочисленных) потоков в фиксированной транс­
портной сети конечно, максимальный поток существует. Поскольку в результате
каждой итерации алгоритма Форда-Фалкереона величина потока увеличивается
по меньшей мере на 1 , алгоритм работает конечное время, т. е. рано или поздно
140   -------                                                   Глава LXX. Ввадение в теорию rрафоа

лрекратит свою работу. Осталось доказать, что лоток, который он строит, является
максимальным.
    Бредем ряд новых nонятий. Пусть В - некОТорое множество вершин орrрафа
G (V, А) , не содержащее источник и содержащее сток (В С V, v 1 � В, Vn Е В).
Разрезом сети {G, с} относительно В называется множество А:В дуг, исходящих
из вершин, не принадлежащих В , и заходящих в вершины из В :
                             А:В = { (и, v) Е А ! и � В, v E B} . '
Сумма пропускных сnособностей всех дуг разреза называется пропускной способ-
                              '
ностью разреза:
                                         с(А:В ) = L с(а).
                                                   a EAjj
Разрез с минимальной nроnускной способностью называют минимальным разрезом.
Из «физических� соображений кажется nочти очевидным, что величина потока
в сети не превосходит пропускной способности любого разреза (значит, и минималь­
ноrо). Для строгого доказательства этого факта нам nонадобится

Лемма 5. Длялюбого множества В вершин орграфа G, среди которых есть сток
и нет источника, справедливо следующее равенство:

                               L <р(а) - L tp (a) = W(<p),                                     (1)
                               a EAjj          аЕА�
где
                             А:В        { (и, v) Е А 1 и � В, v Е В},
                             Ai         { (и, v) Е А 1 и Е В, v � В}.

..с Прибавив к уменьшаемому и вычитаемому в разности ( 1) сумму потоков
по всем дутам, исходящим из В и заходяшим в В , получим равенство, равно­
сильное ( 1 ) :
                        L<р(и, v) -               .2:
                                         <р(и, v) = W(tp) .            (2)
                    (u,v)EA, vEB               (u,v)EA, uEB
Вклад стока Vn в левую часть (2) равен W(tp) , а вклад кажд.ой из остальных вершин
из множества В (так как среди них нет и источника, все они - nромежуточные)
равен О в силу условия 2) nотока. Соотношение (2), а вместе с ним и ( 1 ) ,
доказано. �
    Дальиейшее рассуЖДение очевидно:
          W(tp) =   L tp (a) -          z:· tp(a) � 2: tp(a) � 2: с(а)         с(А.В).
                    a EAjj                            aEAjj      aEAjj
Итак, мы выяснИли, что величина nотока в сети не иревосходит пропускной
сnособности минимального разреза. После окончания работы алгоритма Форда­
Фалкереона в сети не суwествует цепи v 1 -+ . -+ Vn , Вдоль которой возможно уве­
                                                       .    .


личение потока. Пусть В множество вершин, которые не получаЮт (конечной)
                               -
YnpaJklleiiМI --------'- ·141

                                                           v 1 f/:. В, Vn Е В. Рассмот­
                               В . Пусть :и - помеченная вершина (и V:. В), а v
nометки на nоследней итерации алгорИтма. Заметим, что
рим разрез сети относительно                                                                  -


непомеченная (v Е В). Если дуга имеет вид (и, v), то согласно алгоритму эта дуга
является насыщенной:
                      <р (и, v) = с( и, v). Если дуга имеет
алгоритму поток по этой дуге равен нулю: <p(v, и)
                                                             вид ( v, и) , fo согласно
                                                      О. Применим теперь лемму 5:

                   W(<p) = ·2: <р (а) -   2: <р(а) = L с(а) с(А:В ) .
                                          aEAJ            аЕАв
Таким образом, в результате работы алгоритма построен поток, величина кото­
рого   равна   пропускной способности некоторого разреза сети; поэтему поток
максимальный. Мы доказали следуюшее утверждение:



Теорема 19 (Л. Форд-Д. Фалкерсон, 1956 г.). Величина максимального потока в сети
равна пропускной способности минимального разреза.

       В   заl(Лючение nараграфа      несколько замечаний.

  l.   Приведеиное выше доказательство теоремы Форда-Фалкереона показывает,
       как найти один из минимальных разрезов. Это разре1 составляют дуги, ве­


       алгоритма Форда-Фалкерсона. Н апример, дЛЯ трансnортной сети, изобра­
       дущие и з помеченных вершин в непомеченные на последнем этапе работы


       женной на рис.   32а,    минимальный разрез образуют дуги         v1v2 , v3v4, v3vs.
  2.   Если величина проnускной способности дуги н е обязательно является неот­
       рицательным целым числом, то, как показали сами Форд и Фалкерсон, если
       «неудачно>> выбирать увеличивающие         цепи,   то процесс выполнения алгоритма
       может никогда не кончиться, более тоrо, величина текущего потока может
       все время не иревосходить четверти максимального потока.                  В   настоящее
       время известен эффективный алгоритм нахождения максимального потока
       трудоемкости    O(n3).
  3.   Можно рассмотреть и более общую постановку задачи, допускающую налИчие
       в сети нескольких источников и стоков .      В этом случае следует ввести фиктив­
       ный источник,   от которого идут дуги к       (настоящим) источникам ( последние
       перейдут в разряд промежуточных           вершин) , и фиктивный сток, к которому
       идут дуги от (настоящих) стоков (также        становящихся промежуточными вер­
       шинами) . Так задача будет сведена к задаче с одни м источником и одним
       стоком.



                                        Упражнения
Определемия и nримеры
  1 . Пусть G11 - простой rраф с множеством вершин {v1 ,        , v,. } , в котором вершины щ
                                                                 • • •


      и Vj смежны тогда и только тоrда, коrда числа i и j взаимно просты. Изобразить rрафы
      G4 и G6 и найти их матрицы смежности. Показатъ, что если т < n, то Gm С Gn .
  2. Для rрафов из каждой пары rрафов, изображенных на рис. 33, выяснить, изоморф­
      ны ли они.
142   ------                                               Гnааа LXX .   Введение в таори10 графов




           а)               б)              в)                   г)                д)
                                           Рис. 33

  3.    Найти все (с точностью до изоморфизма) простые графы, в которых не более пяти
        вершин.
  4.    Сколько существует попарно неизоморфных простых графов с 10 вершинами и 1) 44;
                                                             ·

        2) 43 ребрами?
        Сколько существует помеченных простых графов с n вершинами? Сколько из них
        имеет m ребер?
  5.

  6.    Доказать, что в просrом графе с не менее чем двумя вершинами найдутся две вершины
        одинаковой степени.
  7.    Показать, что реберные графы L(K,.) и L(K,.,m) являются регулярными.
  8.    Доказать, что nри n > 2 звездный граф K 1,n не является реберным графом.
  9.    Пусть р , , Р2 , . , Pn
                      . .
                                степени вершин графа G . Сколько вершин и ребер содержит
                                 -


        реберный граф L(G) ?
 10.    Доказать, что nростой граф изоморфен своему реберному графу тоrда и только тогда,
        когда он является дизъюнктным объединением циклических графов.
 11.    ПривестИ примеры (когда это возможно)
        1) двудольного графа, являющегося регулярным;
        2) кубического графа с 9 вершинами;
                  ·

                                                              (n - 1)(n - 2)
        3) (для каждого n) простоrо графа с n вершинами и                    ребрами;
                                                                    2
        4) (для каждого n) простого графа с n вершинами, изоморфного своему реберному
           графу;
        5) связных графов, являющихся регулярными графами степени 4.
 12.    Какие из платоновых графов являются двудольными?
 1 3. [Теорема Кёнига.] Граф является двудольным тогда и только тогда, когда все его циклы
        имеют четную длину. доказать.
 14.    Доказать, что в неnустом двудо!Уьном регулярном графе доли содержат равное число
        вершин.
 1 5.   Может ли регулярный степени выше 1 двудольный граф иметь мосты?
 16.    В связном графе степени четырех вершин равны 3, а степени остальных вершин рав­
        ны 4. Доказать, что нельзя удалить ребро так, чтобы граф распался на две изоморфные
        компоненты связности.
 17.    Пусть в графе среди любых четырех вершин найдется вершина, смежная с тремя
        остальными. Доказать, что радиус графа равен единице.
 18.    Найти дополнения к графам, соответствующим тетраэдру, кубу и октаэдру.
Уnражненмв      -------                                                                                                      143

 19. Вычислить:
       l) С4 +'N2 ; 2)             Kn + Кт ;            3)   Kn,m ;       4) G + Н ( G и Н            простые графы).

 20. Пусть G, Н и К - простые графы; доказать или опровергнуть следующие равенства:
       1)   G U (Н +          К) = (G U H)      + (G U K) ;
       2)   G + (H U K) = (G + H) U (G + K) .

 21 . Найти матрицы смежности графов Kn, Nп и                                     с...
 22. Чем характерна матрица смежности двудольного графа?
 23. Какова связь между матрицами смежности nростого графа и его дополнения?
 24. Пусть А     матрица смежности регулярного графа степени k . Доказать, что k есть
       собственное значение матрицы А. Найти отвечающий ему собственный вектор.
                         -




 25.   В графе Петерсена найти циклы длины                                5, 6, & и 9.
 26.   В графе Петерссна найти разрезы из 3 , 4 и                             5 ребер.
 27.   Доказать, что доnолнение                к    (nростому) несвязиому графу есть связный граф.
 28.   Доказать, что реберный граф связного графа связен.
       Пусть G - граф с м ножеством верщин {v1 ,                                • • • , v.. } и матрицей смежности А . До­
                                                                          из V; в Vj равно (i, j)-мy элементу матрицы
 29.
       казать, что число марщрутов длины                          k
       Ak .     Показать также, что если G ,- nростой граф, то число                                  треугольников   (циклов
                                         Аз
                                                                      n                                                       .

       длины        3)   в G равно tr          (где tr А       = L а11            -   след матрицы А).   Верно ли,   что   число


                                               А4
                                                                  i=l


       циклов длины 4 равно tr                      ?
                                               8
 30. Основываясь на результате предьщущей задачи , предложите алгоритм определения
       диаметра графа по его матрице смежности.
 31. [Экстремальная теорема '!Урана.] Пусть G - nростой граф с 2n верщинами, не содер­
       жащий треугольников. Доказать, что в G не более                                   n2   ребер и привести пример, когда
       эта верхняя граница достигается.
 32. Найти максимальное число ребер в простом rрафе с 2n + 1 вершинами, не содержащем
       треугольников.
 33. Найти радиус и диаметр графа Петерсена.
 34. Для каждого n построить пример графа, центр которого состоит из                                      n вершин и не сов­
     падает с множеством всех верщин.
 35. Пусть а) n = 4; б) n                 5.
       l)   Найти цикловой индекс группы подстановок н а множестве ребер полного трафа
            с   n   вершинами, порожденных перестановками вершин .
       2) С      помощью теоремы Пойа найти число попарно неизоморфных простых графов
            с   n   верщипами и т ребрами.

Гамипьтоиовы и эйлероеы графы
 36. Для каких чисел т и n следующие графы являются а) эйлеровыми; б) rамильтоновыми:
       1)   Кп ;         2)   Km.n ;   3) Wn ?
 37. Привести пример эйлерона графа, не являющеrося rамильтоновым, и rамильтонова
       rрафа, не являющеrося эйлеровым.
 38. Пусть G - двудольный граф, доли которого содержат т и n верШин соответственно.
       Доказать, что
       1)   если G - rамилыонов граф, то т =                              n;
       2)   если G - полуrамилыонов граф,                         то      Im - n l �     1.
144   ------                                                         l'i1aвa LXX. Введение в теори10 rрафоа




                   Рис. З4                    Рис. З5                          Рис. 36

 39. Может ли а) конь; б) король; в) ладья побывать на каждой клетке шахматной доски
     размером 8 х 8 ровно один раз и последним ходом возвратиться в исходную позицию?
     Решить такую же задачу для доски 7 х 7 .
 40. Можно л и прогуляться по парку и его окрестностям (рис. 34) так, чтобы nри этом
     nерелезть через каждый забор ровно один раз?
 41. Доказать, что если граф G связен и имеет k                 >О
                                                          вершин нечетной степени, то
     минимальное число не имеюших общих ребер цепей, объединение которых содержит
     каждое ребро графа G , равно k/2.
 42. Дан кусок проволоки длиной 1 20 см. Какое наименьшее число раз придется ломать
     провол<Jку, чтобы изготовить каркас куба с ребром 10 см?
 43. Можно ли сетку, составленную из единичных квадратов (рис. 35), nредставить в виде
     объединения 1) восьми ломаных длины 5; 2) пяти ломаных длины 8?
 44. С помощью алгоритма Флери найти эйлеров ци'ЮI в графе на рир. 36.
 45. Доказать, что реберный граф простого эйлерова графа является одновременно эйле­
     ровым и гамилыоновъrм.
 46. Доказать, что реберный граф простого гамилыонова графа является гамилътоновым.
Деревья
 47.   Найти все (с точностью до изоморфизма) деревья, в которых не более семи вершин.
 48. Волейбольная сетка имее-r вид прямоугольника 50 х 600 клеток. Какое наибольшее
       количество веревочек можно перерезать так, чтобы сетка не распалась на куски?
 49. Доказать, ч:rо каждое дерево является двудольным графом. Какие деревья являЮтся
       полными двудольными графами?
 50. .Если в дереве .не менее двух ребер, то его радиус меньше диаметра. Доказать.
 5 1 . Доказать, что центр дерева состоит из одной вершины, если диаметр дерева есть
       четное число, и двух вершин в противном случае.
 52. Верно ли, что в дереве с нечетным диаметром любые две простые цепи наибольшей
       длины имеют хотя бы одно общее ребро?
 53. Выразите радиус дерева через его диаметр,
 54. IJусть n - количество вершин дерева, r        его радиус. Доказать, что n � 2r.
                                                        -



 55. Верно ли, что если диамеrр графа равен k
       диаметра k ?
                                                            >
                                                      2, то граф имеет стягивающее дерево

 56. Для каждого и з указанных ниже графов найти какое-нибудь стягивающее дерево
       и фундаментальную систему циклов относительно него.
       1)   Ks ;   2) Кз,з ;   3) W5 ;   4) С6 ;   5) граф Петерсена.
 57. Пусть Т, и Т2 - стягивающие деревья связного графа G . Показать, что для любого
     ребра е. из Т, существует ребро f из Т2 такое, что после <<замены» в Т1 ребра е
     на ребро f вновь получится стягивающее дерево. (С помощью подобной процедуры
     можно построить последовательность стягивающих деревьев Т1 • • • , Т2 , в которой
                                                                                   ,

     каждое дерево. получается из предыдущего заменой одного ребра). ·
У� --------�--�-- 1"

  58.  Доказать, что число реберно-помеченных деревьев с n � 3 вершинами (в которых
       помечены не вершины, а ребра) равно n"-3 •
  59. Показать, что nри больших n верояmость того, что случайным образом выбранная
     . вершина дерева с n вершинами является висячей, nриближенно равна 1/е.
  60. Найти стягивающее дерево минимал?ноrо веса для каждого графа на рис. 37.




                                           ·   Рис. 37

  61. Необходимо построить систему нефтеnроводов, которые должны соединять семь
        нефтеочистительных заводов, nринадлежащих пекоторой комnакии, с портом (П),
        куда nостуnает сырая нефть. Известны (табл. 7) nредnолагаемые ежегодные затраты
        на эксnлуатацию нефтепровода между соответствующими nунктами.

                                           Табтtца 7

                             п       l    2       3      4        5    6    7

                        п      о    5     6       8      2        6    9    10

                         1     5    о     4      lO      5        8    6    10

                         2     6    4     о      ll      8        4    9    10
                         3     8   10    11       о      10       3    6    7

                        4      2    5     8      10      о        2    5    9

                         5     6    8     4       3      2        о    10   5

                        6      9    6     9       6      5        10   о    8

                         7   10    10    10       7      9         5   8    о


        Найти систему нефтепроводов, позволяющую осуществлять nереброскунефти от nорта
        ко всем заводам с минимвлъными годовыми эксnлуатационными затратами.

Кориные дерееи
Дерево с выделенной вершиной   (корнем) называют кopнellbllll iJгpefiO.II.
  62. Найти число nомеченных корневых деревьев с              n   вершинами.
     В книгах, nосвященных исследованию структур данных, корневое дерево определяют
рекурсивно следующим образом.
     Корневое i)ерево Т - это непустое конечное множество Т с элементами, называемыми
вершинами, такими, что
  1) имеется выделенная вершина, называемая корнем данного iJгрева;
  2) если множество остальных вершин непусто, то оно разбивается на т .множеств
     Т1 , : . . , Tm , каждое иэ которых в свою очередь Я«IIJieтcя корневым iJгревам.

,6--2331
146    -------                                                 rnaвa LXX.   Видение в теорию rpaфoll

Деревья Т1 ,  , Тт называются подiJеревЬRМи данного корня. Йз определения следует, что
                 • • •


каждая вершина дерева является корнем некотороzо. своего дерева. Число поддеревьев дерева
с корнем r порядок вершины r. Вершины нулевого порядка называют листьями;· остальные
                -


вершины называют внутренними.
     63. Сколько листьев имеет дерево с k внутренними вершинами, nорядок каждой из ко­
         торых равен двум?
     64. В турнире по олимпийской системе («проигравший выб1>1вает») участвует n человек.
         Сколько встреч будет nроведено?·
     65. Heri� купил курицу. После того, как она снесла два яйца, ее съели. Из яиц вывелись
         цыnлята. Петухов съедали сразу, а куриц - после тоrо, как они сносили по два яйца,
         и т. д. В какой-то момент вывелись одни петухи, и процесс закончИЛся. Сколько куриц
         бьшо съедено, если съели 97 петухов?
     66. Сколько листьев имеет дерево, в котором (кроме листьев) содержится n1 вершин
         порядка 1 , n2 вершин порядка 2, . . . , n, вершин порядка s?
Укладки rрафов
     67.   При каком k можно так расположить 6 точек на плоскости и соединить их попарно
           непересекающимися отрезками, чтобы каждая точка бьша соединена ровно с k
           другими?
     68.   При каких n графы Gn (определение см. в задаче 1) планарны?
           Проверить формулу Эйлера, связывающую число вершин, ребер и граней плоского
           графа, для следующих графов:
     69.

           1) Wn ; 2) K2,n ; 3) .графа, соответствующею клетчатому полю s х t .
..
     70.   Всегда ли план�рен реберный граф планарного графа?
     71.   Пусть в простом графе G не менее l l вершин. Доказать, что граф G и его дополнение
           G не мoryr быть одновременно планарными.
     72.   Используя тот факт, что в простом плоском графе есть вершина степени не больше
           5, доказать, что его вершины можНо раскрасить не более чем в 6 цветов так, чтобы
           смежные вершины были разного цвета.
Ориентированные rрафы. Алгоритмы
     73. Пусть А - матрица смежности орграфа с множеством вершин { v 1 ,       , Vn}. Какой
                                                                                   • • •


         смысл имеют суммы строк и суммы столбцов матрицы А ? Доказать, что (i, j)-й
         элемент матрицы Ak равен числу путей длины k из V; в щ .
     74. В дереве с n вершинами ребра ориентируются случайным образом. Какова вероятность
         тоrо, что найдется вершина, из которой ведуТ пути ко всем остальным вершинам?
     75. Пусть G       связный граф. Зафиксируем некоторую ero вершину v . Доказать, что
         можно так ориентировать ребра графа, что в полуЧившемся .орграфе существует путь
                         -




         от v до любой другой вершины.
     Ориентированный граф называют          сильно связным,   если для любых его1 вершин и и v
                                                                               '
существует путь из и в v .
     76. В связном графе степени всех вершин четны. Доказать, что можно так ориентировать
         ребра графа, чтобы
         1) получившийся орграф был сильно связным;
         2) для каждой вершины полусте�ень исхода была равна полустепени захода.
     77. В ориентированном графе со связным основанием для каждой вершины полустепень
         исхода равна полустепени захода. Доказать, что орграф эйлеров.
     78. Най1'И кратчайший путь от 1-й вершины до всех остальных (рис. 38а, б) .
У��Н       ------ 147




                      а)
                                          Рис. З&

79. Дана структурно-временная таблица работ по организации выставк.и:-nродажи товаров
    (табл. 8). Требуется построить сетевой график, найти наименьшее время выполнения
    проекта, определить критический путь, вычислить резервы времени для выполнения
    каждой операции.
                                         Табnица 8

          Этап �кта                                       Опорные             Время
                                       Обозначение
      (элементарная работа)                                работы           выполнения

Заказ на оборудование и товары                е1                                lO
Разработка системы учета спроса               ez              -
                                                                                ]2
Отбор товаров и выписка счетов              · ез              е1                2

                                                                                5
Завоз товаров                                 е4              е3                3
Завоз оборудования                            es              е1
Установка оборудования                        е6              es                6
Выкладка товара                               е1              е4                6
Учет наличия товара                           es              е4                5
Оформление зала и витрины                     е9            е6, е1              5
Изготовление документов учета                ею             ez, ев              4
Репетиция выставки:-продажи                  ен             е9, еш              2

80.   Пусть проекты описываются взвешенными графами (рис. 39 а, б), где дуги соот­
      ветствуют операциям (этапам) проекта, а вес дуги обозначает время выполнения
      соответствующей операции. Найти наименьшее время выполнения nроектов, крити­
      ческие пути и резервы времени для выполнения каждой операции.




                           а)                                        б)
                                          Рис. 39

81 . Найти максимальные nотоки: и минимальные разрезы в транспортных сетях
      (pi!c. 40а, б). Число рядом с дугой есть ее пропускная способность.
148   -------                                                         Гпвва LXX.      Введение а теорм10 rрафОв




                              а)
                                                     Рис. 40

 82. Пусть имеется     т неженатых мужчин, n незамужних женщин и k свах. У каждой
        свахи есть список своих клиентов; между любыми мужчиной и женщиной из этого
        списка сваха может устроить брак. Для i-й свахи число устроенных ею за год браков
        не превосходит числа Ь1 • Перевести задачу нахождения наибольшего числа браков,
        которые моrут устроить свахи за rод, в задачу нахождения максимального потока
        в некоторой сети.

                                                     Ответы
2. Изоморфны пары rрафов на рисунках б) и в).
        n                          n
3. Существует ll простых rрафов с 4 вершинами и 34 - с 5 вершинами. 4. l) l; 2) 2.
9.    � L; р; вершин и ! L; (Pt - р;) ребер.
       i=l                         i=l

               Вершина реберного rрафа L(G) , отвечающая ребру tl;tiJ в G, имеет степень
        Решение.
(р; + Pi - 2). В сумме А L;(p, + Pi - 2), rде суммирование ведется no всем ребрам G ,
степень каждой вершины р ; встречается ровно р; раз. Поэтому удвоеННое число ребер
L(G) равно А = L; Pl - 2m, rде 2m = L; р; - удвоенное число ребер исходного rрафа G.
     Друrое решение. Ребра, инцидеитные i-й вершине в rрафе G, образуют с;, nap смежных
ребер, каждой паре соответствует ребро в реберном rрафе. Суммируя Ср, по всем i , вновь
найдем общее число ребер L(G) .
                                                                                                   n
10. Достаточность очевидна. Необходимость. �з предыдущей
                                                    .    задачи следует: L; р; = 2n;
                                                                                                  i=l
 n                             n
Е р� = 4n, откуда L:;(p; - 2)2 = О, т. е. V i р; == 2. Связный реrулярный rраф степени 2
i=l                          ��
есть циклический rраф.
14. Число ребер двудольного rрафа равно сумме степеней вершин любой его доли. 15. Нет.
24. Пусть е - вектор-столбец, составленный из единиц. Тогда Ае ke. 32. n2 + n.
35. 1 ) а) P4(z 1 , x2 , · · ·) = !i (zf + 9xtz� + 8z� + 6z�xl) ; б) P5 (z1 , z , ) = 1� (xl0 + l0zjz� +
                                                                               2 • • •



20zjz� + ЗОх�z� + l Sxr + 20zlzlz� + 24х;} .
       2) Положив вес ребра равным z, а вес неребра щ равным 1, получим следующие про­
изводЯщие функции L; атжт , где т - число rрафов с т ребрами:
а) Е ат х т = Е W(F) P4( l + х, 1 + ж2, ) = 1 + ж + 2z2 + Зz3 + 2х4 + х5 + z6;
                                                      • • •


б) E am zm = Е W(F) = Ps(l + х, 1 + .z 2, ) 1 + z + 2z2 + 4z3 + 6z4 + 6х5 + 6z6 +
                                                         • • •   ==


4z7 + 2х8 + х9 + z 10 • 42. 3 раза. См. задачу 4 1 . 43. l) Да; 2) нет. 48. 30 0()0. 50. Рассмотрите

      1�) Неребро   -   это   отсутствующее в rрафе ребро меJIЩу верnmнами   u и v,
Оtнты ---..,..--- 149

вершину, смежную с концом самой длинной цепи. 53.         r = · [ !!tJ-) 55. Нет. 82. пn- 1 • 63. k + 1 .
                                                                      .


        •              •
86. 1 + L:   ·   kn11 - Е nk . Из общего количества вершин нужно вычесть количество внутренних
     k=l              i:=l
вершин. 61. k � 4. 70. Нет. 71. Если у nланарного rрафа n вершин и т ребер, то выполюi­
ется неравенство т � Зn - 6. 72. ИндуiЩия. по числу вершин. 74 n/2"- 1 • 76. В исходном
                                                                          .


графе существует эйлеров цикл. 77. Перенеся доказательство теоремы Эйлера на случай
rрафа из условия. задачи, можно nоетроить замкнутый nуть, содержащий все .цуrи орrрафа.
Глава LХХ/          ______________________________




                        П АРОСО ЧЕТАНИЯ


    Сначала приведем ФОРl\:\УЛИровки двух задач, первая из которых имеет прак-
тический характер, а вторая скорее шуточный.
  1.   Пусть и меется несколько работников и несколько видов работ. Известно, какие
       работы каждый р�ботник может выnолнять. При каких условиях можно так
       распределить работы между работниками, чтобы каждый выполнял какую-либо
       работу (nри этом на каждую работу назначается не более одного работника)?
 2.    Имеется множество юношей, каждый из которых знаком с некоторыми девуш­
       ками. При каких условиях можно одновременно женить всех юношей так, чтобы
       каждый из них женился на знакомой ему девушке?
     С точки зрения математики эти задачи не отличаются друг от друга, поскольку
их математическая модель одна и та же: выделение совершенного перосочетания
в двудольном графе. Что такое двудольный граф, читатель уже знает из предыдущей
главы; что же до аоrJершен.ного паросочетания, то это множество попарно не смеж­
нъiХ ребер, покрывающих все вершины фиксированной доли двудольного графа.
В двудольном графе две доли. Ребра соединяют вершины из одной доли с вер­
шинами из другой. В задаче 1 такую долю составляют работники, а в задаче 2 -
юноши. Вторая доля в этих задачах состоит из работ и девушек, соответственно.
Наконец, nроизвольное ребро uv графа задачи 1 описывает ситуацию «работник u
может выполнять работу V», а графа задачи 2 - «юноша u знаком с девушкой v».
     В ис,торию математики задача о существовании совершенного парасочетания
              ·
в двудольном графе вошла под именем «задачи о свадьбах» (формулировка задачи 2
оказалась хорошо запоминающейся) , а ответ к задаче дан Филипом Холлом
в 1935 г.
                                                               '.


     В 20-50-х годах ХХ века независимо друг от друга были доказаны несколь­
ко теорем дискретной математики, носящих минимаксный характер: Форда­
Фалкерсона, Кёниrа-Эrервари, Дилворта (в другом написании - Дилуорса) ,
а также Менrера. В каждой из этих теорем угверждалось, что максимум одной ве­
личины совnадает с минимумом другой величины. Как выяснилось впоследствии,
указанные теоремы, а также теорема Холла эквивалентны друг другу: каждая из них
может быть выведена из любой другой. Бьто также установлено, что эти теоремы
являются проявлением принцила двойственности в линейном программировании.
     В комбинаторном анализе и теории сложности вычислений (как и вообще
в математике/
              ) идея сведения одной задачи к дРугой является важнейшей. Поэтому
интересно показать, как внешне различные утверждения переходЯт друг в друга
в результате nостроения некоторых дополнительных конструкций. Понимание
§ 1 . Тн�а Хоnя&      ------                                                         151
таких rrереходов и иреобразований важно и для nрограммистов: зная, как одна
задача сводится к другой, можно алгоритм решения nервой задачи преобразовать
в алгоритм решения второй задачи.
     В этой главе мы nриводим наиболее nростое из известных доказательств теоре­
мы Холла, из теоремы Холла выводим теорему Кёнига-Эrервари, а из той, в свою
очередь, теорему Дилворта. Здесь рассматриваются также некоторые nриложения
минимаксных теорем, в том числе теорема о возможности достраивания латин­
ского nрямоугольника до латинского квадрата (результат, nолученный Маршаллом
Холлом в 1945 г.) и теорема о реберно-хроматиче�ком чцсле двудольноtо графа (наи­
меньшем чисде nаросочетаний, на которое расnадается множество ребер графа).
     Заключительные nараграфы главы nосвящены алгоритмам решения задач
о двудольных графах. Базовой здесь является · задача нахождения наибольшего
(по мощности) nаросочетания в двудольном графе. Излагаемый алгоритм ее
решения nозволяет nоnутно найти наименьшее вершинное покрытие и наибольшее
независим.ое множество вершин.
     Вернемся теnерь к задаче 1 и рассмотрим следующее ее обобщение.
  3.   Пусть имеется несколько работни�ов и столько же видов работ. Известна
       стоимость выnолнения каждым работником каждой работы. Требуется так рас­
       пределить работы между работниками, чтобы суммарная стоимость выnолнения
       работ была наименьшей.
     Это    один из вариантов задачи о назначениях. Ее математическая фор­
              ·-


мулировка: найти совершенное nаросочетание наименьшего веса во взвеШенном
двудольном графе. Мы nриводим алгоритм решения этой задачи, называемый
венгерским в честь Гарол�а Куиа, nредложившего этот алгоритм в 1955 г.
                -




§ 1 . Тео рем а Холл а
Введем некоторые оnределения и обозначения.
    Паросо'(етанием в графе называют множество nопарно несмежнъ1х ребер.
    Двудольный граф G с фиксированным разбиением множества вершин на доли
Vi и V2 будем обозначать G(VJ, V2) .
    Пусть G(V1 , V2)   двудольный граф. Совершенным парасочетанием из Vi в V2
называется nарасочетание в G, nокрывающее V1 (т. е. для всякой вершины из Vi
наЙдется в nаросочетании инцидентное ей ребро).
    Пусть А С V       nодмножество вершин графа G = {V. Е). Окружением
                          -



множества А называют множество

                                    Г(А)         U Г(v) \ А ,
                                                 11ЕА

где Г(v)           множество вершин, смежных с v .

Теорема   1   (Ф. Хом, 1935 r.). Совершенное парасочетание из Vj в V2 в двудольном графе
G(V1, V2) существует тогда и толысо тогда, когда
                                   VА   с   Vi     IГ(A)I � IA!.
152 ------- Гnава LXXt. Паросочет111111

   Теорема Холла дает решение следующей задачи, упомянугой в начале главы.
Наnомаим ее формулировку.
Задача о свадьбах. Имеется множество юношей, каждый из которых знаком с не­
которыми девушками. При какихусловщ можно одновременно женить всех юношей
так, чтобы каждый из них женился на знакомой ему девушке?
    Действительно, nостроим двудольный граф G(V1, у1) , в котором У1 есть
множество юношей, а V2         соответственно множество девушек, а знакомые
юноши И девушки соединены ребрами. Тогда одновременно жеиить всех юношей
означает найти в данном графе совершенное ларосочетание из Vi в V2 . Ответ
на волрос задачи о свадьбах можно сформулировать так: задача разрешима тогда
и только тогда, когда любые k юношей из данного множества знакомы в совокупности
не менее чем t: k девушками.
� Доказательство теоремы Холла. Необходимость очевидна. Действительно, ус­
ловия
                          IAI = k и I Г(A) I < k
означают: некоторые k вершин из V1 смежны в совокупности менее чем с k вер­
шинами из V2 - nоэтому нет поnарно несмежных ребер в G(V1 , V:z), покрывающих
вершины даже из А С V1 , тем более нет совершениного ларосочетания из Vi в V2 .
    Достаточность будем доказывать индукцией по числу юношей. Пусть всеrо
имеется т юношей. База uндукции (т = 1 ) 'очевидна: уж одного-то юношу,
знакомоrо xoтSI бы с одной девушкой, поженить можно.
    Индукционный шаг. Пусть утверждение теоремы выполняется, если юношей
меньше т , и докажем его для т юношей. Рассмотрим два возможных случая.
    1. Любые h юнош�й ( h < т) в совокупности знакомы не менее чем с h + 1
девушками. Если в этом случае мы поженим какого-то (любого) юношу на любой
знакомой ему девушке, то для любых k оставшихся юношей общее число знакомых
им (незамужних) девушек или не изменится, или уменьшится на единицу -
значит, ue превзоЙдет числа k . По предnоложению ·индукции оставшихся т - 1
юношей поженить можно.
    11. Некоторые h юношей ( l � h < т) знакомы в совокупности ровно с h де­
вушками. По предnоложению индукции их можно поженить. Полробуем устроить
судьбу оставшихся т - h юношей. Если какие�то k юношей из их числа знакомы
в совокупности менее чем с k девушками, то вместе с указанными h юношами
они составят группу из k + h юношей, знакомых менее чем с k + h девушками, что
nротиворечит условию теоремы. Таким образом, и к оставшимся т - h юношам
можно применитъ предположение индукции. �


§ 2 . Венгерская теорема
Пусть имеется двоичная матрица (т. е. состоящая из нулей и единиц). Единичные
элементы этой матрицы, никакие два из которых не лежат в одной строке или
одНом столбце, назовем неэавцсимыми. Строки и столбцы матрицы, содержащие
в сОВокупности все ее единицы, назовем покрывающими линиями.
§ 2. Ввнrерска• теорема                                                                 153

      Наnример, для матрицы


                                 ш      1   1    о   о       о
                                  l     ш   о    о   о       о
                                  о         l    о   о       о
                                  о     l   ш    о   о       о
                                        о   о    ш   1
можно указать четыре независимые единицы (они заключены в прямоугольники),
и не больше , а ·минимальное по мощности множество покрьшаюших линий
составляют первые три столбца и nоследняя строка.



Теорема 2 (Д. Кёниг-Э. Эгервари, 1 931 г.). Наибольшее число независи.мых единиц двоич­
ной матрицы равно наименьшему числу покрывающих линий.

     , Дадим сразу перевод условия теоремы на язык теории графов. Пусть в двоич­
ной матрице    А = (aij) т строк и n столбцов. Такая матрица задает двудольный
граф G(Vi , t'2) , где Vi = {u 1 , . , Um } , t'2 = {vJ , . . , Vn} и в графе есть ребро ЩVj
                                  . .                    .


тогда и только тогда, когда OiJ = 1 . Матрицу А можно рассматривать как матрицу
смежности двудольного графа G(V1 , t'2) . Независимые единицы матрицы соответ­
ствуют попарно несмежным ребрам, т. е. паросочетанию графа, а nокрывающие
линии   -   вершинному покрытию графа -         множеству таких его вершин, что всякое
ребро графа инцидентно хотя бы одной из них.
      На рис.   1   представлен граф, соответствующий матрице из nримера, nриведеи­
                        u1v1, u 2v2, u4vз, и5щ составляют максимальное паросочетание,
а вершины Vt , t7,
ного выше. Ребра
                       vз , u5 образуют минимальное вершинное покрытие.




                                            Рис. l

    Итак, венгерская теорема rоворит о том, что в двудольном графе наибольшая
мощность парасочетания равна наименьшей мощности вершинJtого покрытия.
-4 Доказательство венгерской теоремы. Обозначим через r наибольшее число
независимых единиц, а через 8 наименьшее число покрывающих линий. Пусть
                                                х строках и у столбцах, причем
х + у = 8 . Заметим, что если какие-то две единицы лежат (или не лежат) на одной
все единицы матрицы находятся в некоторых


линии, то это свойство сохранится и при любой перестановке строк или столбцов.
(В   графовой моделИ задачи перестановки линий сводятся к перенумерованию
вершин в долях графа) . Поэтому при указанных преобразованиях мощности ин­
тересующих нас множеств         FF менАются.    Значит, можно считать, что все единицы
    154   ------                                                  Гпава LXXI . Паросочетани•

    расположены в первых х строках и последних у столбцах, а матрица имеет сле­
    дующий блочный вид:




    Рассмотрим двудольный граф G' (V{ , V;) , который задается подматрицей А. В до­
    лях этого графа соответственно х и n - y вершин. Если все �диницы из каких-либо
    k строк матр'ицы А покрываются меньшим числом столбцов, то эти k строк можно
    заменить указанными столбцами и получить меньшее, чем 8 = х + у, число линий,
    покрывающих единицы матрицы, что приводит нас к противоречию с предпо­
    ложением о минимальности числа 8 . Таким образом, любые k вершин из доли
    V{ смежны в совокупности не менее чем с k вершинами доли V{ - выполнены
    условия теоремы Холла! Стало быть, в графе G' (V{, Щ) существует совершенное
    парасочетание из V{ в V{ , то есть в подматрице А есть х независимых единиц.
         Аналогичное рассуждение, применеиное . к подматрице С доказывает, что С
    содержит у независимых единиц.
         Объединив независимые единицы из А и С , полУчим х + у независимых
    единиц. Значит, максимальное число независимых единиц r це меньше числа
    8 = х + у. С другой стороны, r независимьхх единиц нельзя покрыть менее чем r
�




    линиЯми (так как каждая линия покрывает не более одной независимой единицы),
    то есть r не больше 8 - минимального'числа покрывающих линий. Итак, r = 8 . .,.
                                   Наибольшее число независимых единиц двоичной матрицы
          Терминопоrмческое замечание.
          называют ее словарным рангом.


    § 3. Теорема Дилворта
    Сначала введем (или напомним) некоторые определения и обозначения. Пусть
    на некотором конечном множестве А введено отношение порядка -< , т. е. отно­
    шение, обладающее свойствами транзитивности (состоящее в том, что если для
    элементов а, Ь и с множества А выполняются условия а -< Ь и Ь -< с, то а -< с)
    и антисимметричности (если \ а -< Ь и Ь -< а, то а = Ь; другими словами, не суще­
    ствует двух различных элементов а и Ь, для которых одновременно выполняются
    условия а -< Ь и Ь -< а). Всем известными примерами отношений порядка явля­
    ются отношения <, � . > , � . заданные на любом подмножестве qисловой прямой,
    и отношение делимости на множестве натуральных чисел. Множество вместе
    с введенным на нем отношением порядка называют упорядоченным.
         Подмножество упорядоченного множества называют цепью, если в нем любые
    два элемента сравнимы по данному отношению, и антицепью, если никакие два
    различные элемента этого подмножества не сравнимы по данному отношению.
                                         7,
    Например, в множестве {2, 3, 6, 55}, упорядоченном отношением делимости,
                                               7,         7,
    есть цепи {2, 6} , {3, 6} и антицепи {2, 3, 55}, {6, 55} . Одноэлементное мно­
    жество - одновременно и цепь, и антицепь. Число элементов цепи .(антицепи)
    будем называть ее длиной.
         Очевидно, что любая цепь пересекается с любой антицепью не более чем по
    одному элементу. Оrсюда следует, что если в упорядоченном множестве А имеется
    антицепь длины т , то число цепей, пок:рывающих А (т. е. -их объединение есть А),
    не может быть меньше т .
§ 3. Теорема ДИJIВорта       --------�                                                                                            1 55

    Таким образом, наименьшее количество цепей, покрывающих А , не меньше
наибольшей длины антицепи. Как показывает следующая теорема, на самом деле
всегда имеет место равенство упомянугых величин.

                       r.). Минимальное число непересекающихся цепей, покр'ьlва­
Теорема 3 (Р. Дипворт, 1 950
ющих упорядоченное множество, равно максимальной длине антицепи.

4111 Обозначим наименьшее количество nокрывающих цепей через Х, а наиболь­
шую длину антицепи через У. Уже установлено, что Х � У. Покажем, что имеет
место и неравенство Х � У.
      Пусть А = {а1 , а2, . . . , an} упорядоченное множество с отношением -< .
Построим двудольный граф G = (Vt U V2, Е} , rде
 Vi   =   { X t , Х2, . . . , Xn } ,     V2    {yt , У2• . . . , Yn} И XiYj                     Е   Е   <=:>   (ai -< aj , i ::/= j).
в этом графе вершины Xj и Yi «Представляют» элемент ai исходного множества,
а наличие ребра XiYj свидетельствует о том, что i-й и j-й элементы множества А
находятся в заданном отношении. Таким образом, построенный граф дает графи­
ческое представление (на то он и граф!) упорядоченного множества.
     Возьмем наибольшее (по мощцости) парасочетание в этом графе. Пусть его
мощность равна k. Это парасочетание «nорождает» т n - k цеnей, покрываю­
щих множество А. Покажем, как их получить. Сначала имеем n одноэлементных
цепей, соответствующих n элементам А. Каждое ребро парасочетания позволяет
объединить две цепи в одну (например, ребро XiYj объединяет цепи . . . -t а;
и ai -t . . . в цепь . . . -t ai -t aj -t . . . ). В итоге и получим т цепей, которые
не пересекаются и покрывают множество А. Отсюда следует, что наименьшее
количество покрывающих цепей Х ne больше т .
    Теnерь рассмотрим какое-либо минимальное вершинное nокрытие графа
                                       Т = {Xi" Xi� ,   • · . ,   Xj, , Yj, � YiP . .   ·   ,   YiJ·
ПокажеМ, что ицдексы всех вершин в указанном множестве различны, то есть
'</ t, l .it ::/= j1 . Ведем рассуждение от nротивного. Предположим, что для каких-то
t и l имеет место равенство it = j, h. Существует ребро вида Xn Yc. где Ус � Т,
                                                        ==

так как в противном случае множество Т \ {х11} также является вершинным
nокрытием, что противоречит минимальности Т. Аналогично,     существует и ребро
вида XdYh для некоторой вершины xd rl. Т. Для указанных с и d имеем h ,.-< с
                                                          1


и d -< h, откуда в силу транзитивности d -< с. Значит, в графе есть ребро XdYc·
соединяющее вершины, не принадлежаЩие множеству Т. Но тогда Т не является
вершинным покрытием - nротиворечие!
    Таким образом, вершины множества Т представляют в . точности r + s эле­
ментов множества А.
    Венгерская теорема, напомним, говорит о том, что наибольшая мощность
парасочетания равна минимальной мощности вершинного покрьпия; в наших
обозначениях получаем k = r + s . Заметим теперь, что элементы, не представлен­
ные в множестве Т, попарно несравнимы, т. е. образуют антицепь, а число таких
элементов равно
                            n - (r + s) = n - k = т.
156   -�------                                                   Гпава LXXI. Паросочетани•

       Из существования антицеnи мощности т вытекает, что максимальная длина
анmицепи    У не меньше т.
       Итак, Х � т � У. Вспоминая, что Х ;;::: У, окончательно имеем: Х =т У. ..,.
       Замечание. Доказательство теоремы дает алгоритм нахождения минимального цепного
       nокрытия, основанный на выделении наибольшего парасочетания в соответствующем
                                                                               '
       двудольном rрафе.

Теорема (двойственная к теореме Дипворта)
Если в формулировке · теоремы Дилворта заменить слово «цепи» на «антицепи»,
а «антицепЬ» на «цепЬ», то получим также верное утверждение, которое доказы­
вается очень просто.


          Минимальное число непересекающихся антицепей, покрывающих упорядо­
. Теорема 4.
ченное множество А , раt1но максимальной длине цепи.

"" Пусть т - максимальная длина цепи, а Р - цепь длины т. Так как любая
антицепъ имеет с цепью Р не более одного общеГо элемента, исходное множе­
ство А покрывает не менее т антицепей. Обозначим через l(a) наибольшую длину
цепи, начинающейся с элемента а (то есть элемент а nредшествует всем друrим
элементам данной цепи) . Очевидно, если а -< Ь, то l(a). > l(Ь). Таким образом,
элементы а и Ь, для которых l(a) = l(Ь), не сравнимы, а множество

                                   Ai = {а   l l(a) = i}
является антицепью. Осталось заметить, что в наших предnоложениях функция l
на элементах множества Р принимает все значения от 1 до m, и т - наи­
большее значение функции l. Значит, имеем т неnересекающихся антицеnей
А 1 , Аъ . . . , Ат . локрываюших уnорядоченное множество А . ..,.
       Из доказанной теоремы вытекает следующий интересный факт.


         Если упорядоченное множество А содержит нtг менее (р - l )(q - 1) + 1
Теорема 5.
элементов, то в нем существует цепь длины не менее р или антицепь длины не менее q.

"" Если в множестве А нет цепи длины р, то есть максимальная длина цепи
не иревосходит р - 1 , то, согласно предыдущей теореме, найдется не более
р  -l антицепей, nокрывающих множество А. Если бы каждая· из них содержала
не более q - l элементов, то в их объединении было бы не более (р - l )(q - 1)
элементов, и они не nокрывали бы множество А. Стало быть, длина пекоторой
антицеnи не меньше числа q. •
       Замечание. Теорема 5 легко выводится и из самой теоремы Дилворта, но, как уже
       заметил читатель, она доказывается не столь просто, как двойственная теорема.

    В последующих nараграфах данной главы мы рассмотрим некоторые прило­
жения минимаксных теорем.
§ 5. 1Щжды стохастические матрицы   ------                                        157

§ 4 . Совершенн ые па росоч етания
      в регулярных двудольн ых графах
С помощью теоремы Холла получим результаты, связанные с темой параграфа.

Теорема 6. В любом непустом регулярном двудольном графе G (Vt , V2) сущест8)Jет
совершенное паросочетание.

"1111 Пусть степень каждой вершины графа равна q > О. Возьмем произвольные k
вершин первой доли Ь1 . lh, . . , Ь�; и смежные с ними вершины 91 , 92,
                                    .                                   , g1 второй
                                                                        . . .


доли и рассмотрим порожденный этими k + l вершинами подграф исходного
графа. В полученном графе степень любой вершины из первой доли равна q ,
а из второй - не больше q . Число ребер двудольного графа равно сумме степеней
вершин любой из его долей. Поэтому
                               k              l

                             I: р(Ьi) = kq = L p(gj ) � lq,
                             i=l             j= l
откуда l ;;;:: k. Таким образом, выполнены условия теоремы Холла о существовании
в двудольном графе совершенного паросочетания. ..,.

Следствие. Любой непустой регулярный двудольный граф распадается на совершенные
паросочетания.

..,. Пользуясь теоремой, будем последовательно одно     за    другим выделять в графе
непересекающиеся паросочетания. ..,.


§ 5 . Дважды стохастич еские матрицы
Числовая матрица называется дважды стохастической, если ее элементы неотри­
цательны, и в каждой строке и каждом столбце сумма элементов равна единице.
     Сумма всех элементов такой матрицы равна, с одной стороны, числу ее строк,
а, с другой стороны, числу столбцов. Значит, дважды стохастическая матрица яв­
ляется квадратной.
     Подстановочная матрица состоит только из нулей и единиц, причем в каждой
строке и каждом столбце содержится ровно одна единица. Ясно, что подстано­
вочная матрица является дважды стохастической.
     Подстановочным множеством матрицы называется множество ее элементов,
содержащее по одному элементу из каждой строки и каждого столбца.

Теорема 7. Всякая дважды стохастическая матрица А        (aij) имеет подстановочное
множество, состоящее из ненулевых элементов.
    158 ------ Гпава LXXI. Паросочетани•
                            .                  '


    .... Пусть матрица А имеет размер n. x n. Минимальное число ЛИНИЙ, содержащих
    все иенулевые элементы матрицы А, равно n , nоскольку сумма элементов всей
    матрицы равна n , а каждой линии - 1 . Рассмотрим матрицу В, которая nолучается
    из матрицы А заменой иенулевых элементов на единицы. Минимальное число
    nокрывающих линий матрицы В - такое же, как и для матрицы А, то есть n .
    По венгерской теореме в матрице В есть n независимых единиц. Эти единицы
    задают подстановочное множество матрицы А. 81-

        Очевидно, что nодстановочное множество существует и для неиулевой матри­
    цы из неотрицательньiх элементов с одинаковыми суммами по строкам и столбцам.


    Теорема 8 (Г. Биркгоф, 1 946 r.).
                                 Всякая дважды стохастическая матрица представима
    в виде выnу/СJ/ой комбинации подстановочных матриц.

    <1111 Пусть Р1 - nодстановочная матрица, nорожденная подстановочным множе­
    ством М1 из иенулевых элементов дважды стохастической матрицы А, а число
    с1 - наименьший элемент в М1 • Тогда матрица А - с1Р1 состоит из неотрица­
    тельных элементов и имеет одинаковые суммы по строкам и столбцам, и в ней
    иенулевых элементов меньше, чем у исходной матрицы. Повторяя данное nреоб­
    разование, через конечное число шагов nриходим к равенству



    где Ci > О и Е{ - nодстановочная матрица для каждого i . Пусть матрица А имеет
    размер n х n. Так как сумма всех элементов каждой из матриц А, Р, , Р2, . . . , Pk
    равна n , из ( *) следует: с1 + с2 + . . . + Ck = 1 . Таким образом, найденная линейная
    комбинация является выпуклой. 81-
         Замечание 1 . Доказательство теоремы носит конструктивный характер. Оnисанный nро­
         цесс получения разложения (*) называют алгоритмом Биркгофа. Поскольку каждый
         шаг этого алгоритма дает требуемое значение по меньшей мере одному элементу
         матрицы А, а последний шаг - сразу n элементам матрицы, получаем неравенство
         k � n2 - n + 1 , где k - число подстановочных матриц, через которые линейно выража­
         ется дважды стохастическая матрица А . Известна и более точная оценка: k � n2 -2n+2.
         Замечание 2. Представим каждую дважды стохастиЧескую матрицу размера n  х n точ­

         кой в n2 -мерном пространстве. Геометрический смысл теоремы Биркгофа следующий:
         многогранник дважды стохастических матриц имеет своими вершинами подстановоч­
         ные матрицы.



    § 6 . Л атинские прямоугольники
    Матрица размера т х n называется латинским., прямоугольником, если элементы
    каждой строки этой матрицы образуют перестановку чисел от 1 до n, и в каждом
    столбце все числа разные.
        Очевидно, что в силу определения число строк латинского nрямоугольника
    т не превосходит числа его столбцов n . В случае т = n, как легко догадаться,
·   латинский прямоугольник называют латинским квадратом.
 § 7. Реберни р��С�фаска rрафоа                                                 159

      Наnример, матрицы


                     с             )                 2   3 4



                                                (� �)
                         2 3 4 5                     5   4 2
                       3 5 4 2 1         и           1   5 3
                       4 l 5 3 2                     3   l 5
                                                     4   2 l
 nредставляют собой латинский nрямоугольник размером 3 х 5 и латинский квадрат
 5 х 5 . В этом nримере квадрат nолучается из nрямоугольника nриnисываиием двух
 строк. Возникает воnрос: всегда ли латинский прямоугольник т х n, где т < n,
 .можно дополнить до латинского квадрата n х n, nриписыванием новых n т строк?
 9казывается, всегда! Докажем этот факт.

 латинского nрямоугольника размера т х n, � = {1, 2,
 и j Е � соединены ребром тогда и только
                                                         ...
  � Построим двудольный граф G( Vi , V2 ) , в котором V1 есть множество столбцов



                                                          2
                                                            , n} , а вершины i Е V1
                                                                    3     4       5
 тогда, когда в i �м столбце прямоугольника
 нет числа j .
      Наnример, в случае nрямоугольника из
 рассмотренного примера имеем rраф, изобра­
 женный на рис. 2.                                        2         3     4       5
      Ясно, что стеnень любой вершины из доли                    Рис. 2
 Vj равна n...:; т. С другой стороны, любое число
 j встречается в т строках исходного латинского nрямоугольника т раз, значит,
 оно nоявЛяется в т столбцах и отсутствует в n - т столбцах. Отсюда следует, что
 и стеnень любой вершины из V2 также равна n       т.
      Таким образом, двудольный граф G (Vi , V2) является неnустым и регулярным.
 Как нам уже известно, такой граф расnадается на совершен�р>�е nаросочетания.
 Каждое совершенное nарасочетание задает одну из новых строк латиf{ского квад­
 рата. 111-
        В рассмотренном выше nримере nереходу от nрямоугольника к квадра­
 ту  соответствует выделение в двудольном графе с;овершенных nаросочетаний:
 { 12 , 23, 3 1, 45, 54} и {15, 24, 32, 4 1 , 53}.
        В заключение, отметим, что латинский прямоугольник т х n ( при т � n)
 суmествует. Действительно, сначала "Заnолним nроизвольно nервую строку, затем
 дополним nрямоугольник 1 х n до квадрата, и, наконец, вычеркнем любые n - т
 строк.


 § 7. Ре бер ная р аскраска гр афо в
  Реберно-хроматическое число графа - это наименьшее число цветов, которыми
  можно раскрасить его ребра так, чтобы смежные ребра были разного цвета. Ука­
  занную раскраску будем называть праqильной. Обозначают реберно-хроматическое
  число графа G через Xe(G) (оставляя обозначение x(G) для хроматического числа
. графа    наименьшего числа цветов для раскраски вершин графа, nри которой       ·

  смежные вершины имеют разный цвет).
160   -------                                                                    Гпава LXXI . Паросочетан1111

    Поскольку ребра одного цвета при правильной раскраске попарно не смежны,
они составляют паросочетание. Таким образом, Xe(G)     это наименьшее число.
                                                                         -


паросочетаний, на которые распадается множество ребер графа G.
    Обозначим через D.(G) наибольшую степень вершины графа G. Все ребра,
инцидентные фиксированной вершине графа, при правильной раскраске должны
иметь разный цвет. Поэтому Xe(G) � D.(G) . Неожиданный факт обнаружил со-
                                                          '
ветский математик В. Г. Визинг:

Теорема 9 (В. Г. Визинr, 1 964 r.). Если в графе G нет петель, то
                                  D.(G) :::;; Xe(G) :::;; D.(G) + 1 .




                                              {
      Вычислим реберно-хроматические числа некоторых стандартных графов.
      Легко видеть, что для циклического графа Cn при n � 2 имеем:
                                                  ·   2, если n четно;
                               Xe(Cn)     =
                                                      3, если n нечетно.



                                          {
    В случае колеса Wn с n � 4 вершинами Xe(Wn) = n - 1 . Более сложно
проверлютея соотношения для полного графа Кn с n � 2 вершинами:
                                              n - 1 , если n четно;
                            Xe(Kn)    =
                                              n,           если n нечетно.
    Если Xe(Kn) = D.(G) = n - 1 , то каждая вершина графа инцидентна ребру
(и притом одному) каждого цвета. Отсюда следует, что количество ребер одного
цвета вдвое меньше общего числа вершин n, которое, стало быть, четно. Значит,
при нечетном n Xe(Kn) > n - 1 и, в силу теоремы Визинга, Хг(Кn) = n. Приведем,
тем не менее,
П ример правильной раскраски ребер Kn nри н ечетном                          n

Изобразим Kn правильным n-угольником с диагоналями. Выберем длЯ каждой
его стороны свой цвет. Любая диагональ будет параллельна какой-то стороне,
в цвет этой стороны и выкрасим диагональ. Поскольку смежные отрезки (стороны
и диагонали) не параллельны , полученная раскраска будет правильной.
     В случае четного n правильную раскраску в n - 1 цветов можНо получить
следующим образом. Сначала раскрасим правильным образом подграф Kn- l · Вер­
шину, не вошедшую в данный подграф, обозначим v . Для каждой вершины и
подграфа будем иметь n - 2 инцидентных ребер, покрашенных во все цвета, кроме
цвета противоположной (в n - 1 -угольнике) стороны. Используем этот цвет для по'­
краски ребра uv . В результате любые два смежных ребра графа будут разного цвета.
     Обратимся теперь к регулярному двудольному графу K�.n .
     Без потери общности преДположим, что т :::;; n . Составим латинсl(ий пря­
моугольник А = (ai;) размера т х n и будем считать, что aij обозначает цвет
ребра, соединяющего i-ю вершины первой доли с j-й вершиной второй до­
ли. При этом получится правильная раскраска Кт n в n цветов. Поскольку
Хе (Кт ,n ) � D.(Kт ,n) = n, делаем вывод: Xe(Km,n) = n .'
     В общем случае, Xe(Km,n) = mах{т, n} . Этот результат можно существенно
у<:илить.
§ 8. Теорема Sёржа _...:.-'--- 1 61


Теорема 10.   Пусть G � двудольный граф. Тогда Xe(G)   :=;   �(G).

• Положи м k = �(G) . Поскольку Xe(G) � k, достаточно указать способ пра­
вильной раскраски графа G в k цветов.
    Покаже.м, как расширить граф G до реzулярного двудольного графа, в котором
степени всех вершин равны k.
    Рассмотрим дизъюнктное объеди f{ение k эк:1емпляров графа G, считая при
этом, что первые доли указанных графов объедИняются в первую долю нового
графа, а вторые доли - во вторую. Возьмем произвольную вершину и первой доли
исходного графа, стеnень которой меньше k. Введем во вторую долю строящеrося
графа k - p(u) новых вершин, соединив каждую из них со всеми k «клонами»
вершины и . Теперь степень клонов и станет равной k. Новые вершины также
имеют эту стеnень. Затем аналогично поступим с вершинами второй доли, степень
которых .меньше k. В результате nолучится реzулярный двудольный граф G' ,
имеющий nодГрафом исходный граф G.
    Результаты § 4 nоказывают, что граф а расnадается на k совершенных
паросочетаний. Покрасив ребра каждого парасочетания в свой цвет, получим
правильную раскраску графа G1 , а заодно и графа G. .,..
    Заключительные параграфы данной главы посвящены алгоритмам решения
различных задач, связанных с паросочетаниямИ.


§ 8. Теорема &ё ржа
Пусть М - ш{росочетание в графе G (не обязательно двудольном). Ребра, входя­
щие в М, назовем черными, а остальные ребра графа - белыми. Простая цеnь -
чередующаяся (относительно М), если любые два соседи� ребра в этой цеnи раз­
ного цвета. Вершину, покрываемую некоторым ребром из М, назовем насыщенной
(относительно М); в противном случае вершина - неиасыщенная (или свободная)
(относительно М). ·
     Если в графе имеется чередующаяся цепь, соединяющая две неиасыщенные
вершины, то легко получить новое паросочетание, в котором на одно ребро
больше, чем в М: достаточно поменять цвета ребер указанной цепи. Поэтому
такую цепь называют увеличивающей относительно М; или М -увеличивающей.
Очевидно теперь, что относительно наибольшего парасочетания увеличивающей
цепи не существует. Оказывается, верно и обратное.

                          Паросочетание М в графе G является наибольшtЩ тогда
Теорема 1 1 (К. J;ipж, 1957 r.).
и только тогда, когда в G не существует увеличивающей относительно М цепи.

•  НеобходШ1ость уже доказана. Убедимся в достаточности.
    Пусть паросочетание М не допускает увеличивающей относительно себя
цепи, а М' некоторое наибольшее паросочетание. Рассмотрим подграф графа G,
              -


образованный ребрами из симметрической разности М !:::. М1 • В нем степень
каждой вершины не превосходит 2, в силу чего этот подграф распадается на циклы
162   -------                                                                Гnаеа LXXI .   ПаросочетаНИII

и простые цепи. Поскольку в цикле ребра из М и М' чередуются, цикл имеет
четную длину. Чередование происходит и в каждой цепи. Цепь не является
увеличивающей ни относительно М (по условию теоремь1), ни относительно М'
(наибольшего паросочетания) .. Отсюда �ытекает, что .длина цепи является четным
числом. Стало быть, в симметрической разности М !:::. М' поровну ребер из М
и М' , а множества М и М' равномощны, то есть М, как и М' , является
наибольшим паросочетанием. lil>



§ 9 . Н ахожден и е н аибол ьшего п арасочетания
Теорема Бёржа обосновывает корректность следующего способа нахождения наи­
большего парасочетания в графе.
  1. Построить Произвольное парасочетание М.
 II. Искать М-увеличивающую цепь.
lll. Если такая цепь Р наЙдена, то заменить М на М !:::,. Р и перейти к шагу П.
       В   цротивном случае закончить работу (текущее парасочетание М является
       наибольшим).
       В   случае   двудольного графа       поиск М-увеличивающих цепей происходит до­
вольно просто. Исnользуем для этого механизм nометок.

Алгоритм А
  1 . Построить какое-нибудь парасочетание М.
 2. Свободные относительно М вершины из доли V1                     помеТить нулем, остальные
       вершины считаются непомеченными.
  3. Для     каждой помеченной на предыдущем шаге вершины щ                            Е Vi   пометить
       ее номером        i   все непомеченные вершины из     V2 ,   которые соединяются с щ
       белыми ребрами.
       Если при этом окажется помеченной свободная вершина, то М -увеличиваю­
       щая цепь Р наЙдена; она восстанавливается по меткам, начиная с указанной
       вершины: метка вершины есть номер очередной вершины Р. УвелЩ�иваю­
       щую цепь перекрасить (т. е. заменить М на М д Р) и перейти к шагу                            2.
       Если ж е новых пометок н а этом шаге не возникает, перейти к шагу                       5.
  4.   Для каждой помеченной на предыдущем шаге ,вершины щ                Е V2 пометить ее
       номером      j   непомеченную вершину из      V1 , которая соединяется с щ черным
       ребром. Если новых пометок            на этом шаге не возникает, перейти к шагу S, '
       иначе вернуться к щагу          3.
  5.   Текущее парасочетание М является наибольшим. Конец работы.
       Проиллюстрируем работу изложенного алгоритма на следующем примере.
       Для графа на рис.         3   текущее парасочетание М состоит из ребер, изобра­
женных двойными линиями. НапомнИм, что ребра из М мы называем черными,
а остальные ребра графа - белыми. Свободные вершины изображены двойными
кружками.
       В   доле   Vt    только одна свободная вершина - с номером                 2;   она помечается
нулем (пометки - это числа в прямоугольниках). Белые ребра (изображены тон­
кими линиями) соединяют эту вершину с вершинами                     8   и   12,   которые получают
пометку     2.
О 9. Иахоwдение намбоnьwеrо паросочетанмя   --------'-                                        163




                                ш           ш    ш              ш       ш
                                            Рис. 3

      Черное ребро    8-3 дает пометку 8    вершине        3;   черное ребро 12-5 дает пометку
12 вершине 5.
      Из вершины 3 к пеломеченным вершинам ведут два белых ребра,. и их другие
концы - вершины    9 и 11 - получают пометку 3. Аналогично, у вершины 10 воз­
никает пометка 5.
    Далее помечаются вершины из первой доли: 4 , l и 6.
    Наконец, удается пометить свободную вершину 7 из второй доли - номером1.
Идя по пометкам, начиная с этой вершины, находим М-увели чивающую цеnь:
7-1-10-5-12-2.      Перекрасим ее ребра и nолучим новое (более мощное, чем ранее)
парасочетание (рис. 4) .




                                            Рис. 4   ·




      Построенное парасочетание является совершенным (оно покрывает все вер-
шины графа), значит, и наибольшим.
      Замечание 1. Алгоритм А. является, по суги, «Проекцией• алгоритма Форда-Фалкер­
      сона нахождения максимального nотока в сети (см. § 16 rл. LXX).
    Подробно nоясним этот тезис. Превратим двудольный граф                   G(V1, V2)   в транс-
портную сеть следующим образом:
  •   ориентируем каждое ребро        щщ в направлении от Vj к V2;
  •   к множеству вершин графа добавим источник а и сток           Ь;
  •   проведем дуги из источника а ко всем вершинам из         Vj ;
  •   из каждой вершины доли         V2 проведем дуrу к стоку Ь;
  •   nоложим nропускцые способности всех дуr равными единице.
Сушествует взаимно однозначное с оответствие между допустимыми целочис­
ленными потоками в этой сети и парасочетаниями исходного двудольного графа:
по каждой дуrе сети, соответствующей ребру               G(V1 , V2) , входящему (н� входящему)
в nаросочетание, идет· единичный (соответственно нулевой) поток. При этом
164 --------.....,.-�--..,.,. Глава LXXI. Парооочетанмя

максимальному (по включению) nарасочетанию будет отвечать nолный поток.
М-увеличивающей цепи
                                       иа   - vp -   и1     -      • • •    -   VUJ                              (1)
соответствует цепь транспортной сети:

                              а --"* иа --"* Vp f-   1L.y   --"*    . • •   --"* Vw --"*   Ь.                    (2)
Перекраска ребер в U:епи         (1)   суть увеличение потока вдоль цепи                            (2).   Например,
ребро иа - vp бьто белым, а стало черным, соответственно поток по дуге иа ---* vp
из нулевоrо превратился в единичный; следующее ребро цепи и1 - vp из черноrо
стало белым, а поток по дуrе иа """*          vp   стал нулевым.

       Замечание 2. Несложно оценить трудоемкость данного алгоритма. Пусть n - число
       вершин в доле Vj (без ограничения общности можно считать, что в Vj вершин не бо­
       лее, чем в V2), а т - число ребер графа G(V1, V2) . Тогда nри работе алгоритма будет
       выполнено не более n итераций (итерацию составляют шаги 2, 3 и 4), а на каждой

       Если IVi 1 11121 n , то имеем оценку трудоемкости, зависяшую только от числа
       итерации порядка O(m) действий. Стало быть, общее число операций есть O(nm) .
                  =      =


       вершин: O(n3) .
       Замечание З . Разработаны весьма изощренные алгоритмы нахождения наибольшего па­
       росочетания в nроизвольнам графе (в общем случае, не двудольном), также имеюшие
       трудоемкость O(n3), где n - количество вершин графа.


§ 1 О . Н ахождени е н а имен ьшего
        вершинного покрытия
Вновь ограничимся случаем двудольного графа.
       Оказывается, изложенный выше алгоритм                               А нахождения наибольшеrо паро­
сочетания заодно позволяет обнаружить и наименьшее вершинное покрытие.
       Пусть    АС    Vj и   ВС�        множества помеченных вершин обеих долей графа
G(Vj , � ) · п о окончании работы алгоритма                 А. Обозначим                    1   Vi \ А.

Теорема 1 2.    Множество А U В является минимальным вершинным покрытием графа
G(V, , � ) .


-с Пусть М - наибольшее парасочетание в графе G(V1 , V2) , построенное в ре­
зультате работы алгоритмаА. Ребра, входящие в                                    М, как и ранее, мы называем
черными; а остальные ребра графа для нас белые.
       Доказательство теоремы разобьем на ;rри этапа.

  1.   Докажем, что     концы любого черного ребра либо оба помечены, либо оба не поме­
       чен ы.
       Возьмем Произвольное черное ребро иv , где и                  Е vl ' v Е v2 .
       Если вершина      v   помечена, то на шаге            4 алгоритма А пометку получит и вер­
       шина и .
       Рассмотрим теперь случай, когда вершина v н е помечена. Тоrда непомечен­
       ной будет и вершина и. Действительно, и, будучи насыщенной вершиной,
§ 10. нахождение наименьwеrо верwинноrо nокрытиt ------- 165
    не помечается на 2-м шаге. Но и на 4-м шаге вершина u не получает пометку,
    так как она инцидентна единственному черному ребру         uv , а другой его  -


    конец не помечен.
    Утверждение дока:)ано.
 2. Проверим, что С А U В        вершинное пок:рытие графа.
                                        -



    Возьмем в графе G(V1 , V2) проиэвольное ребро е = uv , .где и Е V1 , v Е V2 .
    Докажем, что и !/; А или v Е В .
    Если это н е так, то u Е А (то есть u        помеченная вершина) и v � В
                                                            -


    (v    непомеченная вершина) . Тогда в силу угверждения 1 ребро е не может
          -


    быть черным. Но оно и не белое, nоскольку при nомеченной вершине и
    и белом ребре uv на 3-м шаге алгоритма А. вершина v получила бы пометку.
    Противоречие nолучено.
 3. Заметим, что (благодаря утверждению 1)
      l) количество черных ребер с помеченными концами равно !B I        количе­            -



         ству помеченных вершин из доли V2 (каждая из них инцидентна одному
         черному ребру) ;
      2) количество черных ребер с непомеченными концами равно IAI         коли­                -


         честву непомеченных вершин из доли Vj (любая такая вершина насы­
         щенная, и из нее также исходит ровно одно черное ребро) .
    Таким образом,
                             IMI = IB I + 111 = /A U BI,
    то есть вершинное покрытие А U В равномощно наибольшему паросочета­
     нию. В силу венгерской теоремы это означает минимальность вершинного
    покрытия. .,.
     Как отмечалось в § 3, доnолнение :к наименьшему вершинному nокрытию
графа является его наибольшим независимым множеством вершин. Значит, мно­
жество A u В нанбольшее независимое. Стало быть, алгоритм А. (имеющий, как
мы выяснили, полиномиальную трудоемкость) позволяет наряду с наибольшим
парасочетанием в двудольном графе найти также . наименьшее вершинное nо­
крытие и наибольшее независимое множество. Известно, что задачи определения
наименьшего вершинного покрытия и наибольшего независимого множества для
произвольнога графа являются NР-полными,
другими словами, Для них нет эффектив- Ш          GJ Ш
ных алгоритмов решения {по крайней мере,
они nока не известны науке) . Очень важно,
что для двудольных графов, возникающих
во многих практических задачах, nолиноми­
альные алгоритмы решения указанных задач
существуют!
       Прммер. На рис. 5 изображен граф, в котором
       выщелено наибольUJее nарасочетание и рас-
                                                                Ш         Ш
       ставлены nометки, возникающие по окончании                                 Рис. S
       работы алгоритма   .А..                        ·
           Имеем    А     { 1 , 2, 3}; В = {6, 7} .    значит, вершины       4, 5 , 6 и 7 образуют мини­
       мальное вершинное nокрытие, а вершины            l, 2,   3, 8,   9, 10 - наибольшее независимое
   ·   множество.
1 66 -----'- Глава LXXI . Паросочетания

§ 1 1 . Венгерский алго ритм
 Пусть G(Vi , V2 )
                -     взвешенный полный двудольный граф Kn,n с матриuе� весов
ребер С = (ciJ), где Ctj � О есть вес ребра, соединяющего i -ю вершину доли Vi
 с j -й вершиной доли V2 .
      В задаче о назначениях требуется найти совершенное паресочетание мини­
мального веса (ниже будем называть такое паресочетание оптимальным). Название
 задачи объясняется следующей ее трактовкой. Пусть ·щ         i-й работник, Vj
j -я работа, а Cf.j
                                                          -



                  -     стоимость выполнения i -м работником j-й работы. Тоrда
 совершенное парасочетание наименьшего веса описывает такое распределение
 работ между работниками (н.азн.ачение работников на: работы), при котором каж­
дый работник выполняет ровно одну работу, а суммарная стоимость выполнения
 работ минимальна.
       Заметим, что если к весам всех ребер, инцидентных пекоторой фиксирован­
 ной вершине, nрибанить одно и то же число (не обязательно положительное),
 то упорядоченность совершенных nарасочетаний графа по их весу не изменится,
·поскольку каждое такое ларесочетание содержит ровно ·9дно ребро с измененным
 весом. Назовем такую олерацию приведением. Для матрицы весов приведение озна­
чает прибавление конста1Ffы ко всем элементам некотороrо столбца или строки.
       С помощью операций приведения легко свести задачу. к графу, в котором
 каждая вершина инцидентна пекоторому ребру нулевого веса (будем называть
 такие ребра н.улевыми), и nри этом веса всех ребер остаются неотрицательными
 числами. Если в таком графе существует совершенное nарасочетание нулевого веса
 (в матрице весов ему соответствуют n независимых нулей), очевидно, оно и будет
 решением задачи. Основная идея излагаемого ниже венгерского алгоритма (Г. Кун,
 1955 r.) состоит в том, что в результате поиска М-увеличиваюшей цепи в G(V1, V2),
 где М - ларесочетание из нулевых ребер, удается найти такие олерации лриведе­
 ния, в результате которых количество нулевых ребер увеличивается. В некоторый
 момент возникает граф, в котором есть совершенное ларасочетание нулевого веса.
Аяrоритм В
  1. Из каждой строки матрицы С вычесть ее минимальный элемент. Так же
     поступить со столбцами.
  2. Пусть N - множество нулевых ребер текушеrо графа G G(V1 , V2) (с матри­
     цей весов С). Найти в графе G' = (Vj U V2, N} с помощью алгоритма .А. наи­
     большее паросочетание М, беря в качестве начального ларесочетания текушее
     наибольшее ларасочетание (если шаг 2 алгоритма 8 выполняется не вnер­
     вые). Если най.денное ларасочетание М - совершенное, то конец работы.
 3 . Пусть А С Vi В С
                    и      V2   множества помеченных вершин обеих долей графа
     G по окончании работы алгоритма .А. (напомним, что лометки расставляются
     с целью найти М-увеличивающую цель). Вычислить d         -наименьший вес
     ребра, соединяющего nомеченную вершину из V1 с пеломеченной вершиной
     из V2 . Из всех строк, отвечающих вершинам из А , вычесть число d. Ко всем
     столбцам, отвечающим вершинам из В , лрибав'ить число d. Перейти к шагу 1 .
Обоснуем корректность алгоритма 8 . Во-первых, применяемые в нем опера�
ции приведения не меняют множества оптимальных паросочетаний. Во-вторых,
§ 1 1 . Венгерский апrоритм   ------                                         167

алгоритм заканчивает работу, когда обнаруживает в двудольном графе с неотри­
цательными весами ребер совершенное парасочетание нулевого веса. Осталось
убедиться, что такой момент непременно наступит.
     После первого шага работы алгоритма получаем граф, в котором каждая
вершина инцидентна хотя бы одному нулевому ребру. Поэтому после шага 2
все вершины из V1 , не покрытые текушим паросочетанием, помечены. Значит,
на шаге 3 множество А непусто. С другой стороны, если найденное в результате
выполнения шага 2 парасочетание не является совершенным, это означает, что
не все вершины из V2 удалось пометить - значит, непусто и множество В = V2 \В.
Вес любого ребра, соединяющего вершину i из А с вершиной j из В, положителен,
так как в противном случае по алгоритму А вершина j должна была бы получить
пометку. Таким образом, d > О .
     Посмотрим, что nроисходит с весами ребер на шаге 3.
     Веса ребер из G(A, В) не меняются.
     Ребра из подграфа G(A, В) сохраняют свой вес, поскольку первоначальное
вычитание числа d компенсируется последующим его прибавлением.
     Вес каждого ребра из G(A, В) увеличивается на d.
     Поскольку d > О - наименьший вес ребра в графе G(A, В) , после шага 3
в этом подграфе nоявится хотя бы одно нулевое ребро.
     Значит, nосле шага З веса всех ребер остаются неотрицательными. Как бьmо
отмечено в предьщущем параграфе, концы любого черного ребра либо оба поме­
чены, либо нет. В первом случае ребро входит в G(A, В) , во втором - в G(A, В) .
Таким образом, после шага 3 ребра текушего максимального парасочетания М
остаются нулевыми. С другой стороны, ребра из G(A, В) , ставшие нулевыми, при
nоследующем выnолнении шага 2 расширяют множество В. Поэтому на неко­
торой итерации будут найдены М-увеличивающая цепь и новое, более мощное,
парасочетание М. Рано или поздно в текущем графе будет существовать совер­
шенное паросочетание из нулевых ребер.
     Проиллюстрируем работу алгоритма В следующим примером.
     Пусть веса ребер графа К4,4 задаются матрицей




                                   о � � ;)
После вычитания минимальных элементов строк        я   столбцов nоследовательно
получим матрицы




                              (� � ! i) (� � ! �)
                                       и


Построим граф G' , образованный нулевыми ребрами (текушего) графа G (рис. 6).
    Вьщелим в нем максимальное по включению парасочетание (его ребра изоб­
разим двойными линиями) и осуществим nроцесс расстановки пометок согласно
алГоритму А. Пометки последо�ательно получают вершицы 2, 5, 1 , 6, 3 (рис. 7).
168   __________                 .;...____________                   Dlaвa LXXI. Перосоitетанмн




                       Рис. 6                                 Рис. 7

      Таким образом, множество помеченнЪIХ вершин из Vi и V2 есть            А = { 1 , 2, 3}
и   В = {5, 6}   соответственно. Теперь в матрице весов подграфа         G(A, В) , образо­
ванной тремя верхними строками и двумя последними столбцами матрицы             С, на­
хоДим нЩtменьший элемент:        d = 1 . В результате вычитания числа d из стро�, отве­
чающих А, а затем прибавления       d к столбцам, отвечающим В, возникают матрицы




                                        ( =� -� ; ;) (� � ; ; )
                                          -1 -1 о 1
                                           1 1 0 0
                                  Возвращаемся к шаrу
                                                             й
                                                                       о о о 1
                                                                       2 2 0 0
                                                            2. Теперь имеем граф G',
            Рис. 8                изображенный на рис.     8, в котором существует со-
                                  вершенное паросочетание. Итак, оптимальное па­
росочетание состоит из ребер      1-6, 2-5, 3-7, 4-8,   а его вес, как легко подсчитать,
равен   12 (разумеется, в   исходном графе) .
      В заключение - несколько замечаний.

      Замечание 1 . Трудоемкость алгоритма 8 оценивается как O(n4) оnераций. Известны
      модификации венгерского алгоритма, имеющие трудоемкость O(n3).
      Замечание 2. Часто рассматривают также задачу нахождения во взвешенном двудольном
      графе совершенного nаросочетания наибольшеео веса. Читателю nредлагается подумать
      Над тем, как Преобразовать матрицу весов ИСХОДНОГО графа, чтобы nерейтИ К графу,
      в котором оnтимальное паросочетание (наименьшего веса) соответствует nаросочета­
      нию наибольшего веса в исходном графе.



§ 1 2. Задач а о н аз н ач ениstх н а узкое место
Пусть на некотором конвейере (поточной линии) имеется n рабочих мест. Мастер
должен расставить по этим местам n работников. Известна производительность
труда Cij   i-ro работника на    j -м   месте. Производительность конвейера опреде­
ляется минимальной производительностью занятых на нем рабОтников. Рабочее
место, на котором реализуется минимальная nроизводительность при заданной
расстановке работников (Другими словами, при заданном            назначении) , и есть узкое
место этого назначения.
Уп�и•     ------                                                                      1 69

      Нужно помочь мастеру «сделать узкое место как можно шире»: найти такое
распределение работников по рабочим местам, при котором скорость конвейера
(т. е. минимальная производительность занятых работников) будет максимальной.
       На языке теории графов задача состоит в выделении во взвешенном двудоль­
ном графе такого совершенного паросочетания, в котором наименьший вес ребра
будет наибольшим.
       Другими словами, требуется найти такое наибольшее число f , при котором
в графе сутествует совершенное парасочетание М, составленное из ребер, чей
вес не меньше f (паросочетание М и будет искомым).
      Это можно сделать с помощью дихотомического поиска. Суть его в том, что на
каждом шаге множество, содержащее искомое значение, сокращnется вдвое. В опи­
сываемом ниже алгори1:ме индексы а и Ь задают границы указанного множества.

Алгоритм С
 1.   Отсортировать ребра по возрастанию веса, получив  массив w 1 , w2,  , Wn2 ·
      Положить а = 1 , Ь = n - n + 2 .
                            2                    .                            • • •



 2.
 3.   Если а = Ь 1 , перейти к шагу 6.
                 -




 4.   Положить k = (а!Ь] , f = Wk ·
 5.   С помощью алгоритма .А. искать совершенное парасочетание в подграфе G'
      графа G , образованном ребрами, чей вес не меньше f .
      Если такое парасочетание найдено, то объявить его текутим и положить
      а = k. В противном случае положить Ь = k.
      Перейти к iuary 3 .
  6 . Teкyrnee парасочетание является оптимальным. Конец работы.
      Нетрудно оценить число операций при выполнении алгоритма С . Наиболее
трудоемкий шаг 5 выполняется примерно log2 (n2 - n + 1) = O(log2 n) раз. Поэтому
общая трудоемкость - O(log2 n n3 ) операций. В случае использования вместо
                                    ·



А более эффект�вного алгоритма трудоемкость алгоритма С соответственно
понизится.


                                        Упражнении
     Перманент квадратной матрицы есть сумма всевозможных nроизведений ее элемен­
     тов, взятых по одному из каждой строки и каждого столбца. Пусть А
  1.
                                                                             -    двоичная
     матрица размера n х n. Доказать, что ее nерманент равен нулю тогда и только тогда,
     когда в А существует i строк и j столбцов, где i + j � n + 1 , на nересечении которых
     стоят одни нули.
  2. В пекотором районе, состоящем из нескольких деревень, число женихов равно числу
     невест. В каждой деревне общее число женихов и невест не больше nоловины общего
     их числа. до!Giзатъ: можно всех nереженить так, что в каждой паре жених и невеста
     будут из разных деревень.
  3. На танцевальном вечере каждый юноша знаком с k девушками, а каждая девушка зна­
     кома с k юношами. Доказать, что можно nровести k (медленных) танцев так, чтобы
     каждый участник вечера станцевал со всеми своими знакомыми (противоnоложного
     nола) .
  4. На щахматной доске nометили 16 из 64 клеток так, что на каЖдой вертикали и гори­
     зонтали оказалось по две nомеч�::нные клетки. Доказать, что на помеченных клетках
170   ------                                                           Глава LXXI . Парасочетания

       можно расставить 8 черных и 8 белых фигур так, чтобы на каждой вертикали и каждой
       горизонтали стояло по одной белой и одной черной фигуре.
  5. Вуз посылает 8 юношей и 8 девушек на стажировку по восьми специальностям в 8
       зарубежных университетов, причем каждый университет принимает по два человека
       и учит их двум разным специальностям, и каждой из восьми специальностей учат
       два университета. Всегда ли можно так распределить студентов, чтобы в каждом
       университете стажировались юноша и девушка, и при этом как юноши, так и девушки
       обучались (в совокупности) по всем восьми специальностям?
  6. Выполняя домашнее задание, каждый студент группы решил по 4 задачи. Известно,
       что каждая задача бьmа решена четырьмя студентами. Доказать, что можно организо­
       вать разбор задач та1', чтобы каждый студент рассказал решение ровно одной задачи
       и чтобы все задачи были разобраны (по одному разу).
  7. Имеются 27 карточек с числами от 1 до 27. Двое показывают следующий фокус.
       Первый получает четыре карточки, выбранные случайным образом. Одну из них он
       убирае:r, а три оставшиеся выкладывает в ряд. Второй должен назвать спрятанную
       карточку. Moryr ли участники договориться так, чюбы по выЛоженным карточкам
       можно бьmо узнать спрятаннуЮ?
  8. Пусть в двудольном графе G(Vi , Vi) степень любой вершины из Vi не меньше k,
     а степень любой вершины и з V2 н е больше k , где k некоторое натуральное число.
                                                           -


       Доказать, что в этом графе существует совершенное паросочетание.
  9. [Одномерная теорема Хелли.]   Если отрезки прямой попарно пересекаются, то найдется
                                                           Доказать.
 10. На прямой расположено mn + 1 отрезков. Доказать, что из них можно выбрать т + 1
       точка, принадлежащая всем отрезкам одновременно.


       поnарно непересекающихся отрезков или n + 1 отрезков, имеюших обшую точку.
 1 1 . Доказать, что в последовательности из n2 + 1 различных действительных чисел най­
       дется монотонная подnоследовательность длины n + 1 .
 12.   Имеется множество юношей, каждый из которых знаком с некоторыми девушками.
       Две свахи знают, кто с кем знаком. Первая сваха заявляет: «Я могу одновре�енно
       женить всех брюнетов так, чтобы каждый из них женился на знакомой ему девушке!»
       Вторая сваха говорит: «А я могу устроить судьбу всех блондинок: каждая сможет выйти
       замуж за знакомого юношу! .. Этот диалог услышал любитель математики, который
       сказал: «В таком случае я могу сделать и то, и другое!» Прав ли он?
 13.   Найти наибольшее nарасочетание и наименьшее вершинное nокрытие в двудольных
       графах с матрицами смежности:

                         1 1 о     1 о о"              1 о о о о           о
                         о 1 о     о о 1               о 1 о о о           о
                         о 1 1     о о о               1 1 1 о о           о
                                                           1 1 о
                    а)                            б)
                         о о 1     о 1 1               о 1                 о
                         о о 1     1 о 1               о о о 1 о           о
                         о   о     о   о               о о о о 1           1
                                   о 1 о о       о 1 о      1 о
                                   1 о 1 1       о о о      о о
                                   о 1 о 1       о о о      1 о
                                   о 1 1 1       1 1 о      1 1
                              в)   о о о 1       о   о      1 о
                                   о 1 о о       о   о      1 о
                                   1 о 1 1       о   1      о 1
                                   о 1 - 0 1     о   о      о о
                                     о о 1       010 о        о
Ответы                                                                                                             171

 14. Решить задачу о назначениях для двудольных графов с матрицами весов:
                                                                                 7     4    00   6    4        6




          ( } (j 1)
              '   2       l       9            3       2       4
                                                                                 5     2    8    о    00       4
              9   6       9       5            1       3       2
                                                                       в)
                                                                                 4     00   2    5    6        5
     а)       3   8       3       1       б)   3       2       5
                                                                                 8     о    7    00   3        1
              7   9       4       2            2       1       4
                                                                                 о          о    00   о        о
              8   4       7       4            5       1       3
                                                                                 00    00   2    4    1        7
 15. Найти максимальные по весу совершенные паросочетания в двудольных графах с мат-
     рицами весов:




           (! �) ·{ �)
                                                                                      6 2 2 8 8            9
                      2       1       9            3       2       4                                       1
                                                                                      4 1 9 3 5
                      6       9       5            1       3       2
                                                                            в)
                                                                                      6 о 5 9 о            6
         а)           8       3       1            3       2       5
                                                                                      j 3 8 9 11          '4
                      9       4       2            2       1       4
                                                                                      7 4 о 2 2            1
                      4       7       4            5               3                                       6
                                                                                      8 3 8 2 9
 16. Решить задачу о назначениях на узкое место для графов из задачи 15.

                                               Ответы

1 , Докажем необходимосlпь (достаточность устанавливается обратным ходом рассуждений) .
      Первое решение (венгерская теорема). По условию задачи, в матрице А не найдется n
независимых единиц, то есть ее словарный ранг меньше n. Применим венгерскую теорему.
Согласно этой теореме, матрицу А покрывают некоторые i' строк и j' столбцов, где
i' + j' < n. Оставшиеся i = n - i' строк и j = n - j' столбцов в своем пересечении имеют
только нули. Осталось заметить, что i + j = 2n - (i' + j') > n, откуда i + j � n + 1 .
      Второе решение (теорема Холла). Пусть строки матрицы А отвечают юношам, а столбцы -
девушкам, и пусть условие ak1 = 1 означает, что k-й юноша знаком с l-й девушкой. Тогда,
по условию задачи, всех юношей женить на знакомых девушках нельзя. Согласно теореме
                                                                                           '
Холла, это означает, что какие-то i юношей знакомы в совокупности с не более чем
i - l девушкой и не знакомы с оставшимися девушками, а последних не менее n - i + 1 .
Значит, на пересечении i строк, отвечающих указанным юношам, и j � n ..:... i + l столбцов,
отвечающих не знакомым ни с кем из них девушкам, стоят одни нули.
7. Да. Указание. Рассмотрите двудольный граф, одна доля которого состоит из вершин,
образованных сочетаниями из 27 по 4, вершинами второй служат размещения из 27 по 3,
и ребро соединяет размещение с сочетанием, если все элементы размещения входят в со­
четание. Теперь нужно выяснить, сушествует ли совершенное паросочетание в этом графе.
9. Расположим прямую горизонтально. Искомой точкой является, например, самый левый

10. Считая прямую числовой, положим [а , Ь] -< [ с, d] , если Ь < с. Используйте теорему 5
из правых концов отрезков.                                                               1


и nредЫдущую задачу.
12. Прав. Решение. Отметим на прямой точки, изображающие юношей, а на парадлельной
nрямой - точки, изображающие девушек. ТоЧки, соответствующие брюнетам и блондин­
кам, покрасим соответственно в синий и желтый цвет. Остальные точки будем называть
белыми. Вариант образования супружеских пар, имеющийся у первой свахи, изобразим
синими отрезками, а вариант второй свахи - желтыми. Некоторые отрезки при этом станут
зелеными. Наща цель - найти ропарно не смежные цветные отрезки (то есть без общих
концов) , покрывающие в совокупности все цветные точки.
      Каждый зеленый отрезок не смежен ни с каким другим цветным отрезком. Ясно
также, что отрезки одного цвета попарно не смежны. Поскольку каждая цветная точка
172   ------                                                         Гпава LXXI . Перосочетания

является концом одного или двух цВетных отрезков, синие и желтые отрезки образуют
несколько ломаных (отрезок считаем частным случаем ломаной) без общих концов, причем
                                              ·             ·

цвета звеньев любой' ломаной чередуются.
      Если ломаная замкнутая, то ее звенья синего цвета покрывают все ее вершины,
поэтому можно стереть желтые звенья этой ломаной.
      Пусть теперь ломаная незамкнутая. Так как каждая цветная точка порождает св.ой
цветной отрезок, концы ломаной не могут быть оба белыми (ин.аче цветных точек будет
меньше, чем цветных отрезков) . Возьмем цветной конец ломаной и пойдем по ней. Другой
ее конец будет белым, так как в каждую цветную точку мы попадаем, идя по отрезку другого
цвета, и, значит, ломаная продолжается отрезком цвета этой точки. Таким образом, звенья
ломаной, имеющие цвет ее цветного конц_а, покрывают все ее цветные вершины. Звенья
другого цвета стираем.
      В результате у нас останутся цветные отрезки без общих концов, покрываюшие все
цветные точки. Задача решена.
13. а) U1V, , UzVб, U3V2 , U4V3, U5V4, U6Vs ; u , , Uz, Uз , U4, Us, U6 ;
     б) u,v, , tlzVz, tlзVз, t1sV4, tlбv6 ; 1.16, v,, Vz, Vз V4 ;
                                              .•


     В) U1V2, UzVз, UзV4, U4V5, tlsV6, UбVs, U7V7, ti9V1 ; Uz, U4, tl7, Ug, V�, V4, Vб, Vg .
14. а) u 1vз , tlzV4, u3v1, U4V5, usv2 ;
     б) u1v, , u2v4, uзvз, u4vz , UsVs ;
     в) u,vz, u2 v4, u3vз, u4v6, иsv,, uбvs .
1 5. а) u,v4, UzVз, UзVs, t14Vz, UsV1 ;
     б) U1Vs , UzVз, U3V4, ti4V1 , UsVz ;
     В) U1 Vб, 'UzVз, 'UзV4, U4V5, UsV2, tlбVI .
�ава LХХН                 ___________________________




                                       МАТРОИДЫ


       Матроиды были введены в             1935 г.   Пионерская работа Хасслера Уитни назы­
валась "On the abstract properties of linear dependence"                ( «Об абстрактных свойствах
линейной зависимости» ) . Уитни обнаружил, что понятия зависимости в линейной
алгебре и теории графов можно рассматривать с единых позиuий . Именно синтез
идей различных областей математики и является основой плодотворного развития
теории матроидов.
       Матроидные структуры естественным образом возникают в теории комбина­
торной оптимизации, являясь основой применения                        жадных. алгоритмов.   Исследо­
вания в этой облас:rи начались в конце 50-х rодов прошлого века. ПоЗднее теория
матроидав нашла свое применение и nри анализе надежности электрических схем.
                              '                                               .




    Конец ХХ века ознаменовался бурным развитием криnтографии: В так назы­
ваемых идеальных схемах раздмения секрета также возникли матроидные струк­
туры.
       В   этой главе nредставлены начальные понятия теории матроидов, включая
связь. матроидов с жадными алгоритмами и теорией трансверсалей.




§ 1 . Определения и примеры
Матроид      -     это уnорядоченная пара М            �   (Е, J) ,   rде   Е - непустое конечное
множество;       J   -   совокупность подмножеств множества                 Е, удовлетворяющая сле­
дующим условиям           (аксиомам независимости):
(JO) 0 Е J ;
(Jl) если А Е J и В С А , то В Е J ;
(J2) если А Е J, В Е J и IAI = ]В] + 1 , то существует такой элемент е, принад­
     лежащий А и не принадлежащий В , что В U {е} Е J.
     Элементы множества J называют независимыми множествами. Таким обра­
зом, аксиома (Jl) говорит о том; что подмножество независимоrо множества также
являетс.я независимым, а аксиома (J2) утверЖдает: если имеются два независи­
МЪIХ множества, мощности которых отличаются на единицу, то в более мощном
                                                   '
множестве есть элемент, который отсутствует в менее мощном, и при добавлении
которого к последнему вновь nолучится независимое множество.
       Базис   -     это максимальное по включению незавf{симое множество                    (то   есть
если    А - базис, А С В          и   А # В, то множество В не является независимым) .
       В   силу конечности множества          Е   в матроиде существует хотя бы один базис.
174   ------                                                  Dtaвa LXXII. Матромды

     Ранг .матроида - количество элементов в любом его базисе.
    Докажем корректность последнего определения: убедимся в том, что в любых
двух базисах количество элементов одинаково. От противного: пусть Имеются
два различных базиса А и В, и в множестве А элементов больше, чем в В .
Суmествует подмножество А' С А такое, что IA' j IBI + 1 . По аксиоме (Jl)
множестВо А'      независимое, а по аксиоме (J2) найдется элемент е Е А1 \ В
такой, что МiiОЖество В U {е} независимо, но тоrда множество В не является
максимальным по включению независимым множеством, то есть базисом -
противоречие!
     Очевидно, что максимальное по мощности независимое множество является
и максимальным по включению, то есть базисом. Таким образом, любое незави­
симое множество в матроиде М мощности, равной его ранrу, есть базис .
     Взяв произвольное независимое множество В и некоторый фиксированный
базис А с помощью свойства (J2) можно в множестве А выбрать IAI - IBI элемен­
тов, при добавлении которых к множеству В получится независимое м,ножество
мощности IA!, то есть базис. Мы доказали, что всякое независимое множество
можно дополнить до базиса.
    М,ножество А с Е, которое не является независимым в матроиде М {Е, J} ,
                                                                       =

называется зависимым.
    ЦuiUl - это минимальное по включению зависимое множество (то есть если
А - цикл, В с А и В f::. А, то множество В - независ�ое).
    Пусть дан матроид М (Е, J) . Машиость множества Е называют порядком
                          =

матроида   М.

Примеры матроидQв
  1 . 1)ивиальный: матроид - матроид (Е, { 0}) ; в нем единственным независимым
     множеством (значит, и единственным базисом) является пустое множество.
     Ранг тривиального. матроида равен нулю, а любое одноэлементное nодмно­
     жество множества Е является циклом.
 2. Дискретный матроид          матроид (E, {J(E)), где fJ(E) - множество всех
     nодмножеств множества Е. В дискретном матроиде все множества являются
     незавnсимыми, имеется единственный базис - само множество Е, а циклов
     вовсе нет. Ранг дискретного матроида равен ! Е ! .
 3 . k-однородный матроид - матроид (Е, J) , в котором любое k-элементное под­
     множество множества Е является базисом. Здесь любое множество, в котором
     не более k элементов, является независимым. Проверка выполненИя аксиом
     матроида тривиальна. Заметим, что дискретный матроид {Е, fJ(E)) является
     I Е \ -однородным , а тривиальный матроид - О-однородным. В k-однородном
     матроиде (nри k < IEI ) цюоюм является любое (k + !)-элементное мно­
     жество. Ранг k-однородного матроида равен k. Имеется специальное обо­
     значение для k-однородного матрома, заданного на n-элементном множе­
     стве: Uk,n·
 4. Пусть Е - конечная система векторов некотороrо линейного пространства
     над полем F, а J со�тоит из всех линейно независимых систем векторов
     из Е, а также пустого множества. Тогд�, как известно из линейной IUireбpы,
                                       1
§ 1 ; Опредеnени1 и примеры --------,...-- 175

     свойства (Jl) и (J2) будут выполнены. Свойство (JO) выполнено по опреде­
     лению. Поэтому (Е, J) - матроид. Его называют векторным I ) .
 5 . Пусть А - числовая матрица с элементами из поля F размера т х n . Будем
     смотреть на столбцы этой матрицы как на векторы пространства рт . Тог­
     да столбцы матрицы А образуют векторный матроид; будем называть его
     матричным матроидом, или (точнее) матроидом столбцов матрицы А . Обо­
     значение: М[ А] . Аналогично вводится матроид строк матрицы. Легко видеть,
     что ранг матрицы А равен рангу соответствующего матричного матроида.
                                                    '
 6. Пусть G - граф, Е - множество его ребер. Объявим независимыми те под­
     множества Е, которые состоят из ребер некоторого леса, Как известно из тео­
     рии графов, свойства (JO), (Jl) и (J2) будут при этом выполнены. Полученный
     матроид называют матроидом циклов графа G и обозначают М ( G) . ЦJ:iкл мат­
     роида будут составлять ребра, образующие простую замкнутую цепь в графе G
     (то есть цикл, в котором каждая вершина встречается ровно один раз).
 7. Пусть G· - граф, Е - множество его ребер. Объявим зависимыми те под­
     множества Е , которые - являются разделяющими множествами. Опять же
     из результатов теории графов следует выполнение аксиом матроида. П911у­
     ченный матроид называют матроидом разрезов графа G и обозначают М* ( G) .
     Циклу этого матроида будет соответствовать разрез графа G, а базису
     дополнение к множеству ребер любого остовнаго леса графа.

Изоморфизм матроидав
Матроиды      Mt =
                 (EI , J1 ) и М2     =
                                 (Е2 , J2) называются изаморфными, если суще­
ствует биекция (взаимно однозначное отображение) 'Р : Е1 -t Е2 , сохраняющая
независимость; другими словами; множество А С Е1 является независимым
в матроиде М1 тогДа и только тогда, когда образ этого множества при заДанном
отображении ср(А) есть независимое множество в матроиде М2 •

    на рис. 1 , изоморфен матроиду столбцов матрицы
    Пример;   Матроид циклов графа       G,   изображенного



    А=
          ( 1 о о 1 1)                         �
                              рассматривавмои над произ-
              1 1
              0   0 0     ,
    вольным числовым полем.


    Введем еще несколько определений.
    Матроид - графический, если он изоморфен                 Рис. l
матроиду циклов некоторого графа.
    Матроид - кографический, если он изоморфен матроиду разрезов некотqрого
графа.
    Наконец, если матроид является одновременно графическим и кографиче­
ским, то его называют планарным. Это название объясняется тем, что - планарный
матроИд изоморфен матроид-у циклов планарного графа.
    Для того -чтоб�r лучше освоиться с новыми понятиями, советуем читателю
решить соответствующие упражнения, помещенные в последнем параграфе этого
тома.

   J) И ногда дают более узкое определение векторного матроида, предполагая, что
                  .

      векторы из системы Е попарно различны .
176 -------                                                           l'mlla   LXXII. MIТpOIWil

§ 2 . Двойственность
Пусть М � (Е, J} - матроид. Обозначим через J* множество всех подмножеств
дополнений к базисам матроида М. ·оказывается, что М* � (Е, J* ) - также мат­
роид; его называют двойственны.м к М матроидом. Легко видеть, что базисы двой­
ственного матроида - это дополнения к базисам исходного матроида. Отсюда сра­
зу выт.екает, что (М*)* = М , - матроид, двойственцый двойственному М, есть М.

Теорема 1 . Для любого графа G .матроид его разрезов является двойственным .матро­
иду Ци/(//ов.

<1111 Пу�ть Е - множество ребер графа G . Можно считать, что в G нет изолиро­
ванных вершин.
       Рассмотрим произвольный базис В в матроиде циклов M(G) . Нужно дока­
зать, что Е \ В - базис в матроиде разрезов М*( G). Базис в М(G) есть остовный
лес графа G. Базис в М* (G) - максимальное по включению нера:щеляющее мно­
жество в графе G. При удалении из графа ребер, составляющих Е \ В, остается
остовный лес, т. е. число компонент связности графа не изменяется - поэтому
множество Е \ В не является ра:щеляющим. Если оно не максимально по вклю­
чению, то для некоторого ребра е � Е \ В нера:щеляющим ·будет множество
В' = Е \ В U {е} . Но тогда дополнение к В' содержит остовный лес W . Заметим
теперь, что I E \ B'l < IBI , откуда I W I < IBI , в то время как любые два остовных
леса (одного и того же графа) �меют одинаковую мощность.
       Обратно. Пусть D - базис в M*(G). Нужно убедиться в том, что Е \ D -
астовный лес. Поскольку D - нера:щеляющее множество, Е \ D покрывает все
вершины графа G. Если в Е \ D есть цикл, возьмем ребро е, входящее в него.
Тогда D U {е} - также нера:щеляющее множество вопреки предположению.
Значит, Е \ D - лес, и притом - остовный. .-

§ 3. Представимые матроиды
Матроид представим над полем F, если он изоморфен пекоторому векторному
матроиду над этим полем. Если матроид представим над любым полем, его
называют регулярны.м. В случае представимости матроида над полем GF(2) его
называют бинарны.м, а над полем GF(З) - тернарны.м.

Теорема 2. Графический .матроид является бинарным.


<1111 Нужно убедиться в том, что матроид циклов произвольнаго графа G представим
над полем GF(2) . Составим матрицу А = (aij) инцидентности графа G. Строки
этой матрицы соответствуют вершинам графа, а столбцы - ребрам. Если j -е
ребро есть петля, инцидентпая i-ой вершине, то aij = 2, Иначе

             аJ -
              I
               . .   _   {   1,   если i-я вершина инцидентна j-му ребру;
                             О    в противном случае.
§ 4. Paнrolia• Функци•    ------,..---,---�---                              111

Заменим в этой матрице двойки нулями, оставив для матрицы прежнее обозна­
чение.
    Итак, мы имеем составленную из нулей и единиц матрицу А. Петле rрафа
соответствует нулевой столбец, а столбцы, отвечающие кратным ребрам, - одина­
ковые. Докажем, что матроид столбцоц этой матрицы над полем GF(2) изоморфен
M(G) , то есть что столбцы линейно зависимы над GF(2) тогда и только тогда,
когда соответствующие им ребра rрафа G содержат цикл.
    Нетривиальная линейная комбинация векторов над указанным полем есть
просто сумма некоторых из данных векторов. Значит, если некоторые столбцы
матрицы         А
            линейно зависимы, то среди них можно выделить столбцы с нулевой
суммой. Рассмотрим подrраф G' графа G с ребрами, соответствующими этим
столбцам. Очевидно, степень каждой вершины в этом подrрафе есть четное число.
Стало быть, в G' естЪ цикл (хотя бы потому, что G' есть объединение эйлеровых
rрафов, а в эйлеровом rрафе есть эйлеров цикл; впрочем, и непосредственное
доказательство указанного факта весьма несложно).
    Обратно. Пусть некоторое множество ребер содержит цикл. Если среди
них есть петля, то отвечающий ей нулевой столбец обеспечивает Лf�Нейную
ЗаВtfСИМОСТЬ СТОЛбЦОВ.
    Рассмотрим теперь столбцы, отвечающие ребрам простого цикла длины
больше 1 . Любая строка матрицы              А
                                 содержит в этих столбцах ровно две единицы.
Поэтому сумма указанных столбцов (по модулю 2) равна нулевому столбцу, что
означает линейную зависимость исходного множества столбцов. ..,.
     Заметим, что имеется существенное усиление доказанной теоремы. Оказыва­
ется, любой графический матроид являетсЯ регулярным ; то же верно и для любого
кографического матроида.
    Кроме того, достаточным условием регулярности матроида является его пред­
ставимость над GF(2) и GF(3), то есть матроид регулярен тогда и только тогда,
когда он одновременно является бинарным и тернарным.


§ 4 . Ранговая функция
Пусть М = (Е, J) - матроид. Для множества          А
                                           С Е определим суЖение матро­
ида М на множество А как матроид M I A =         (А,
                                          J') , где множество J' образовано
всеми подмножествами множества    А, являющимися независимыми множествами
матроида М:
                        J' =    {Х 1 Х С А, Х Е J}.
  То, что MIA - действительно матроид, очевидно.
       Назовем ранг матроида MIA рангом множества А (обозначение р(А)) , акаж-
. дый базис этого матроида - базой множества А. Таким образом, р(А) - это
  наибольшая мощность независимого подмножества множества А. Заметим, что
.MIE = М, и поэтому ранг матроида М = (Е, J) равен рангу множества Е, а базис
матроида есть база множества, на котором он определен. Очевидно также, что
                           А
р(0 ) = О , и если Е J , то р(А) = I A I (ранг независимого множества равен его
                                                       ·           ·




     Отметим следующие свойства ранговой функции р :
мощности).

(pl)   'V   А   с   Е   о � р(А) � I A I ;
7-233 1
178 ------- Гпава LXXI I. Матромды

( р2) если А С В, то р(А) � р(В) (монотонность) ;
(рЗ) V А, В С Е р(А U В) + р(А n В) � р(А) + р(В) (полумодулярность).
     Выnолнение свойств (pl) и ( р2) очевидно. Докажем ( р3).
<4 Пусть Х - база множества А n В. С nомощью свойства (J2) множество Х
можно доnолнить до базы множества А; обозначим nолученную базу через У.
Аналогично, У доnолняется до базы Z множества А U В. И!ак, имеем
         х с У с z и p(A n B) = I X /, р(А) = /У/, р(А u в) = /Z/.
Необходимо доказать, что
                              I Z I + IXI � IYI + р(В).
Заметим, что по nостроению Xu(Z\Y ) С В . .Оrсюда p(X U (Z\ Y )) � р(В). Кроме
того, множество Х U ( Z \ У) является nодмножеством независимого множества Z,
и,     в силу (Jl), само независимо. Значит,
                    р(Х u (Z \ У)) = IX u (Z \ Y) l = IX I + /Z/ - IY/.
Таким образом,      IX\ + \ Z I \YI � р(В), что равносильно неравенству (*) .
                                                                     ..,
    Покажем теnерь, что матроид можно задать через ранговую Функчию.

Теорема 3. Пусть на подмножествах множества Е определена целозначная функ­
ция р, удовлетворяющая ycilOfJUЯМ (pl), (р2), (рЗ), а множество J состоит из всех
тех подмножеств А множества Е, для которых р(А)           / А/. Тогда М = (Е, J) суть
матроид.

<118
   Свойство (JO) следует непосредственно из ( pl). ·
    Докажем (Jl). Пусть р(А) IAI и В С А. Благодаря nолумодулярности функ­
ции р имеем
                p(B U (А \ В)) + p(B n (А \ В)) � р(В) + р(А \ В).
Но B u (A \B) = А, и р(А) = /А\, а Bn(A\B) = 10, и p(IO) = О. Поэтому, учитывая
                                          '




                                              �
также свойство p l и то, что В С А , получаем
      IA I = р(А) � р(В) + р(А \ В) � IBI + / А \ В / = IBI + I A I - IBI = / А / .
Поскольку на концах этой цеnочки соотношений стоит одно и то :же число, всюду
в ней на самом деле выnолняются равенства, в частности, р(В) = /В / . Таким
образом, В Е J .
     Свойство (J2) будем доказывать от противного. Пусть А , В Е J , IBI = k,
IAI = k + 1 . Если В С А, то доказывать нечего. Поэтому можно считать, что
/А \ В/ � 2. Предположим, что для любого элемента е Е А \ В неверно, что
В U {е} Е J . Тогда р(В U {е}) 1= k + 1 и, в силу соотношений
                       p(B) � p(B U { e}) � \B U { e} \ k + l
                       k
и целочисленности функции р , имеем р(В U {е}) = k. Возьмем в качестве е
два различных элемента с и d и пусть С = В U {с}, D = В U {d}. Тогда
С U D = В U {с, d} и С n D = В. Поэтому
      р(В u {с, d}) + р(В) = р(С U D) + р(С n D) � р(С) + p(D) � k + k,
§ 5. ЖадНый апгормтм   ----.,.--- 1 79
откуда р(В U { с, d}) � k . Так как р(В u {с, d}) � р(В) = k , nолучаем
                                  р(В u {с, d}) = k.
Итак, при добавлении к множеству В двух элементов из А \ В мы получили
множество с прежним значением функщщ р.
    Если в множестве А \ В, кроме с и d, есть еще, наnример, элемент f , nоложим
С В U {с, d} , D = В U {/} и, повторив nредыдущие выкладки, nолучим, что
р(В U {с, d, f}) = k.
    Добавляя к множеству В nоследовательно элементы и з А \ В , мы рано или
nоздно nридем к множеству В U А, и при этом окажется, что р(В U А) = k, в то
время как р(В U А) � р(А)       k + l . Противоречие получено. ",..


§ 5 . Жадн ы й алгоритм
Весьма общей является следующая задача оnтимизации.
     Пусть КЮ!Щому элементу е неnустого конечного множества Е поставлено
в соответствие неотрицательное число w(e) , называемое весом этого элемента. Вес
подмножества Х .с Е оnределяется как сумма весов его элементов:

                                     w(X)       L     w ( e) .
                                                еЕХ
                                            =


Рассматривается пекоторая совокуnность J nодмножеств множества Е . Требуется
найти в J nодмножество максимального веса.
    Подобный вид имеют или сводятся к нему многие задачи: наnример, задача
коммивояжера, задача о рюкзаке, задача о минимальном стягивающем дереве
и другие ..
    Жадный алгоритм рещения оnисанной задачи состоит в nоследовательном,
элемент за элементом, формировании искомого множества S, nричем на каждом
щаrе из всех элементов множества Е , добавление которых к ранее выбранным
возможно (то есть приводит к пекоторому множеству Из J ) , выбирается элемент
наиболъщего веса.
    Формально алгоритм можно описать так.

  1.   В качестве первого   (е 1 ) элемента выбрать элемент, удовлетворяющий условию
                                      w(e1)     = max w(e).
                                                  {e}EJ

     Следующий шаг выполнять до тех пор, пока он приводит к расширению фор.ми·
     руемого множества S.
  2. Если S = {е 1 , еъ . . . , ek- t } . то в качестве очередного. элемента множества S
       выбрать элемент   ek   такой, что




    Конкретная реализация жадного алгоритма зависит во многом от того, что
представляет собой множество J .
180 ------- Гnава LXXII. МатромДы

    Пример 1 . Пусть Е = { 1 , 2, 3 } , J { { 1 }, { 1 , 2}, {2, 3} } , w(1) = 3 , w(2) = 2, w(3) == 4.
    Действуя по жадному алгоритму, мы последовательно получим: е1 = 1, е2 = 2 и множе­
                                         =




    ство { 1 , 2} веса 5 , в то время как входящее в J множество {2, 3 } имеет вес 6. Жадность
    не помогла! Она не всегда дальновидна!
    Пример 2. В задаче коммивояжера требуется найти замкнутый маршрут наименьшей
    длины, проходящий через заданные города. Здесь Е -множество дорог между городами,
    в роли веса дороги выступает ее длина. Жадная стратегия для задачи комм11вояжера
    состоит в том, что, начав маршрут в произвольнам городе, в качестве очередного города
    на каждом шаге выбираем такой ранее не посещенный город, к которому ведет самая
    короткая дорога.
    ПрИмер 3. В задаче о минимальном стягивающем дереве требуется в заданном связном
    взвешенном графе G = (V, Е) выделить стягивающее дерево минимального веса. Здесь
    Е - множество ребер графа, а J состоит Из всех его стягивающих деревьев. Если w'(e) ­
    вес ребра• е , а число М больше веса любого ребра, то положив w(e) = М w'(e),              -


     перейдем от задачи минимизации к задаче максимизации. Это стандартный прием,
     но ценность его скорее чисто теоретическая, поскольку еще проще в описанном алгоритме
     заменить всюду нахождение максимума нахождением минимума. Различные способы

     алгоритмы Краекала и Прима - мы рассмотрели в § 8 гл. LXX.
     реализации жадной стратегии при нахождении минимального стягивающего дерева -

      Известно, что жадный алгоритм ДТIЯ задачи из примера 3 всегда дает опти­
мальное решение, а ДТIЯ задачи из примера 2 - не всеtда.
    , В этом параграфе мы выясним, каким требованиям должна удовлетворять
совокупность множеств J , чтобы жадная стратегия приводила к оптимальному
решению.

          ·
Теорема 4. пусть М = (Е, J} - матроид, а на множестве Е определена функция
веса w : Е --+ �+ . Тогда жадный алгоритм выделяет независимое подмножество Е
наибольшего веса.

'11111 Пусть в результате работы жадного алгоритма сформировано множество
1 = { e J , е2, . . . , е8} . По смыслу алгор�тма элементы этого множества проин­
дексированы в порядке убывания их веса:
                                w(et ) � w(e2) � . . . � w(es).
Возьмем в Е произвольное независимое подмножество L =                        {е'1 , е� , . . . , � } мак­
симального веса, считая, что


Заметим, что множество L максимально по включению среди множеств, входящих
в J (иначе его можно расширить, а вес при этом не уменьшится) . Множество 1
максимально по включению по самому смыслу жадного алгоритма. Таким обра­
зом, и L , и 1 - базисы матроида. Значит, как нам уже известно, в них поровну
элементов: t = s. Докажем по индукции, что ДТIЯ любого i выполняется неравен­
ство w(ei) � w(e�) . База индукции обеспечена первым шагом жадного алгоритма.
    Пусть теперь ДТIЯ любого k < n уже установлено, что w(e.t) � w(e�). Нужно
доказать, что w(en) � w(e�). Предположим, что это не так: w(en) < w(e�).
§ 5. Жадный апrормтм ------- 181

Сформируем множество

                               А     { е Е Е 1 w(e) � w(e�)}.
Рассмотрим ограничение матроида             М   =       (Е, J}   н а множество        А   - матроид
М'   M I A . Поскольку
     =




               w(ei) � w(e2 ) � . . . � w(en-J ) � w (е�-д ;;:,: w(e�),
множество В = {е1, е2, . . . , en-1 } является подмножеством множества А. Это
множество независимо (будучи подмножеством независимоrо множества 1) и мак­
симально по включению. Действительно, если в                   А
                                                             имеется более широкое неза­
висимое подмиожество { е 1 , е2, . . . , ел- 1 . е} , то w(e) ;;:,: w(e�) > w(en) , и жадный
алгоритм должен бы был на n-м шаге включать в формируемое множество вместо
элемента en элемент е . Итак, В - базис в матроиде М' . Однако, в М' содержится
и независимое множество    С {е� , е�, . . . , е�} (оно является подмножеством не­
зависимого множества L ) . Получилось, что в некотором независимом мноЖ:ест�е
матроида    М' элементов больше, чем в его базисе. Противоречие!
      Итак, для всех i справедливо неравенство               w(ei ) ;;:,: w(�) . Тогда
                                     8              8
                         w(1)      2: w(ei ) � L w(e�)             =   w(L) .
                                    i=l         i= l
Значит, 1 - независимое подмножество максимального веса. .-
      Доказательство теоремы покаЗывает, что для задач.и с матроидной структурой
.в оптимальном решении    1 по сравнению с произвольным независимым множе­
ством    L больше (если выразиться более аккуратно, не меньше) не только вес всего
множества, но также вес i �го по весу элемента для каждого i . Интересной особен­
ностью оптимального решения является также то, что оно целиком определяется
упорядочением весов элементов множестВаЕ, но не их конкретными значениями.
      Здесь же отметим, чем жадные алгоритмы привлекатсльны для проrрамми­
стов. Во-первых, эти алгорцrмы обычно леrки для проrраммирования (вспомним,
например алгоритм Прима). Во-вторых, они имеют, как правило, полиномиальные
оценки трудоемкости. Это объясняется тем, что искомое множество формируется
элемент за элементом, в отличие о;: алгоритмов типа перебора с возвратом, для
которых характерна экспоненциальная трудоемкость.
·

      Итак, в случае матроидной структуры подмножеств                    жадный алгоритм приво­
дит к оптимальному решению. Оказывается, справедливо и обратное утверждение,
возникающее при естественном nредположении о замкнутости системы множеств
относительно включения.


Теорема 5. Пусть J - непустая система подмножеств множества Е такая, что
выполняется условие (Jl). Если для любой весовой функции w : Е -+ JR+ жадный
алгоритм находит подмножество Е наибольшего веса, то {Е, J) - матроид.

<0111 Достаточно привести nример весовой функции, для которой жадный алгоритм,
примененный к задаче, в которой выполняются уеловия                        (JO) и (Jl) и   не выпол­
няется условие    (J2), не дает оnтимального решенИя.
      Пусть подмножества       Аи    В множества         Е   таковы, что IAI      =   k + 1,   IBI   =   k,
и   д.iш любого элемеНта   е   Е .А \ В   множество       В u {е}       не входит в J . ОпреДелим
182                                                                                Гпава LXXII. Метроиды



                                      {
      -------




весовую функцию следующим образом:

                                          k + 2,   если               е Е В;
                          w(e)   =        k + 1,   если               е Е А \ В;
                                          о,       если               е � A U B.
Жадный алгоритм сначала выберет все k элементов множества В , после чего
не сможет добавить к нему ни одного элемента ленулевоГо веса. Таким образом,
будет сформировано подмножество веса (k + 2)k = k2 + 2k. С другой стороны,
множество А имеет заведомо больший вес, поскольку вес каждого из k + 1 его
элементов не меньше, чем k + 1 , и

                                 w (A) � (k + 1)2 > k2 + 2k.
      Жадный алгоритм не Привел к оптимальному решению задачи. ..,.



§ 6 . Одна з адача пла нирования экс п еримента
Рассмотрим задачу практического характера, в которой возникает структура мат­
роида.
    Пусть некоторый объект подвергается воздействию нескольких независимых
факторов. В результате единичного эксперимента можно найти некоторую чис­
ловую характеристику объекта, которая является функцией значений указанных
факторов. В случае линейной модели эта функция имеет вид:

                              1   =   С1Х1 + С2 Х 2 + .         . .   + CnXn ,
где 1 - числовая характеристика объекта, n       общее количество факторов,
      значения факторов, Ci
                                                                       -


Xi    -                        коэффициенты, которые надлежит определить в
                                     -



результате проведения серии экспериментов. По техническим причинам факторы
могут встречаться только в �пределенных комбинациях. Будем считать, что та­
ких комбинаций m , причем т � n .
      nример. Пусть изучается влияние содержания различных минералов в почве н а повышение

      имеется т различных удобренИй, каждое из которых nредставляет собой смесь указанных
      урожайности некоторой зерновой культуры. При этом в распоряжении экспериментаторов


           В принципе можно провести т различных экспериментов и получить т уравнений:
      минералов в определенных пропорциях.

                                     анСt + а12С2 +     . . ·   + а1пС.. = ft;
                                     а21с1 + а22с2 +    · . ·   + a2nC.. = !2;

                                  amtCt + ат2С2 +      · · ·    + amnC.. = fm·
           Предположим, что каждый эксnеримент имеет свою цену, известную эксnеримен­
      таторам, а те желают nровести наиболее дешевую серию оnытов для оnределения
      искомых коэффициентов с; . Для этого им нужно в матрице А = (a;j ) выбрать n линейно

      i-го эксперимента. Эта задача разрешима, если ранг этой матрицы равен n; будем
      независимых строк с наименьшим суммарным весом, где вес i-й строки есть стоимость

      предполагать, что это условие выnолняется.
§ 7. 1�� ------- 1�

         Рассмотрим матроид строк матрицы А. Каждый базис матроида состоит из n
    линейно независимых векторов-строк. Независимое множество наименьшего веса как
    раз и есть то, что нам требуется: оно содержит строки, определяющие наиболее дешевую
    систему экспериментов.
     В заключение заметим, что известен вариант жадного алгоритма для матрич­
ного матроида, основанный на классическом методе Гаусса приведения матрицы
к треугольному виду. Трудоемкость этого алгоритма порядка m2 n операций.

§ 7 . Трансвереали
Пусть Е - непустое конечное множество, Р = ($1 , 82, , Вт) - некоторая   • • •


последовательность его непустьiХ подмножеств (онм могут пересекатъся и даже
совпадать). Трансверсолью (или системой различных представителей) для сово­
купности множеств Р называют множество Т = {t 1 , t2 , , tт} такое, что для
                                                                       . . •



каждого числа i элемент ti принадлежит множеству Si ; при этом при различных
i и j элементы t; и ti также различны.
        Другими словами, трансвереаль состоит из т различных nредставителей т
множеств. Заметим, что при этом nредставителю одного множества не возбраня­
ется быть членом и других множеств.
        Трансверсаль любой подпоследовательности последовательности Р = (В1 , В2 ,
. . . , Вт) называют частичной трансверсолью для Р . Пустое множество также будем
считать частичной трансверсалъю: тогда любое подмножество частичной трансвер­
сали есть частичная трансверсщь.
     Пример 1. Имеется несколько работников, каждый из которых может выполнять опреде­

     работы требуется ровно одИН человек. Требуется так распределить имеющуюся рабочую
     ленное {свое дnя каждого работника) множество работ. При этом дnя выполнения каждой

     силу, чтобы каждая работа выполнялась. Формализуя эту задачу, имеем: Е - множе­
     ство работников, множество 8; состоит из тех работников, которые могут выполнять

     последовательности множеств Р = (81 , 82, ; Вт) , rде т - общее количесТво работ.
     i-ю работу. Назначения на каждый вид работ сводятся к отысканию трансвереали для
                                                    • • •




     Пример 2. В некотором учреждении и.меется   т комиссий. Требуется из состава каждой
     комиссии назначить их председателей так, чтобы ни один человек не председательствовал
     более чем в одной комиссии. Здесь трансвереаль комиссий составят их председатели.
     Пример З. Пусть 81 = 82 = {1, 2} , 83 = 84 = {2, 3} , 85 = { 1 , 2, 3, 4, 5 , 6} . Легко видеть,
     что не существует трансвереали дnя Р = (81 , 82, 83, 84 , 85) , однако, например, элементы
     1, 2, 3, 6 составляют трансвереаль дnя последовательности Р' (81, 82, 83, 85) , то есть
     частичную трансвереаль для Р .
   Необходимое и дос;гаточное условие существования трансвереали дает следу­
ющая

Теорема 6.Пусть Е - непустое конечное множество. Последовательность его непу­
стых подмножеств Р = (В1 , 82, , Sm ) имеет трансвереаль тогда и только тогда,
                                      • • •


когда обьединение любых k подмножеств из этой последовательноети содержит
не менее k элементов, где k произвольное натуральное число, не превосходящее т .
184   -----�----                                                               Гnава LXXII. Матроиды

о01111 Сначала дадим краткую запись условия существования трансвереали из фор­
мулировки теор�мы:
                               'V A C { 1 , 2, . . . , m}
                                                       .
                                                            / .U S; j � ]A].                    ( 1)
                                                            IEA
Необходимость данного условия очевидна. Перейдем к достаточности.
    Предварительно докажем

Утверждение. Если в некотором множестве, например, в 81 , не менее двух элементов,
то из этого множества можно удалить один элемент, не нарушив при этом усло­
вия ( 1).

о01111 От противного: пусть ]St l � 2 и, какой элемент ни удалить из 81 , условие (1) не
будет выполнено. Возьмем два элемента х и у из множества 81 • Для них найдутся
такие множества иНдексов А' = { 1 } U А и В' = { 1} U B , где А, В С {2, 3, . . . , m} ,
ЧТО
                                                                       -
         u Bi u (St \ {x}) j < IA' I = IAI + 1 и 1 u si u (St \ {y}) j < IB' I = IBI + 1 .
      1 iEA                                                                                     (2)
                                                  iEB
Положим:
              Х = U Si U (St \ {x}),                    У = U Si u (St \ {y}).
                   iEA                                     iEB
Соотношения (2) перепишем в виде:
                                        IXI   � I AI;   IYI � ] В \,
откуда
                                        IXI + IYI � IAI + I B I.                                (3)
Для дальнейшего нам понадобится следующий вариант формулы включения-
исключения:
                      ICI + ID I = ] C U D I + ] C n D ] ,       (4)
rде   С и D - произвольные множества.    .
   С помощью условия ( 1) оценим снизу мощности объединения и пересечения
множеств Х и У. Поскольку
                 X U Y = iEAUB
                           U Si u (St \ {x}) U (St \ {y}) = U Si U St ,
                                                           iEAUB
выполняется неравенство
                                       IX u Yl � IA u B l + 1.                                  ( 5)
в силу того, что
                                          Х n Y :J iEAnB
                                                     U Sj ,
имеем
                                          j X n YI � ] A n B ].                                 (6)
Сложим неравенства (5) и (6) , дважды использовав тождество (4):
         IXI + IYI   ==   IX u Yl + ]Х n Yl � IA u Bl + IA n Bl + 1 = IAI + IBI + 1 .
Полученное противоречие с неравенством (3) завершает доказательство утвержде­
ния. �
§7. ���uи         _______                                                                        185

     Будем применять процедуру из утверхщения до тех пор, пока у нас не оста­
нутся лишь одноэлементные множества. При. этом в объединении любых k из них
содержится k элементов. Значит, все эти множества попарно не пересекаются,
а их объединение и есть искомая трансверсаль. 111>
                                                               •           1
     Замечание.    Искушенный читатель, наверное, сразу узнал в теореме о существовании
    трансвереали теорему Холяа. Действительно, построим двудольный rраф с долями
    v; ;::= {vt , v2,  , ffm } и V2 = St U 82 U . . . U Вт , в котором для каждого i множество
    Si есть множество вершин, смежных с вершиной щ . Тогда трансвереаль задает
                    • • •




    совершенное паросочетание из v; в V2 . В матримониальной трактовке теоремы
    Холла множество 81 состоит из девушек, знакомых i-му юноше, а трансвереаль есть
    множество счастливых невест.
     Идея изложенного выше доказательства, принадлежатего Р. Радо, позволяет
получить более общий результат. Об этом пойдет речь в § 9. А сейчас установим
два следствия из доказанной теоремы.


           Пусть Е - непустое коне�tное множество. Последовательность его
Следстаме 1.
непустых подмножеств Р (81 , 82, , Вт) имеет частичную трансвереаль мощ­
ности t тогда и только тогда, когда объединение любwс k подмножеств из этой
                                                       • • •




последовательности содержит не менее k + t - т элементов, где k - пfiоиэвольное
натуральное число, не превосходящее т , т. е.
                            'V А   с   { 1 , 2, . . . , т}        U Si l � !А ! + t - т .
                                                               1 iEA

<11111 Чтобы иметь возможность примелить утверхщение теоремы, возьмем множе­
ство D, имеющее мощность т - t и не пересекающееся с Е, и образуем новое
семейство множеств Р        (s; , 82, . . . , s:n) , где s; = 8;. u D . С tюмошью т - t
элементов множества D любая частичная трансвереаль мошности t дополняется
до (полной} трансверсали. Обратно: если имеется трансвереаль дЛЯ Р , то выбро­
сив из нее элементы множества D, получим частичную . трансвереаль мошности
не меньше t, а, значит, есть и частичная трансверсалъ, мощность которой равна t.
Таким образом, существование частичной трансвереали мощности t дЛЯ Р рав­
носильно существованию полной трансвереали для Р1 , а последнее имеет место
тогда и только тогда, когда

        'V A C { l , 2, . . . , m}            u s: l = l iEA
                                           l iEA                         u si l + m - t � IAI.
                                                          u s, u DI = I iEA
Доказательство следствия 1 завершено.                          •



           Пусть Е непустое конечноемножество, Р (81 , 82 , . . . , Sт) - после­
Следствие 2.
довательность его.непустых подмножеств. Множество Х С Е содержит частичную
трансвереаль мощности t для Р тогда и только тогда, к.огда
                    'V A C { l , 2, . . . , m}
186   -------                                                                                 Глава LXXII.   Метроиды

..- Положим Sj        =       n
                          Si Х (для каждого i) и nрименим к последовательности
Р' = (81 , S�, . . . , s:n) nредыдущее следствие. Получим условие

                          'v' А   С { 1 , 2 , . . . , m} l i�A Sil   �   I A I + t - т.
Но U Si =      U (Si n Х)     =     (U Si) n Х.    �




§ 8. Трансверсальный матр оид

Теорема 7 (Дж. Эдмонде, Д. Фаnкерсон, 1 965 r.). Пусщь Е - непустое конечное множества,
P = (S1 , S2, . . . , Sт) пекоторая последовательность его непустых подмно.жеств,
а J - множество всех частичных трансвереалей для Р. Тогда (Е, J) - матроид.

..- Свойства (JO) и (Jl), очевидно, имеют место. Проверим выполнение аксиомы
независимости (J2).
     Прибегнем к наглядному представлению семейства множеств Р = ( 81 ,             Вт)                      • • • ,


с помощью 'двудольного графа G , который строится следующим образом. Вер­
шины nервой доли V1 будут соответствовать �ножествам S 1 ,               , Вт , вершины      • • •


второй доли V2 - элементам множества Е, и (для каждого i) ребра, инцидент­
ные вершине Si , соединяют ее со всеми элементами множества Si . Выделению
системы различных предстацителей соответствует некоторое nаросочетание (т. е.
множество поnарно несмежных ребер) в этом графе: если элемент ti представляет
множество Si , то в nарасочетание войдет ребро Siti . Заметим, кстати, что в случае
трансвереали имеем совершенное парасочетание из J'J в V2 .
     Пусть А и В - частичные трансвереали н I A I = IBI + 1 . Нужно доказать,
что найдется элемент е Е А \ В такой, что В U {е}              частичная трансверсаль.
Паросочетания, отвечающие указанным частичным трансверсалям, обозначим со­
ответственно через WA и Wв . Покрасим ребра из WA \ Wв в красный цвет,
из Wв \ WА - в синий, а из WA n Wв              в зеленый. Красных ребер будет на одно
                                                       -


больше, чем синих. Заметим также, что зеленое ребро не смежно ни с одним
nокрашенным ребром.
     Рассмотрим подграф G' исходного графа, образованный красными и синими
ребрами. Так как два ребра одного цвета не могут быть смежны, стеnень каждой
вершины в G' равна 1 или 2. Легко видеть, что комnонентьt связности G' представ­
ляют собой циклы и цепи. В каждом цикле и каждой цепи цвета ребер чередуются.
Поэтому в цикле, а также цепи четной длины одинаковое количество красных
и синих ребер. Поскольку красных ребер больше, чем синих, найдется цепь С
нечетной длины v 1 -+ v2 -+ . . . -+ v21, , в которой первое и последнее ребро - крас­
ные. Ровно одна из концевых вершин цепи С лежит в V2 , пусть это вершина v1                                            •


Эта вершина инцидентна только красному ребру и изображает элемент из А \ В .
Каждая и з вершин v3, tls,       , v2k-! изображает элемент множества Е и инци­
                                      • • •



дентна как красному, так и синему ребру. Значит, { vз, v5,           , v2k-t } С А n В .
                                                                                     • • •


Перекрасим теперь цепь С, заменив красный цвет синим, а СИ.Ний красным.
     Вернемся к графу G. В результате nроизведенной nерекраски множество
вершин из V2 , п6крытьrх синими и зелеными ребрами, пополнилось вершиной v1 ,
то есть частичная трансвереаль В удлинилась за счет элемента из А \ В . �
§ 9. НезавмсliМые трансверсапм     __________________...._
                                                         .._ _                                                          1&7

     Матроид, образованный частичными трансверсалями фиксированного семей­
ства множеств Р, будем называть трансверсальным и обозначать М{Р] .
     Приведем пример практической задачи, в которой возникает трансверсальный
матроид.
                   Имеется т работников; i-й рабоТ1iик может выnолнять работы из множества
                  S; , где i = 1, 2, . . . , т. Пусть общее множестзо работ Е
     Прммер.
     работ                                                                         US; = { е 1 , е2,         • • •   , en } .

     между рабоП!иками (nри этом каждый выnолняет не более одной работ�>\. а для каждой
     а nрибыль от выnолнения работы             е,   равна   w(e;).   Требуется так расnределить работы



          работники моrут остаться без работы), чтобы общая прибыль от выnолнения работ была
     работы нужен один работник; какие-то работы моrут оказатЬс;я невыnолненными, а какие­
     то



     наибольшего веса для nоследовательности множеств Р
     максимальной. Математически. задача сводится к отысканию частичной трансвереали
                                                                               (S1 , S2,           , Sт) .
     словами, нужно найти неэависимов множество наибольшего · веса в трансверсальном
                                                                                           • • •             Другими


     матроиде. Для этого, как нам уже известно, годится Жадный алгоритм.

        В заключение параграфа, используем понятие тр�нсверсального матроида для
решения одной теоретической задачи.
        Выясним, каким требооаниям должны удоелетворять множество А С Е
и семейство множесте Р, 'fтобы nepeoe .можно было дополнить до трансеереали
второго, т. е. чтобы семейство Р имело трансверсаль, содержащую множество А .
Очевидно, необходимыми являются следующие условия:
    1 . Р имеет хотя бы одну трансверсаль.              ·



    2. А - частичная трансвереаль дЛя Р.
        Удивительно, но эти условия являются и достаточными.
<411 Доказательство проводится очень просто, если опираться на теорию матро­
Идов. Действительно, множество А, будучи частичной трансверсалъю, является
независимым множеством трансверсального матроида. Любое иезависимое мно­
жество можно расширить до базиса. Все базисы матроида имеют одну и ту же
мощность. В силу условия 1 мощность базиса равна m. Значит, базис суть транс­
kрсаль. •


§ 9. Н езависимые трансвереали
Ранее мы установили необходимое и достаточное условие существования транс­
вереали для семейства подмножеств Р = ( S1 , S2 , , Sm) множества Е. Теперь
                                                                       • • •


пусть на множестве Е задан некоторый матроИд. Независимой трансверсалью для
Р назовем трансверсаль, которая является независимым множеством в смыс­
ле указанного матроида. В частности, если матроид - дискретный, то любая
трансвереаль - независимая. Следующая теорема дает критерий существования
независимой трансверсали.

                               М = (Е, J) - .матроид. Последовательность Р
Теорема 8 (Р. Радо, 1942 r.J. Пусть
   ,
(S1 S2 ,  , Sm
          • • •) непустых подмножеств  множества JE имеет независимую транс­
вереаль тогда и только тогда, когда объединение любых k подмножеств из этой
последовательности содержит независимое множество, в котором не менее k эле­
ментов, где k - произвольное натуральное число, не превосходящее т .
188 ------ Гпава LXXII.                                                                      Матроидw

<11111 Условие теоремы удобно сформулировать, используя понятие ранга множества
(наибольшей мощности независимого подмножества) :
                            V' А   с   { 1 , 2 , . . . , m}     р(iEA
                                                                   u si) � \А\.                   (1)

    Необходимость. Если имеется независимая трансверсаii:ь, то ее пересечение
с множеством U Si имеет /А/ элементов, откуда р( U Si) � /А\.
                iEA                                                       iEA
    Достаточность. Предварительно докажем

Утверждение.Щи в пекотором множестве (например, в 81 ) не менее двух элементов,
то из этого множества можно удалить один элемент, не нарушив при этом усло­
вия (1).

<11111 От противного: пусть \81 / � 2 и, какой элемент ни удалить из 81 , условие ( 1) не
будет выполнено. Возьмем два элемента х и у из множества 81 • Для них найдутся
такие множества индексов А' = { 1 } U А и В' = { 1 } U В, где А, В С {2, 3, . . . , m} ,
что



Положим:
                   х   =
                           . аЕА
                           .u si u (St \ {х}),                У == ,.uев si u (St \ {у}) .
Соотношения (2) перепишем в виде:
                                       р(Х) :::; /А/ ; р(У) :::; IB/,
откуда
                                       р(Х) + р(У) :::; /А/ + \В / .                              (3)
   С помощью условия ( 1) оценим снизу ранги объединения и пересечения
множеств Х и У. Поскольку


выполняется неравенство
                                       р(Х U У) � /А U В/ + 1 .                                   (4)
в силу того, что
                                                       U 81,
                                            Х n Y :) iEAnB
имеем ·
                                          p(X n Y) � /A n B/.                                     (5)
Используя свойство полумодулярности ранговой функции, после сложения (4)
и (5) получим:
   р(Х) + р(У) � p(X U Y) + p(X n Y) � /A U B/ + /AnB/ + 1 = / А / + /В/ + 1.                     (6)
     Неравенство (6) противоречит неравенству (3). Утв�рждение доказано. .,..
§ tO. Общие l'р!lксверсали ------- 189

    Будем применять процедуру из утверждения до тех пор, пока у нас не оста­
нется т одноэлементных множеств {t1 }, {t2 }, • • • , {tm}. При этом ранг их объ­
единения Т = {t 1 , t2 , , tm } равен т. Значит, Т и есть искомая независимая
                              • • •



трансверсаль. ..,.

С.nедствие. Пусть М == (Е, J}       матроид. Последовательность Р = (St , S2, . . . , Sт)
непустых подмножеств мнQжества Е имеет независимую частичную трансfJерсаль
мощности t тогда и только тогда, когда объединение любых k подмножеств из
этой последовательности содержит независимое подм11ожество мощности не менее
k + t - т, т. е.
                   v А с { I , 2, . . . , т} p(.u S;) � IAI + t - т.
                                                      IEA


<111(   ДоказателЬство вполне аналогично доказательству следствия 1 из теоремы 6. ..,.


§ 1 О. Общие трансвереали
Критерий существования независимой трансвереали позволяет получить необхо­
димое и достаточное условия существования общей трансвереали у двух раЗJlичных
систем подмножеств одного и того же множества. Имеет место

Теорема 9. Два семейства Р    (S1 , S2, . . . , Sm) и Q == (Rt , Rz, . . . , Rm) непустых
подмножеств конечного множества Е обладают общей трансверсолью тогда и толь­
ко тогда, когда для любьа подмножеств А и В множества { 1 , 2, . . . , т} выполня-
ется неравенство



.,.. Рассмотрим матроид частичных трансвереалей для Р. Общая трансвереаль Р
и Q есть независимая (в указанном матроиде) трансвереаль Q . По теореме Радо
независимая трансвереаль Q существует в том и только том случае, когда объеди­
нение любых k множеств Ri содержит независимое множество из k элементов,
которое в нашем случае суть частичная трансвереаль мощности k. Применяя
следствие 2 из теоремы 6, имеем
                   v А, в   с   { 1 , 2, . . . , т} 1 (i�A si) n х 1 � I AI + k - т ,

             iEB
где Х         u Ri , k = !B I . ..,.
    Покажем,. как свести нахождение общей трансвереали к нахождению макси­
мального потока в сети.
    Итак, имеем множество Е = {е1, е2 ,            , en } и два семейства его подмножеств
                                                     • • •



Р = (S1 , S2, . . . , Sт) и Q (R1 , R2 , . . . , Rm). Построим ориентированный граф,
содержащий следующие вершины:
  • а - источник, Ь - сток;
190 --------�-- Глава LXXII.                                                                              Матроиды

  •   вершины, изображающие nодмножества 81 , 82, , Sm. R1 , R2,                                     , Rm ;
  •
                                                                  . . .                      . . .



    ' по две вершины на каждый элемент множестtlа Е: vj, v�', v�, v�                                    , v�, v�
и следующие дуги:
                                                                                            •   . . .




  • aSi и �Ь для i = l, 2,   , т;
  • Sivj , если ei Е Si;
                                        . . .




  • vj�. если ei Е JR.; ;

  •   v;v�' для j = 1 , 2,           , n.
Положим nроnускные сnособности всех дуг равными единице . Если существует
                             . . .




общая трансвереаль t 1 , t2, tт для Р и Q, то в nостроенном графе есть т
                                       • • •    ,


непересекающихся nyreй из источника в сток вида
                                      а -+
                               Si -+ v� -+ v� -+ RJ -+ Ь,
rде элемент е�; является nредставителем множеств Si и Rj . ·Эти т nутей форми-                                            1

  руют максимальный nоток (ero величина т) в nостроенной трансnортной сети .
, После нахождения максимального потока легко указать общую трансверсаль.
                                   { 1 , 2} , 82 { 1 , 2, 3,4}, 83 {2, 4} , R1 { 2 , 3 } , R2 =
                                                    =             =                     =                     { 1 , 4},
      R3 =
      Пример.   Для множеств 81
             {1, 2, 3 }
                     и меем сеть (с единичными nроnускными сnособностями всех дуг):




         а                                                                                                      ь




                                                        Рис. 2

             После нахождения максимального nотока можно увидеть общ.ую трансаереаль
      { 1 , 2, 3}, nричем 1 является nредставителам множеств 81           и   R2 , 2   nредставляет       83   и   R1 ,
      а 3-      множества 82 и Rз .




 § 1 1 . Некоторые интересные матроиды
 Геометрическое пре.цставпение матроидов малого ранга
Пусть в матроиде нет циклов длины l и 2, а ранr матроида не боль�е 4. Будем
изображ.а!Ь такой матроид в виде графа, вершины которого соответствуют эле­
ментам матроида, и nри этом:
  • если три элемента матроида образуют цикл, то изображающие их точки лежат
    на одной nрямой или на одной окружности;
§ 1 1 . Некоторые интересные матромды   --�-----                                                                       191
   •   если четыре элемента матроида образуют цикл, то соответствующие и м точки
       лежат на одной плоскости.

       Если полученному графу можно сопоставить многогранник, то, как это
принято при изображении пространствеиных фигур, некоторые ребра (невидимые)
будем рисовать прерывистыми линиями.

1 1 . 1 . Матроид Фано
Матроид Фано            F   изображен на рис.     3.   Он обладает многими
                                                                                                        k
замечательными свойствами. Установим некоторые из них.

  1.   Матроид Фана является бинарным.
� Действительно, рассмотрим линейное пространство с бази­
сом    (i, j, k)   над полем   GF(2). Полученный векторный матроид
изоморфен            F. В   этом ·�еrко убедиться, поставив в соответ­
ствие вершинам треугольниКа векторы                    i,j, k,   середине каждой                              а         j
стороны              сумму векторов ее концов, а центру - вектор
i + J + k . ....                                                                                            Рис. З
  2. Матроид Фана не является регулярным.
� Предположим, что матроид                 F   представим над некоторым полем. Пусть эле­
ментам матроида соответствуют векторы                       i, j, k, а,         Ь,   с,   d (рис.   3).      Разложим
по базису          (i, j, k) остальные векторы:
                                  а = X1 i + 1/ lj;     Ь   =    1/2.1 + Z2k;
                                  с = хзi + zзk;        d   =    xi + yj + zk.
       Из линейной зависимости векторов                  i, Ь, d     следует равенство нулю определи­
теля, составленного из их координат:

                                             1 о о
                                             0 t/2 Z2            =   0.
                                             х у z
Отсюда
                                                                                                                       ( l)
Аналогично из линейной зависимости троек векторов                               j, с, d; k, а, d    и   а, Ь, с      выте­
кают соответственно равенства:

                                          zзх =ё= zхз;                                                                 (2)
                                          XJtf Ху 1 ;                                                                  (3)
                                          Х!У2 ZЗ + YJ Z2XЗ        =   о.                                              (4)
       Заметим, что никакие два элемента в            F не образуют зависимого множества;
поэтому элементы числового поля          х 1 , у1 , t/2, z2, х3, zз отличны от нуля. А из того,
что.тройки векторов d, i, j ; d, i, k и d, j, k являются линейно независимыми, следует
неравенство нулю скаляров х, у и z . Перемножив равенства (1), (2) и ( 3) и со­
кратив на xyz , получим
192   -------                                                                             Глава LXXI I. МатроИДЬI

Число    t=
          Х 1 У2 Zз        = у1z2 хз      не равно нулю, и, в то же время, как показывает
соотношение (4),         t + t = О. Это означает, что поле имеет характеристику 2.
       Подведем итог. Если матроид Фано                      F   представим над некоторым полем,
                                                   2.                               F
любым полем, то есть он не является регулярным. �
то это поле имеет характеристику                        Стало быть, матроид             представим не над


       В дальнейшем матроид Фано будем рассматривать как векторный матроид
с элементами         i, j, k, i + j , i + k, j + k, i + j + k     над полем        GF(2).
  3. Матроид Фано не является трансверсальным.
<11 Доказательство от противного. Если матроид трансверсальный, то поскольку
векторы    i, j, k   образуют независимое множество, без ограничения общности мож­
                    i Е 81 , j Е 82 , k Е 83 • Вектор i + j + k � 81 , где l > 3 , так как
                                   i, j, k; i + j + k бьmи бы линейно независимы, что
но считать, что
в противном случае векторы
неверно. Пусть i +j + k Е 81 • Посмотрим, в каких множествах Si может находиться
элемент i+k. Он не входит в 82 (иначе векторы i, i+k, k лине:0:но независимы, что
не имеет места) и в 83 (иначе линейно независимь1ми окажутся векторы i + j + k,
j, i + k). Н о и при l > 3 вектор i+k н е принадлежит 81 ( в противном случае можно
составить частичную трансвереаль из элементов i, k, i + k). Остается единственная
возможность: i + k Е 81 • Аналогичные рассуждения, применеиные к вектору i + j ,
Показываtот, что он также входит лишь в множество 8 1 • Отсюда следует, что
в нашем матроиде множество {i + k, i + j} является зависимым, а это неверно. �

  4. Матроид Фано является эйлеровым (то .есть представим в виде объединения не­
       пересекающихся циклов).
<11 Действительно, имеем циклы                 {i, j, k, i + j + k}   и   {i + j, i + k, j + k} .   �

  5. Матроид Фано не явлЯется графическим.
                             <11 Пусть это не так. Отождествим элементы матроида с реб­

         i +j               рами графа        G,   матроид циклов которого изоморфен                    F.   Ребра
                            i, j, i+j образуют цикл, поэтому ребра i и j смежны. Аналогич­
                            но, смежны ребра i и k, j и k. В то же время i, j и k не образуют
    �
i+k W J+k
                            цикла. Если три ребра попарно смежны и не образуют цикла,
                            то у них есть общая вершина. Получаем подграф графа G,
                            изображенный н а рис. 4. И з рисунка видно, что ребра j и i + k
        Рис. 4                                                                      i +j + k
                            составлять цикл. Противоречие! �
                            не смежны, однако вместе с ребром                                   они должны


  6.   Матроид Фано не является кографическим.
<11 Вновь рассуждая от противного, отождествим элементы матроида с ребрами
графа G , матроид разрезов которого изоморфен F. Поскольку в матроиде Фано
циклы состоят из трех или четырех элементов, в графе                           G   любой разрез содержит
три или четыре ребра. Значит, степень каждой вершины графа не меньше                                   3.
                                                                                      G равна удвоенному
                                    7 = 14. Отсюда {;Ледует, что в нашем графе не более четырех
По лемме о рукопожатця": сумма степеней всех вершин графа
числу ребер, то есть        2   ·


                                                                       РЬiй его разрез (так как
каждый элемент матроида входит в некоторый цикл); поэтому в графе нет петель.
вершин. Каждое ребро графа должно входить в некото


Поскольку для любь1х двух элементов матроида а и                          Ь
чающий элемент а и не содержащий
                                                  можно указать цикл, вклю­
                                                        Ь,
                                      для каждого ребра графа намется разрез
с этим ребром, но без любого другого (наперед заданного). Значит, в графе нет
§11.   Кекоtорые интересные матроиды         -------�                                                               193

кратных ребер. Итак, имеем nростой граф, в котором не больше четырех вершин.
Но тогда ребер будет не более шести, а их семь. Пришли к nротиворечию.                                         �'
1 1 .2. Матроид Вамоса
Пусть Е = { l , 2, 3, 4 , 5, 6, 7, 8} .            Мат­                                                    2
роид Вамоса          V   удобно задать, назвав
все его зависимые множества: это все
подмножества           Е,      в которых не ме­
нее пяти элементов, а также                { 1 , 2, 5, 6},                                                           6
{ 1, 2, 7 , 8 } , {3, 4 , 5, 6} , {3, 4 , 7, 8} , {5, 6,
7, 8} . fi>афическое представление мат­
роида - на рис; 5.
       Сначала убедимся в том, что пе-                                                       f
ред нами действительно матроид. Фак-                            7
тически нуждается в проверке лишь
тот факт, что если А и                В     независи­
мые множества и !BI                  = 3,    IAI       =   4,
то в А найдется такой элемент е, что
                                                                                3                 4
В   U {е}       -    независимое множество.                                              Рис. 5
Когда     В     С   А, это очевидно. В про-
тивном же случае множество А \ В содержит по меньшей мере два различных
элемента. О&означим их через                  е1   и   е2 • Теперь осталось заметить, что из множеств
ВU     {e t }   И   В U {е2 }      ХОТЯ бы ОДНО незаВИСИМОе, так КаК ПО УСЛОВИЮ Нет двух
зависимых множеств из четырех элементов, отличающихся одним элементом.
       Докажем, что матроид Вамоса                     - не векторный, т. е. что он не представим ни над
каким полем.          Заметим, что среди всех таких матроИДав он имеет наименьший
порядок. Этим он и замечателен.

..- Предположим, что существует изоморфнцй     векторный матроид        V
                                                                       (Е, J) ,                       М=
где Е    {х1 , х2, , х8} , и для каждого i вектор Xi соответствует элементу i
                          • • •


матроида Вамоса.
               {х1 , х2, хз, х4} является базисом М. Запишем координаты каждо­
       Множество
го вектора в этом базисе: Xi (ан , aJ2, ai 3 , ai4) . Для дальнейшего нам понадобятся
также векторы Yi = (ан , ai2, О, О) и Zi = (0, О, ai 3 , ai4), где i = 1 , 2, . . . , 8 . ВвИдУ
линейной зависимости векторов х1 , х2, х5 , х6 получаем равенство нулю опреде-
лителя, составленного из координат этих векторов:

                                             1    о    о   о
                                             о    1    о   о                    0.
                                                                            =
                                            a st a s2 аsз a s4
                                            а61 а62 а63 ам


                                                                    1
       Отсюда




то есть векторы           z5
                                                   1   аsз а54 = О,
                                                       а6 з ам
                                  и Zб линейно зависимы. Заметим, что вектор                          zs   иенулевой
(иначе были бы линейно зависимыми векТоры                               X t , Xz, Xs ,   а у нас любые три век­
тора линейно независимые). Поэтому дn:я некотороrо скаляра (то есть элемента
194 ------- Глава LXXII.                                                                                            Матроиды

числового поля, над которым рассматривается линейное пространство) JL име­
ет место равенство z6 = p.z5 . Точно так же из линейной зависимости четверок
векторов {х1 , х2 , Х7, xs} , {х3, Х4 , х5 , х6} , {х3 , х4 , Х7, xs} получаем соответственно
равенства zs = f3z7 , 1/6 = >..у5 , Ys = ау7 , где греческими буквами обозначены
некоторые скаляры.
     Наконец, используем линейную зависимость векторов х5 , х6, х7 , Xg . С помо­
щью найденных соотношений будем преобразовывать опРеделитель, составленный
из координат этих векторов (при этом вместо строк определителя для наглядности
записываем поначал)' соответствующие векторы):

         Xs             Ys + zs          Ys + zs                 Ys     1/5    zs   . zs
         Х6             1/6 T Z6        Луs + JLZs          =
                                                                JLZs + JLZs + Луs + Луs
         Х7        �
                    /

                        У1 + z1          У1 + z1                 1/1    Z7     1/7    Z1
         Xg             Ys + zs         ау1 + f3z1              f3z1   аУ?    f3z1  ау?

                 Ys                             Ys                             os1               os2 о   о
         JL( а) zs - >..({3 - а)                zs                              о                 о оsз Os4
     =      /3 -                                          = (р. - >..)(/3 - а)                                        =
                 1/1                            У1                             07 !              072 о   о
                 Z7                             Z7                              о                 о 073 о74

                            =
                                 (JL _ >..)(/3 _ а)   1
                                                os2 · Оsз 054 = О .
                                                          os1
                                                072 . 073 074
                                                          071
                                                                    ll                   1
Теперь заметим, что JL "1- >.. (в противном случае линейно зависимыми будут век­
торы xs = Ys + zs и Х6 = Лy5 + p.zs ) , а а "1- {3 (иначе линейно зависимы векторы х7
                                                               .
и xs ). Поэтому равен нулю один из определителей °5 1 052 или 053 054 -
                                                            071 072       073 074
                                                                                   1                 ·/ /                 1
например, первый из них. Но тогда

                                        о      о        о
                            хз
                            х4
                            Xs
                                   =
                                        о
                                       a s1
                                               о
                                                    1
                                                    о   1
                                              a s2 Оsз as4
                                                                     =
                                                                         l   os1
                                                                             а11
                                                                                       os2
                                                                                       а12
                                                                                             1   =   О   ,


                            Х?         а11    а12 а13 а74
то есть векторы Хз , х4 , х5 , х7 линейно зависимы, что противоречит условию. .,..


                                                  Упражнения
  1 . Доказать, что с точностью до изоморфизма число матроидов порядка                                       n   не иревосхо­
     дит 22"  .•




                                                      (� � i �) .
  2. Найти ранг, все базисы и циклы матроида столбцов матрицы



                                                           1 о 1 j
     обозначая i-й столбец матрицы через е;.
  3. Дан граф G (рис. 6).
     Для а) матроида циклов М (G) ; б) матроида разрезов м• (G) найти все циклы и базисы.
У�м• �
     · �----�---------------------------------------------                                                       195




                                                     5            4
                                                             Рис. б


 4.   Пусть в матроиде М, заданном на множестве Е = { 1 , 2, 3}, есть ровно два базиса:
      { 1 , 2} и { 1 , 3}. Доказать, что этот матроид планарный, построив такие графы G1 и G2 ,
      что матроид М изоморфен матроиду циклов M(GI ) и матроиду разрезов M*(G2 ) .
 5.   Покажите, что все матроиды порядка н е выше 3 графические, построив соответству­
      ющие графы. Подсчитайте количество попарно неизоморфных матроидов порядка О,



                                                -
      1, 2 и 3.
 6.   Доказать, что матроид Un- I ,n - графический.
 7.   Доказать, что матроид U1,n     кографический.
 8.   Доказать, что матроИд U2 ,4 не ямяется ни графическим,                          ни котрафическим.
 9.   УКf\Жите все попарно неизоморфные матроиды порядка 4. Сколько среди них не яв­
      Ляiотся графическими?




                                                     (                        )
10.   Доказать, что матроиды М(К5) и М(К3,3) - не кографические.
11.   Через Mq [A] обозначим матроид столбцов матрицы А над полем                              GF(q) .   Пусть

                                                         1 о о 1 1 о
                                                А=       О l О 1 О 1              .
                                                         о о 1 о 1 1
      1)   Найти три столбца матрицы А, образующие цикл в М2{А] и базис в М3 [А] .
      2)   Доказать, что М2 [А] - графический матроид, а М3 [А] - нет.
      3)   Доказать, что матроид М2 [А] nредставим над полем                  GF(3), а М3 [А]       не представим
           над GF(2).
12. Для каждого из следующих семейств подмножеств множества { 1 , 2, 3, 4, 5}                             выяснить,
      имеет ли оно трансверсаль:
      pl = ({1}, {2, 3}, { 1 , 2}, { 1 , 3}, {1, 4, 5}) ;
      р2 :::: ({1, 2}, {2, 3}, {4, 5}, {4, 5});
      Р3 =     ({1, 3}, {2, 3}, { 1 , 2}, {3}}) ;
      р4 = ({1 , 3, 4}, { 1 , 4, 5}, {2, 3, 5}, {2; 4, 5}) .
13.   Доказать,     что   любой матроид ранга            1   трансверсален.
14.   Доказать, что k -однородный матроид тр;шсверс�ен.
15.   Имеется множество юношей, каждый из которых знаком с некоторыми девушками.
      Две свахи знают, кто с кем знаком. Одна сваха заямяет: «Я мщу одновременно женить
      всех юношей так, чтобы каждый из них женился на знакомой ему девушке!» Вторая
      сваха говорит: «А я могу устроить судьбу всех блондинок!» Эrот диалог услышал



                                                                                           -
      любитель математики, который сказал: «В таком случае я могу сделать и то, и другое!»
      Прав ли он?
16.   Пусть Е - непустое конечное множество, Р = (81 , 82, • • • , Вт) некоторая последо­
      вательность его подмножеств. Частичные трансвереали Р определяют трансверсаль­
      ный матроид ранга r. Доказать, что этот матроид можно задать nоследовательностью



                                        2
      из r множеств.
17.   Доказать, что с точностью до изоморфизма число трансверсальных матроидав поряд­
      ка   n   не nревосходит      2n       •
196   ------..,..---                                                 Гпава LXXII. Матроиды




                                         Рис. 7

 18. Доказать, что матроид, изображенный на рис. 7,    не бинарный, но тернарный.
 1 9. Доказать, что матроид из предыдущего упражнения не является трансверсзльным.
 20. Пусть С - цикл. Доказать, что р( С) =   \С! - 1 .
 21. Найти и;,,. . ,
 22. Доказать, что матроид U2,з    реi)'лярный.
 23. Над какими полями nредставим матроид U2,4?
 24. На рис. 8 изображены графы. Оrносительно матроидов циклов этих графов выяснить,
      являются ли они трансверсальными.


                     /




                                    ./



                                         Рис. 8



                                         Ответы
5. 1, 2, 4, 8. 9. Всего 1 7 матроидов, из них 1 6 графических. 1 5. Прав. См. конец § 8.

множествам Si , а второй элементам множества Е. Ребро S;e; присутствует в графе тогда
16. Рассмотрим двудольный граф G(Vi , V2) , в котором вершины первой доли соответствуют

и только тогда, коrда eJ Е S; .
      Любое независимое множество трансверсального матроида можно теперь рассматри­
вать как множество вершин второй доли, покрытое некоторым паросочетанием.

рое паросочетание мощности r . Пусть оно nокрывает множество А вершин из Vi .
      Зафиксируем некоторую максимальную частичную трансверсаль. Ей отвечает некото­


шин из � . покрываемое некоторым паросочетанием. Согласно задаче 12 из § 12 гл. LXXI ,
      Возьмем теnерь nроизволъное независимое множество матроида множество В вер-

существует nаросочетанне М, покрывающее одновременно множества А и В . Его мощ­
ность не меньше r (поскольку М nокрывает А), но и не больше r (это ранг матроида) ­

      Таким образом, элементы множества В образуют частичную трансвереаль для системы
значит, она равна r .

множеств А. Стало быть, если мы сохраним в Р лишь множества, вошедщне в А , то получим
тот же самый матроид.
                        ПРЕДМЕТНЫЙ                              УКАЗАТЕЛ Ь



 А                                                             - nлатонов     103
                                                               - полный     103
алгоритм вентерский                1 5 1 , 166, 168
                                                               - - двудольный        103
         Дейкстры       132, 133
                                                               - реберный     102
 - Евклида        7
                                                               - связный    104
 - жадный        173, 179
                                                               - циклический        104
 -       Краекала 119
                                                               - эйлеров    lll
 -       Прима 120, 121
                                                               rрафа вершина  100
 -       Флери 1 12
                                                               - диаметр 108
 .;.__   Флой;да 1 33
                                                               - неребро 148
 - Форда-Фалкереона                    138 , 139
                                                                 порядок 101
 антицепь        1 54
                                                                 радиус 108
                                                               - ребро 100, 103
 &                                                               укладка 125
                                                               - центр 108                        .
бином Ньютона 47,                49
                                                               - число реберно-хроматическое                 1 5 1 , 1 59
                                                               групnа   24, 28
 в
вершина графа             100                                  д
 - -, полустепень захода                    1 30
 - -, - исхода             130                                 дерево  68, 11 4
 - -, стеnень lO 1                                             - бинарное     68, 69
 - -, эксцентриситет                  108                      -   корневое 145
вершинное nокрытие графа   153, 165                            -   стятивающее 1 18 , 1 19
вес класса эквивалентности 89                                  дизъюнктное объединение графов                  104
   подграфа 167, 168
- ребра 1 10, 118
                                                               3
   функции 88
вычет 13                                                       задача коммивояжера 109
                                                                   '
                                                               - о беспорядках 54, 77
                                                                                                      1 12
г
                                                               - о кенигсбергских мостах
                                                               - о комnостере  93
грань плоского rрафа               126, 127                    -о   назначениях 151, 166
граф       100                                                     о назначениях на узкое место              168, 169
- ациклический    1 14                                         - о перечислении изомеров               93
; - rамилътонов 109                                            - о раскраске вершин тетраэдра                92
-   двудольный 103                                             - о рассеянной секретарше              54
  - звездный 103                                               - о счастливых билетах        67
- ориентированный (орrраф)                         100, 1 29   - о трех домиках и трех колодцах                125
_,       планарный       125                                   - о числе ожерелий 94
198   --------�--�                                                "��wA ��

- планирования эксперимента 1 8�           - рантовая функция 177, 178
  сетевого планирования (PERT) 1 34, 135   мост 105, 106
- Эйлера о коне 109                        мультимножество 100
                                           мультипликативная функция 17

и
                                           н
изоморфизм rрафов 101
    трупп   30                             наибольший общий делитель (НОД) 6, 34
- матроидов i75                            наименьшее общее кратное (НОК) 34
инвентарь М}iОжества 89                    независимые единицы двоичной матрицы
источник 1 30                                   1 53

к                                          о
квадрат Кэли 34                            объединение rрафов l 04
код Прюфера 1 17                           - - дизъюнктное 104
кольцо 30                                  объем выборки 43
                                           отношение 25
                                           - nорядка 25, 27
л
                                             эквивалентности 13, 25, 26
латинский nрямоуrолъник 40, 1 5 1 , 1 58
лемма БернсаЙда 84, 85
                                           n
   о рукоnожатиях 101, 130
лес 1 14                                   nарасочетание 1 50, 151
- остовный 1 1 8                           - максимальное 153
                                           - совершенное 1 50, 151
                                           nерестановки 42
м
                                              с nовторениями 45
маршрут в графе i 04                       nерманент матрицы 169
матрица дважды стохастическая 157          nодrраф 101
  цнцидентности графа 176                  nодстановки 20, 82
- смежности rрафа 101                      nоле 25, 31
- - двудольного rрафа 143, 153             nолная система вычетов по модулю 13
матроид 173                                nорядок элемента rpynnы 35
- бинарный 176                             nоток в сети 137
- Вамоса 193                               nриведеиная система вычетов по модулю
- векторный 175                                 14
- графический 175                          nризнак деЛимости на 1 1 1 1
- двойственный 176                         - - на 9 1 1
- дискретный 174                           nроизводЯщая функция 64, 8 1
- коrрафический 175                        псевдоцикл 123
- матричный 175                            nуть в орrрафе 1 30
  планарный 175
  регулярный 176
                                           р
  тернарный 176
- трансверсальный 1 86, 1 87               разбиение множества 13, 26
- тривиальны_й 174                         размещения 43
- Фано 1 9 1                               - с nовторениями 43
- ЦИКЛОВ     1 75                          разрез в rрафе 175
матроида базис 173                            в сети 140
  nорядок 174                              резерв времени 136
  ранг 173                                 РША система 20, 21
П�дметыА ��РЬ     ------                                                     199

с                                       у
симметрическая разность множеств        уравнение диофантово 1 5
     122
система вычетов по модулю полная 13     ф
- - - - приведеиная 14
- тайнописи (puЬlic key criptosystem)   формула включения-исключения 52
     20                                 - - обобщенная 57
сочетания 43                            - Эйлера 127
- с повторениями 43, 44, 67             фундаментальная система циклов 121, 123,
сравнение по модулю 1 1                      124
стабилизатор 86                         функЦия Мёбиуса 19
сюръекция 56                            - Эйлера 14

т                                       ц
теорема Бёржа 161                       цепь в графе 105
- Биркгофа 158                          - .в упорядоченном множестве 154
- венгерская (Кёнига-Эгервари) 1 53     цикл в графе 105
- Визинга 160                           - в ма'фоиде 174
- Дилворта 155                          цикловой индекс подстановки 84
- Кёнига 142
- Кэли 1 17                             ч
- Оре 1 10
- Пойа 90                               числа Белла 60
- Понтрягина-Куратонекого 129           - взаимно простые 6
                                        - Каталана 70
                                        - Стирлинга 1-ro рода 62
- Радо 187
                                        - - 11-ro рода 58
- Турана 143
- Ферма малая 15
- Хелли одномерная 170                  - Фибоначчи 72
- Холла 151                             число простое 9
- Эйлера 15
трансвереаль 183                        3
- независимая 187
- частичная 183                         электронная подпись 20
    Уважаемые читатели ! Уважаемые авторы!
    Наше . издательство специализируется н а выпуске научной и учебной ли­
    тературы, в том числе монографий, журналов, трудов ученых Российской
    академии наук, научно - исследовательских институтов и учебных заведений.

                                                                                           URSS
    Мы предлагаем авторам свои услуги на выгодных экономических условиях.
    При ;�том мы берем на себя всю работу по подготовке издания - от набора,
    редактирования и верстки до тиражирования и распространения.

    Среди вышедших и rотовяшихся к изданию книr мы предлаrаем Вам следуюшие:
·
    Краснов М. Л. и др. Вся высшая математика. Т. 1-7.
    Краснов М. Л. и др. Сборники задач �вся высшая математика• с подробными решениями.
      Векторный анализ.
      Вариационное исчисление.
      Обыкновенные дифференциальные уравнения.
      Интеrральиые уравнения.
      ФунJЩИИ комплекснот переменноrо.


    Босс В. Лекции по математике. Т. 1 : Анализ; Т. 2: Дифференциальные уравнения;
      Оnерационное исчисление. Теория устойчивости.


    Т. 3: Линейная алrебра; Т. 4: Вероятность, информация, статистика;
    Т. 5: Функциональный анализ; Т. 6: От Днофанта до Тьюринrа.


    Дубровин Б. А., Новиков С. П. , Фо.менко А. Т. Современная rеометрия. Т. 1-3.
    Боярчук А. К. и др. Справочное nособие по высшей математике (Антидемидович). Т. 1-5.

    Данфорд Н. , Шварц Дж. т.. Линейные операторы. Общая теория.
    Вейль А. Основы теории чисел.
    Вейль Г. Алrебраическая теория чисел.

    Хинчин А. Я. Три жемчужины теории чисел.
    Ингам А. Э. Расnределение простых чисел.

    Хинчин А. Я. Цеnные дроби.
    Карацуба А. А. Основы аналитической теории чисел.
    Виноградов И. М. Особые варианты метода триюномеТрических сумм.

    Ожигова Е. П. Что такое теория чисел.
    Жуков А. В. Вездесуmее число •пи•.

    Оре О. Приrлашение в теорию чисел.
    Гельфонд А. О. Трансцендентные и алrебраические числа.
    Гельфонд А. О. Вычеты и их приложения.
    Гельфонд А. О. Исчисление конечных разностей.

    Харари Ф. Теория rрафов.
    Оре О. l}tафы и их применение.

    Родионов В. В. Методы четырехцветной раскраски вершин плоских rрафов.
    Серия «Классический университетский учебник•
    Колмогоров А. Н., Драгалин А. Г. Математическая лоrика.

    Кононович Э. В., Мороз В. И. Общий КУРС астрономии.
    Гнеденко Б. В. КWс теории вероятностей.

    Капитонов И. М. , Ишханов Б. С., Юдин Н. П. Частицы и атомные ядра.
    Квасников И. А. Термодинамика и статистическая физика. В 4 т.
    Петровский И. i: Лекции по теории обыкновенных диффереНЦИIIJIЬНЫХ уравнений.


     По всем вопросам Вы можете обратиться к нам:
     тел./факс (495) 135-42-16, 135-42-46
     или электронной почтой URSS@URSS.ru                             Научная и учебная
     Полный каталоr иэдаций представлен                                 литература
     в Ннтернет-магазипе: http://URSS.ru
Представляем Вам наши лучшие книги:

Харди Г. Г. Курс чистой математики.
                                                                                         URSS
Харди Г. Г., Рогозинекий В. В. Риды Фурье.
Харди Г. Г. Расходищиеси риды.

Харди Г. Г. , Литтльвуд Д,Е. , Полиа Г. Неравеиства.
Полиа Г. , Сеге Г. Изопериметрические иеравеиства в математической физике.
Эльсгольц Л. Э. Вариационное исчисление.
Эльсгольц Л. Э. Качественные методы в математическом анализе.
Бор Г.· Почти периодячеекие функции.

Порошкин А. Г. Теории меры и интеграла.
Титчмарш Э. Введение в теорию интегралов Фурье.

Князев П. Н. Функциональный анализ.
Князев П. Н. Интегральные нреобразовании.
Антоневич А. Б., Князев П. Н., Радыно Я. В. Задачи и упражнении по функциональному анализу.

Борисович Ю. Г., Гельман Б. Д. , Мышкис А. Д. , Обуховекий В. В. Введение в теорию мноrозиачиыХ
Балабанов В. А. Дифференцирование отображений в бесконечномерных векторных простраиствах.

отображений и дифференциальных включений.
Рам Ж. де. Дифференцируемые мноrообразии. ·
Картон А. Дифференциальное исчисление. Дифференциальные формы.
Картон Э. Иltтегральные инварианты;
                              ·
                                    Козлов В. В. Интегральные ниварнанты после Пуанкаре
и Картава.
Данwюв Ю. А. МнОI'Очлены Чебышева.

Уиттекер Э. Т., Ватсон Дж. Н. Курс современною анализа.
Постников М. М. Устойчивые мноrочлеиы.

Хаусдорф Ф. Теориа множеств.
Александров П. С. Введение в теорию множеств и обшую тополоrию.

Вейль Г. Классические групnы. Их инварианты и nредставлении.
Александров П. С. Введение в теорию групп.

Эйзенхарт Л. П. Неnрерывные группы nреобраэований.
Блехман И. И., Мышкис А. Д., Пановко Я. Г. Прикладяаи математика.
Алексеев В. М. (ред.) Избранные задачи по математике из журнала "АММ".
Жуков А. В., Самовол П. И., Аппельбау.м М. В. Элегантная математика. Задачи и решения.

Вайнберг С. Мечты об окончательной теории.
Фейнман Р. , Лейтон Р. , Сэндс М. Фейнмановские лекции по физике.



Пенроуз Р. НОВЫЙ УМ КОРОЛЯ. О компьютерах, мышлении и законах физики.
Грин Б. Элеrантнан Вселенная. Сунеретрупы и nоиски окончательной теории.


. Л. С. Понтрягин: Серия •Знакомство с высшей математикой•
Дифференциальные уравнениа и       их   nриложения.
Метод координат.
Анализ бесконечно малых.
Алгебра.

Другие книги Л. С. Понтрягина:

Основы комбинаторной тоnологии.
 Тhадкие многообразиа и   их   nрименениа   в   теории rомотопий.
 Обобщениа чисел.
 Принциn максимума в оnтимальном управлении.
 Непрерывные группы.      ·


 Жизнеоnисание Льва Семеновича Понтряrина, математика, составленное     им   самим.
Представляем Вам наши лучшие книги:

Дифференциальные и и нтегральные уравн ения
Филиппоо А. Ф. Введение в теорию диффереициальных уравнений.                       URSS

Немыцкий В. В., СтепанQ6 В. В. Качественная теор!IЯ дифференциат.иых уравнений.
Степанов В. В. � диффереициiШЬНЫХ уравнений.

Эльсгольц Л. Э. Днффереиii,IW'IЬНЫе уравнении.
Сикорский Ю. С. ОбЫЮiовеииые дифференциаь      л ные уравнении. С прИJЮжеиием их
к некоторым техннческим задачам.


Филипс r. Днфференциат.ные уравнен!IЯ.
Три1«1ми Ф. Дифференциальные уравнении.

Амелькин В. В. Автономные н JIИНеliиые мноrомерные диффереНциальные уравнении.
Амелькин В. В. ДнффереиЦ�W"�Ьные ураанении в прнложеиНJIХ.
Амелькин В. В., Калитин Б. С. Иэохронные и импулыные колебания двумерных

Беллман Р. Теор!IЯ уетоllчивоети реwеиий диффереИIООIJIЫIЫХ уравнений.
двпамических систем.


Лефшец С. Геометричес!WI теор!IЯ )UiффереиЦIW'Iн
Кузьмина Р. Л. Асимптотическве методы д.ля обыкновенных днф. уравнений.
                                               Ь ЫХ уJW!Иеиий.


Петрооский И. Г. ЛеJЩИИ по теор!IЯ иитеrрат.иых уравиеивй..
Ловитт У. В. ЛIIЯеliиые иитеrрат.иые уравнении. ·
Красноо М. Л. Иитеrральные уравнении. Введение в теорию.
Гайшун И. В. Вполие разрешимые миоrомерные дифференциальные уравнении.
Гайшун И. В. Введение в теорию JIИНейных иеетациоиарных систем.
Ландау Э. Введение в дифференциальное н интегральное IIC'IHCJJeниe.
Алгебра
Чеботарев Н. Г. Основы теор!IЯ Тhлуа. В 2 кн.
Чеботарев Н. Г. Введение в теорию алгебр.
Чеботарев Н. r. Теориа алгебраических функций.
Чеботарев Н. Г. Теор!IЯ групп Ли.
Супруненко Д. А., ТЬlшкевич Р. И. Перестановочные матр!ЩЫ.
Маркус М., Минк Х. Обэор по теор!IЯ матриц и матричных неравеиетв.
Шееалле К. Введение в теорию.алrебрвических функций.
Бэр Р. Лннеliиаи алгебра и проеii.ТИвна.я rеометр!IЯ.
ЗолотаревсКШI Д. И. Сборинк задач по JJИнеliиой алгебре.

Уокер Р. Алrебраическне кривые.
Яглом И. М. Необыкновеииu алгебра.


Фробениус Ф. Г. Теор!IЯ характеров и представлений rрупп.
Теория вероятностей
Гнеденко Б. В., Хинчин А. Я. Элементарное введение в теорию вероятностей.
Гнеденко Б. В., Кооа,ленко И. Н. Введение в теорию маесовоrо обслуживании.
Хинчин А. Я. Работы по математческой теории массовоrо обслуживаиия.
Хинчин А. Я. Асимптотические законы теор!IЯ вepoJI'l'llocтeй.
Хинчин А. Я. Математическве основания квантовой статиСтики.
Боровков А. А. Теор!IЯ вероятностей.
Боровков А. А. Эрrодвчноеть и устоllчивоеть случайных процессов.
Пытьев Ю. Л. Возмож:ноеть. Элементы теор!IЯ н применения.
Кац М. Вероятность и смежные. вопросы в физике.
Золотаревекая Д. И. Теория вероятностей. Задачи с решениями.
Моетеллер Ф.. Пятьдесят занимательных вероятностных задач с решен!IЯмн.
Представляем В ам наши лучшие, книги:

Математическая логика
Клини С. Математическая логика.
                                                                                       URSS
Драгалин А. Г. Конструктивная теория доказательств и нестандартный aнiiJiиз.
Перминов В. Я. Развитие предстаiiJiений о надежиости математическою доказательства.
Петров Ю. А. Логические проблемы абстракций бесконечности и осуществимости.
Бирюков Б. В., Тростников В. Н. Жар холодных числ и пафос бесстрастной лоrики.
Бирюков Б. В. Крушение метафизической концепции уииверсiiJiьиости предметной
области в логике. Контроверза. Фреrе-Шрёдер.
Гастев Ю. А. Гомоморфизмы и модели (лоmко-IIJirебраические аспекты моделирования).


Гамов Г., Стерн М. Занимательные задачи.
Бахтинров К. И. Логика с точки зрения информатики.


Математическое моделирование
Тарасевич Ю. Ю. Математическое и компьютерное МОделирование.
Тарасевич   lo. Ю. Перколяция: теория, приложенИJI, IIJiгоритмы.
Плохотни.ков К. Э. Математическое моделирование и вычислительный эксперимент.
Мышкис А. Д. Элементы теории математических моделей.
Калман Р. , Фалб П. , Арбиб М. Очерки по математической теории систем.
Вайдлих В. Социодинамика: системный подход к математическому моделированию социiiJiьных наук.
Попков Ю. С. Теория макросистем. Равновесные модели.



Шикин Е. В. От игр к играм. Математическое введение.
Теория игр


Оуэн Г. Теория игр.
Жуковский В. И. , Жуковская Л. В. Риск в миогокритериiiJiьных и конфликтных системах
при неопределенности.
Жуковский В. И. Кооперативные игры при неопределенности и      их   приложения.
Смольяков Э. Р. Теория аитаrонизмов и дифференциiiJiьные игры.
Смольяков Э. Р. Теория конфликтных равновесий.
Оптимизация
Софиева Ю. Н. , Цирлин А. М. Введение в задачи и методы )'!=ЛОвкой оптимизации.
Галеев Э. М. Оптимизация: теория, примеры, задачи.
Ковалев М. М. Дискретная оптимизация (целочисленное программирование).
Ковалев М. М. Матронды в дискретной оптимизиции.
Балакришнан А. Введение в теорию оптимизации в гильбертоном пространстве.
Механика


Жуковский Н. Е. Аи11J1итическая механика.
Кирхгоф Г. Механика. Лекции по математической физике.


Жуковский Н. Е. Механика системы. Динамика твердого тела.
Жуковский Н. Е. Кинематика, статика, динамика точки: университетский курс.
Арнольд В. И. Математические методы классической механики.
Арнольд В. И. и др. Математические аспекты классической и небесной механики.


Уиттекер Е. Т. Аи11J1итическая динамика.
Геккелер И. В. Статика упругого тела.


Якоби К. Леiщии по динамике.
Розенблат Г. М. Механика в задачах и решениях.      ,,


Кузьмина Р. П. Мате)!атические модели небесной механики.
Малкин И. Г. Методы Ляпуиова и. Пуанкаре в теории нелинейных колебаний.
Малкин И. Г. Некоторые задачи теории нелинейных колебаний.
Малкин И. Г. Теория устойчивости движения.
                                                 1




· Представляем Вам наиnt: лучшие кннrн:

Фиников С. П. Курс дифференциальной rеометрнн.
Фиников С. П. ПроеКТ111о
                       111 -диффереиU,И8JIЫiаа rеометрИII.
                                                                                                                   URSS
Фиников С. П. Аи11JIИТ11Ческаа rеометрИII.
Бюшгенс С. С. ДифференЦИJ1.1П.ИU rеометрu.
Лозняк Э. Г., Шикин Е. В. Дифференциальная rеометрu: первое эиакоl\fство.
Рашевский П. К. Курс диффере��Ц�W�ьиой rеометрнн.
Рашевский П. К. Геометричес�W�. теорИII уравнений е частиwllfи nроизводнwми.
Рашевский   J1. К.   Римаиова rеометрИJI и тенэориwй авмиз.
Рашевский П. К. Теорu спиноров.
Белько Н. В. Слоевwе rруппоидw Ли и метод Эресмака в дифференцимьиой геометрии.
Феденко А. С. Пространства с симМетрИ��Ми .
Смирнов Ю. М. Курс аналитической rеометрии.
Дарбу Г. Прииципы анмитич:еской rеометрнн.
Лебег А. Об измерении     /IМJIЧНН.

Гильберт Д., Кон-Фоссеr« С. HarЛIJДИIUI rеометрИII.
Александров н. н. СбОрJIИХ rеометрических задач на построение (с решеИиимн).
Яглом Н. М. О комбинаторной rеометрнн.
Яглом И. М. Комплексиwе числа и           их   нримененке в rеометрни.
Яmом И. М. Прницнп отilоеительности Thлилe.lf и .JJCellll.lвдoвa
                                                           l     rеометрин.
История и ф илософия математики

Вейль Г. О философии математики.
Светлов В. А. Философu математики.
Асмус В. Ф. ПроОлема интуиции в философии и птематике.
Реньи А. Диалоrи о математике.
Харди Г. Г. Аполоrиа матема'I'ИD..
Гнеденко Б. В. О птематнке.
Гнеде11ко Б. В. Очерки по истории математики а России.
Гнеденко Б. В. Очерк по истории теории вероатиостей.
Медведев Ф. А. Очерки истории теории функций действительною nеремеиноrо.
Медведев Ф. А. Фрапцуэскаа школа теории функций и нножеств на рубеже XIX-XX 1.1в.
Стройк Д. Jl. Очерк исторЮ!: дифференциаJIЬной rеометрнн (до ХХ столетu).
Григорян А . А. Закоиомерноети и парадоксw раэвитии теории вероатностей.
Архимед, Гюйгенс, Лежандр, Ламберт. О радратуре круrа.
Ожигова Е. П. Развитие теории чисел в России.
Попов Г. Н. Сборник исторических эвдач по элементарной математике.
Шереметевекий В. П. Очерки по истории математики.
Нейгебауер О. Точные науки в древности.
Флоренский П. А. Мнимости в rеометрнн: расширение области Дllухмериwх образов
rеометрии (опwт новоrо истолкования мнимостей).


     Тел./Факс:            Наши иниrи моiiНо приООреаи в маrаJИнах:
                           «&MMIO·ГJ!Odft» (М. д,CIRНIII, YJI. Мl\ciii,iUiil &. TU. (495) !125-2457)
  (495) 135-42-46,         «Мoa!OICIIIIII 111111 IНIIПI» (М. ApOarCUR, уА. ltolwil Apliп, 8. TU. (415) 203-8242)
  (495) 135-42·16,         «МIIJIOAJII /'11111»   18 (M. IIoAtllu, ул. &. llomi.НIIJ, 28. Tu. (415) 238-5801, 780·3310)
                           «дам HQ'IIIO-ПXHI'Ittlloll IНIII'I» (Jieii11C11 KИII np-r, 40. TU. (495) 1З7·6019)
       E·mall:             «ДОм AUOIOI KНIII'I» (M. IIpo.lerl\l(llll,l у.11. MIPIICIII:tiCIR
                                                                                           t , 9. TU. (495) 270·5421)
                           «Гiюэ!К» (м. Унuерцтет, 1 JJМ. IIIIpnyt М/'У, 1101111. 141. тu. (495) . 939-4713)
  URSS@URSS.ru             «У Kettrupa" (РIТУ) (М. HOIOCJIOIIoAWR, JA.IIaмou, 15. Tu. (415) 973-4301)
                           «СПб. 111111 KИIII'II » (llutlld np., 28. TU. (812) m·3!154)
   Ьttp://URSS.ru
BbiCWAИ
МАТЕМАТИКА
В семи томах:
Том 1                                          Том 2
•   Ансимт11Ч8СКС11 rеометр����                •    Интеrрсn.ное IAICIIetll8
•   Векторна11 Oll'eбpa                        •    д� 1К'11С1е11118
•   .11мнейнС11 Olleбpa                             функцмi IIIJO(OJЫIIX nepeмetИIX
•
    д� IAICIIetll8 · Д� rеометр����

Том 3                                          Том 4
•   т80pll
                р11д08
                                               •    Кpaтllolll и �
                                                     IIIТerpa!lol
•   06ык11011811НЬlе
                                               •
                                                    lleктopllolii OIIOIJII
    �                                          •    Фyti(ЦIII комкме оюrо
    YJDit8lllll                                     nep811811101'0
                                               •
                                                    � YJII8II8IIII
•
    Теор�� усrоiчивосrи                             C ЧOCТIIЫIIII �IIII


Том 5                                          Том 6
•   т80pll      вepDIIТitOCТei             •
                                                   Вармацмонное исчисление
•   Мотемот11Ч8СКС11                       •
                                                   11инеiное �
    СТОТIIСТIIКО                           •       8ы'IIICI8
                                                           IП 11>1t011 МОТ8М011101(
                                                                                      НАУЧНАЯ И УЧЕБНАЯ ЛИТЕРАТУРА
•
    T80f11111 иrp                         •
                                                   т80pllll   cnnoiiнo8                      E-mail: URSS@URSS.nJ

                                                                                             Каталог иэданий в   Интерн8т8:
                                                                                             http://URSS.ru
Том 7                                              тeop��     lloiio
                                                                                           Твn./фвкс: 7 (095) 1 35-<42-16
                                          •



•
    Т80f11111   чисел                     •        т80pll     rJDIIoe                 URSS ТепJфвкс: 7 (095) 1 35-<42�

•
    0бщо11 011ебра                        •
                                                   lqlocoчeтiНA
    Комбмноторико                          . Мот�                                               3384 ID 31314



                                                                                       JIIJIШJili iiШ�II�
•




Любwе отэывы             о настоящем иэдании, а также обнаруженные оnечатки
nрис1о111айте по адресу U RSS @ URSS.ru. Ваши замечания и Пji@Д/!ОЖе­                                                  >
ния буА'fТ учтены и отражены на wеЬ-странице этом книги в нашем
интернет-магаэине http://UIISS.ru
